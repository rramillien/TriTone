Opal.modules["atome/genesis/sparkle"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $def = Opal.def, $eqeq = Opal.eqeq, $hash2 = Opal.hash2, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, $$$ = Opal.$$$, default_render = nil;

  Opal.add_stubs('==,downcase,new_default_params,eval,eval_protection,[],default_params,current_user=,puts,app_identity,current_machine,current_user,new');
  
  
  $def(self, '$eval_protection', function $$eval_protection() {
    var self = this;

    return Opal.Binding.$new(  function($code) {    return eval($code);  },  [],  self,  ['atome/genesis/sparkle.rb', 5])
  }, 0);
  if ($eqeq($$('RUBY_ENGINE').$downcase(), "opal")) {
    $$('Essentials').$new_default_params($hash2(["render_engines"], {"render_engines": ["browser"]}))
  } else {
    
    $$('Essentials').$new_default_params($hash2(["render_engines"], {"render_engines": ["headless"]}));
    self.$eval("require 'atome/extensions/geolocation'", self.$eval_protection(), "atome/genesis/sparkle.rb", 13);
    self.$eval("require 'atome/extensions/ping'", self.$eval_protection(), "atome/genesis/sparkle.rb", 14);
    self.$eval("require 'atome/extensions/sha'", self.$eval_protection(), "atome/genesis/sparkle.rb", 15);
  };
  default_render = $$('Essentials').$default_params()['$[]']("render_engines");
  $$('Universe')['$current_user=']("jeezs");
  self.$puts("application identity: " + ($$('Universe').$app_identity()));
  self.$puts("atome version: " + ($$$($$('Atome'), 'VERSION')));
  self.$puts("current host: " + ($$('Universe').$current_machine()));
  self.$puts("current user: " + ($$('Universe').$current_user()));
  $$('Atome').$new($hash2(["element"], {"element": $hash2(["renderers", "id", "type", "parents", "children"], {"renderers": [], "id": "eDen", "type": "element", "parents": [], "children": []})}));
  $$('Atome').$new($hash2(["element"], {"element": $hash2(["renderers", "id", "type", "parents", "children"], {"renderers": [], "id": "user_view", "type": "element", "parents": ["eDen"], "children": []})}));
  return $$('Atome').$new($hash2(["shape"], {"shape": $hash2(["renderers", "id", "type", "parents", "children", "left", "right", "top", "bottom", "overflow", "color"], {"renderers": default_render, "id": "view", "type": "shape", "parents": ["user_view"], "children": [], "left": 0, "right": 0, "top": 0, "bottom": 0, "overflow": "auto", "color": $hash2(["renderers", "id", "type", "attach", "red", "green", "blue", "alpha"], {"renderers": default_render, "id": "view_color", "type": "color", "attach": ["view"], "red": 0.15, "green": 0.15, "blue": 0.15, "alpha": 1})})}));
};

Opal.modules["atome/renderers/browser/browser"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $def = Opal.def, self = Opal.top, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('require,attr_accessor');
  
  self.$require("atome/renderers/browser/effect");
  self.$require("atome/renderers/browser/event");
  self.$require("atome/renderers/browser/geometry");
  self.$require("atome/renderers/browser/identity");
  self.$require("atome/renderers/browser/material");
  self.$require("atome/renderers/browser/spatial");
  self.$require("atome/renderers/browser/atome");
  self.$require("atome/renderers/browser/utility");
  self.$require("atome/renderers/browser/helpers/browser_helper");
  self.$require("atome/renderers/browser/helpers/animation_helper");
  self.$require("atome/renderers/browser/helpers/color_helper");
  self.$require("atome/renderers/browser/helpers/drag_helper");
  self.$require("atome/renderers/browser/helpers/effect_helper");
  self.$require("atome/renderers/browser/helpers/event_helper");
  self.$require("atome/renderers/browser/helpers/image_helper");
  self.$require("atome/renderers/browser/helpers/shadow_helper");
  self.$require("atome/renderers/browser/helpers/shape_helper");
  self.$require("atome/renderers/browser/helpers/text_helper");
  self.$require("atome/renderers/browser/helpers/video_helper");
  self.$require("atome/renderers/browser/helpers/web_helper");
  (function($base, $super) {
    var self = $klass($base, $super, 'Atome');

    
    return self.$attr_accessor("browser_object")
  })($nesting[0], null);
  return $def(self, '$atome_js', function $$atome_js() {
    
    return atomeJS;
  }, 0);
};

Opal.modules["atome/helpers/sanitizer"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $hash2 = Opal.hash2, $rb_divide = Opal.rb_divide, $def = Opal.def, $truthy = Opal.truthy, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$;

  Opal.add_stubs('private,css_rgb,[],split,gsub,sub,/,to_f,default_params');
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'Atome');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting), $proto = self.$$prototype;

    $proto.atome = nil;
    
    self.$private();
    
    $def(self, '$create_color_hash', function $$create_color_hash(params) {
      var rgb_color = nil, split_data = nil;

      
      rgb_color = $$$($$('Color'), 'CSS')['$[]'](params).$css_rgb();
      split_data = rgb_color.$sub("rgb(", "").$sub(")", "").$gsub(",", "").$split("%");
      return $hash2(["red", "green", "blue"], {"red": $rb_divide(split_data['$[]'](0).$to_f(), 100), "green": $rb_divide(split_data['$[]'](1).$to_f(), 100), "blue": $rb_divide(split_data['$[]'](2).$to_f(), 100)});
    }, 1);
    return $def(self, '$found_parents_and_renderers', function $$found_parents_and_renderers() {
      var self = this, parent_found = nil, render_found = nil;

      
      if ($truthy(self.atome)) {
        
        parent_found = [self.atome['$[]']("id")];
        render_found = self.atome['$[]']("renderers");
      } else {
        
        parent_found = [];
        render_found = $$('Essentials').$default_params()['$[]']("render_engines");
      };
      return $hash2(["parent", "renderers"], {"parent": parent_found, "renderers": render_found});
    }, 0);
  })($nesting[0], null, $nesting)
};

Opal.modules["atome/genesis/generators/utility"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $truthy = Opal.truthy, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_particle,[],is_a?,instance_exec,to_proc,delete,to_s,split,union,each,renderer_list,send');
  
  generator = $$('Genesis').$generator();
  generator.$build_particle("renderers");
  generator.$build_particle("code");
  $send(generator, 'build_particle', ["run"], function $$1(params){var self = $$1.$$s == null ? this : $$1.$$s, code_found = nil;
    if (self.atome == null) self.atome = nil;

    
    if (params == null) params = nil;
    code_found = self.atome['$[]']("code");
    if ($truthy(code_found['$is_a?']($$('Proc')))) {
      return $send(self, 'instance_exec', [params], code_found.$to_proc())
    } else {
      return nil
    };}, {$$arity: 1, $$s: self});
  generator.$build_particle("broadcast");
  generator.$build_particle("additional");
  generator.$build_particle("data");
  $send(generator, 'build_particle', ["delete"], function $$2(){var self = $$2.$$s == null ? this : $$2.$$s;
    if (self.atome == null) self.atome = nil;

    return $$('Universe').$delete(self.atome['$[]']("id"))}, {$$arity: 0, $$s: self});
  generator.$build_particle("clear");
  generator.$build_particle("path");
  $send(generator, 'build_particle', ["schedule"], function $$3(date, proc){var self = $$3.$$s == null ? this : $$3.$$s, delimiters = nil, format_date = nil;

    
    if (date == null) date = nil;
    if (proc == null) proc = nil;
    date = date.$to_s();
    delimiters = [",", " ", ":", "-"];
    format_date = date.$split($$('Regexp').$union(delimiters));
    return $send($$('Universe').$renderer_list(), 'each', [], function $$4(renderer){var self = $$4.$$s == null ? this : $$4.$$s;

      
      if (renderer == null) renderer = nil;
      return $send(self, 'send', ["" + (renderer) + "_schedule", format_date], proc.$to_proc());}, {$$arity: 1, $$s: self});}, {$$arity: 2, $$s: self});
  $send(generator, 'build_particle', ["read"], function $$5(file, proc){var self = $$5.$$s == null ? this : $$5.$$s;

    
    if (file == null) file = nil;
    if (proc == null) proc = nil;
    return $send($$('Universe').$renderer_list(), 'each', [], function $$6(renderer){var self = $$6.$$s == null ? this : $$6.$$s;

      
      if (renderer == null) renderer = nil;
      return $send(self, 'send', ["" + (renderer) + "_reader", file], proc.$to_proc());}, {$$arity: 1, $$s: self});}, {$$arity: 2, $$s: self});
  return generator.$build_particle("cursor");
};

Opal.modules["atome/helpers/callbacks"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $def = Opal.def, $rb_gt = Opal.rb_gt, $hash2 = Opal.hash2, $hash = Opal.hash, $eqeq = Opal.eqeq, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('private,attr_accessor,public,is_a?,instance_exec,to_proc,[]=,>,[],play_active_proc,browser_object,style,==,atome');
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'Atome');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting), $proto = self.$$prototype;

    $proto.atome = $proto.at_time = $proto.drag_start_proc = $proto.drag_move_proc = $proto.drag_end_proc = $proto.sort_proc = $proto.animation_start_proc = $proto.animation_stop_proc = nil;
    
    self.$private();
    self.$attr_accessor("drag_start_proc", "drag_move_proc", "drag_end_proc", "play_start_proc", "play_active_proc", "play_end_proc", "animation_start_proc", "animation_active_proc", "animation_stop_proc");
    self.$public();
    
    $def(self, '$schedule_callback', function $$schedule_callback(proc) {
      var self = this;

      if ($truthy(proc['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [], proc.$to_proc())
      } else {
        return nil
      }
    }, 1);
    
    $def(self, '$read_callback', function $$read_callback(file, proc) {
      var self = this;

      if ($truthy(proc['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [file], proc.$to_proc())
      } else {
        return nil
      }
    }, 2);
    
    $def(self, '$time_callback', function $$time_callback(current_time) {
      var self = this, proc = nil;

      
      self.atome['$[]=']("time", current_time);
      if (!($truthy(self.at_time['$[]']("time")) && ($truthy($rb_gt(current_time, self.at_time['$[]']("time")))))) {
        return nil
      };
      proc = self.at_time['$[]']("code");
      if ($truthy(proc['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [current_time], proc.$to_proc())
      } else {
        return nil
      };
    }, 1);
    
    $def(self, '$drag_start_callback', function $$drag_start_callback(page_x, page_y, left_val, top_val) {
      var self = this, proc = nil;

      
      self.atome['$[]=']("left", left_val);
      self.atome['$[]=']("top", top_val);
      proc = self.drag_start_proc;
      if ($truthy(proc['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [$hash2(["pageX", "pageY", "left", "top"], {"pageX": page_x, "pageY": page_y, "left": left_val, "top": top_val})], proc.$to_proc())
      } else {
        return nil
      };
    }, 4);
    
    $def(self, '$drag_move_callback', function $$drag_move_callback(page_x, page_y, left_val, top_val) {
      var self = this, proc = nil;

      
      proc = self.drag_move_proc;
      self.atome['$[]=']("left", left_val);
      self.atome['$[]=']("top", top_val);
      if ($truthy(proc['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [$hash2(["pageX", "pageY", "left", "top"], {"pageX": page_x, "pageY": page_y, "left": left_val, "top": top_val})], proc.$to_proc())
      } else {
        return nil
      };
    }, 4);
    
    $def(self, '$drag_end_callback', function $$drag_end_callback(page_x, page_y, left_val, top_val) {
      var self = this, proc = nil;

      
      self.atome['$[]=']("left", left_val);
      self.atome['$[]=']("top", top_val);
      proc = self.drag_end_proc;
      if ($truthy(proc['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [$hash2(["pageX", "pageY", "left", "top"], {"pageX": page_x, "pageY": page_y, "left": left_val, "top": top_val})], proc.$to_proc())
      } else {
        return nil
      };
    }, 4);
    
    $def(self, '$sort_callback', function $$sort_callback(atome) {
      var self = this, sort_proc = nil;

      
      sort_proc = self.sort_proc;
      if ($truthy(sort_proc['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [atome], sort_proc.$to_proc())
      } else {
        return nil
      };
    }, 1);
    
    $def(self, '$browser_animate_callback', function $$browser_animate_callback(particle_found, value, animation_hash, original_particle, animation_atome) {
      var $a, self = this, anim_proc = nil, play_proc = nil;

      
      anim_proc = animation_hash['$[]']("code");
      if ($truthy(anim_proc['$is_a?']($$('Proc')))) {
        $send(self, 'instance_exec', [$hash(original_particle, value)], anim_proc.$to_proc())
      };
      play_proc = animation_atome.$play_active_proc();
      if ($truthy(play_proc['$is_a?']($$('Proc')))) {
        $send(self, 'instance_exec', [$hash(self.atome['$[]'](particle_found), value)], play_proc.$to_proc())
      };
      if ($truthy(self.$browser_object())) {
        self.$browser_object().$style()['$[]='](particle_found, value)
      };
      return ($a = [original_particle, value], $send(self.atome, '[]=', $a), $a[$a.length - 1]);
    }, 5);
    
    $def(self, '$play_start_callback', function $$play_start_callback(_particle_found, _start_value, animation_hash, original_particle, atome_found) {
      var self = this, value = nil, start_proc = nil;

      
      value = animation_hash['$[]']("begin")['$[]'](original_particle);
      if ($eqeq(value, "self")) {
        value = atome_found.$atome()['$[]'](original_particle)
      };
      start_proc = self.animation_start_proc;
      self.atome['$[]='](original_particle, value);
      if ($truthy(start_proc['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [$hash(original_particle, value)], start_proc.$to_proc())
      } else {
        return nil
      };
    }, 5);
    return $def(self, '$play_stop_callback', function $$play_stop_callback(_particle_found, _end_value, animation_hash, original_particle, _atome_found) {
      var self = this, value = nil, end_proc = nil;

      
      value = animation_hash['$[]']("end")['$[]'](original_particle);
      end_proc = self.animation_stop_proc;
      self.atome['$[]='](original_particle, value);
      if ($truthy(end_proc['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [$hash(original_particle, value)], end_proc.$to_proc())
      } else {
        return nil
      };
    }, 5);
  })($nesting[0], null, $nesting)
};

Opal.modules["atome/extensions/matrix"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $hash2 = Opal.hash2, $def = Opal.def, $truthy = Opal.truthy, $rb_lt = Opal.rb_lt, $rb_plus = Opal.rb_plus, $rb_times = Opal.rb_times, $rb_minus = Opal.rb_minus, $rb_divide = Opal.rb_divide, $send = Opal.send, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('attr_accessor,new,style,<,[]=,<<,+,merge,[],create_matrix_colors,create_matrix_back,to_i,*,create_cells,resize_matrix,height,value,width,left,right,-,/,each_with_index,height=,width=,zero?,modulo,%,top,grab,delete,attr_reader,name,each,is_a?,assign,to_proc,atome,unbind,id=,get_cell_data,instance_exec');
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'Matrix');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting), $proto = self.$$prototype;

    $proto.matrix = $proto.matrix_dataset = $proto.cells = $proto.matrix_id = $proto.matrix_style = $proto.nb_of_rows = $proto.nb_of_cols = $proto.cell_style = $proto.matrix_margin = nil;
    
    self.$attr_accessor("matrix");
    
    $def(self, '$create_matrix_back', function $$create_matrix_back(id, style) {
      var self = this;

      
      self.matrix = $$('Atome').$new($hash2(["shape"], {"shape": $hash2(["type", "renderers", "id", "parents", "children", "overflow"], {"type": "shape", "renderers": ["browser"], "id": id, "parents": ["view"], "children": ["matrix_color"], "overflow": "auto"})}));
      return self.matrix.$style(style);
    }, 2);
    
    $def(self, '$create_matrix_colors', function $$create_matrix_colors() {
      
      
      $$('Atome').$new($hash2(["color"], {"color": $hash2(["renderers", "id", "type", "parents", "children", "red", "green", "blue", "alpha"], {"renderers": ["browser"], "id": "matrix_color", "type": "color", "parents": [], "children": [], "red": 0, "green": 1, "blue": 1, "alpha": 1})}));
      return $$('Atome').$new($hash2(["color"], {"color": $hash2(["renderers", "id", "type", "parents", "children", "red", "green", "blue", "alpha"], {"renderers": ["browser"], "id": "cell_color", "type": "color", "parents": [], "children": [], "red": 1, "green": 0.15, "blue": 0.7, "alpha": 1})}));
    }, 0);
    
    $def(self, '$create_cells', function $$create_cells(id, cell_number, number_of_cells, style) {
      var self = this, a = nil;

      while ($truthy($rb_lt(cell_number, number_of_cells))) {
      
        self.matrix_dataset['$[]='](cell_number, []);
        self.cells['$<<']((a = $$('Atome').$new($hash2(["shape"], {"shape": $hash2(["type", "renderers", "id", "parents", "children"], {"type": "shape", "renderers": ["browser"], "id": $rb_plus(id, "_" + (cell_number)), "parents": [id], "children": ["cell_color"]})}))));
        a.$style(style);
        cell_number = $rb_plus(cell_number, 1);
      }
    }, 4);
    
    $def(self, '$initialize', function $$initialize(params) {
      var self = this, default$ = nil, nb_of_rows = nil, nb_of_cols = nil, matrix_width = nil, matrix_height = nil, number_of_cells = nil, cell_number = nil;

      
      default$ = $hash2(["col", "row", "size", "margin", "name", "parent"], {"col": 4, "row": 4, "size": 333, "margin": 12, "name": "matrix", "parent": "view"});
      params = default$.$merge(params);
      nb_of_rows = params['$[]']("row");
      nb_of_cols = params['$[]']("col");
      matrix_width = params['$[]']("width");
      matrix_height = params['$[]']("height");
      self.matrix_dataset = [];
      self.matrix_margin = params['$[]']("margin");
      if (!$truthy(params['$[]']("id"))) {
        params['$[]=']("id", "matrix")
      };
      self.matrix_id = params['$[]']("id");
      self.matrix_style = params['$[]']("matrix_style");
      self.cell_style = params['$[]']("cell_style");
      self.$create_matrix_colors();
      self.$create_matrix_back(self.matrix_id, self.matrix_style);
      self.nb_of_rows = nb_of_rows.$to_i();
      self.nb_of_cols = nb_of_cols.$to_i();
      number_of_cells = $rb_times(self.nb_of_rows, self.nb_of_cols);
      self.cells = [];
      cell_number = 0;
      self.$create_cells(self.matrix_id, cell_number, number_of_cells, self.cell_style);
      return self.$resize_matrix($hash2(["width", "height"], {"width": matrix_width, "height": matrix_height}));
    }, 1);
    
    $def(self, '$width', function $$width(val) {
      var self = this;

      
      if (val == null) val = nil;
      if ($truthy(val)) {
        return self.$resize_matrix($hash2(["height", "width"], {"height": self.$height(), "width": val}))
      } else {
        return self.matrix.$width().$value()
      };
    }, -1);
    
    $def(self, '$height', function $$height(val) {
      var self = this;

      
      if (val == null) val = nil;
      if ($truthy(val)) {
        return self.$resize_matrix($hash2(["width", "height"], {"width": self.$width(), "height": val}))
      } else {
        return self.matrix.$height().$value()
      };
    }, -1);
    
    $def(self, '$left', function $$left(val) {
      var self = this;

      return self.matrix.$left(val)
    }, 1);
    
    $def(self, '$right', function $$right(val) {
      var self = this;

      return self.matrix.$right(val)
    }, 1);
    
    $def(self, '$resize_matrix', function $$resize_matrix(params) {
      var $a, self = this, matrix_width = nil, matrix_height = nil, cell_width = nil, cell_height = nil, row = nil;

      
      matrix_width = params['$[]']("width");
      matrix_height = params['$[]']("height");
      cell_width = $rb_minus($rb_divide(matrix_width, self.nb_of_cols), self.matrix_margin);
      cell_height = $rb_minus($rb_divide(matrix_height, self.nb_of_rows), self.matrix_margin);
      row = -1;
      $send(self.cells, 'each_with_index', [], function $$1(cell, index){var self = $$1.$$s == null ? this : $$1.$$s;
        if (self.nb_of_cols == null) self.nb_of_cols = nil;
        if (self.matrix_margin == null) self.matrix_margin = nil;

        
        if (cell == null) cell = nil;
        if (index == null) index = nil;
        cell['$height='](cell_height);
        cell['$width='](cell_width);
        if ($truthy(index.$modulo(self.nb_of_cols)['$zero?']())) {
          row = $rb_plus(row, 1)
        };
        cell.$left($rb_plus($rb_times(index['$%'](self.nb_of_cols), $rb_plus(cell_width, self.matrix_margin)), self.matrix_margin));
        return cell.$top($rb_plus($rb_times(row, $rb_plus(cell_height, self.matrix_margin)), self.matrix_margin));}, {$$arity: 2, $$s: self});
      self.matrix['$width=']($rb_plus(matrix_width, self.matrix_margin));
      return ($a = [$rb_plus(matrix_height, self.matrix_margin)], $send(self.matrix, 'height=', $a), $a[$a.length - 1]);
    }, 1);
    
    $def(self, '$get_cell', function $$get_cell(id) {
      var self = this;

      return self.$grab("" + (self.matrix_id) + "_" + (id))
    }, 1);
    
    $def(self, '$delete', function $Matrix_delete$2(val) {
      var self = this;

      
      if (val == null) val = true;
      if ($truthy(val)) {
        return self.matrix.$delete(true)
      } else {
        return nil
      };
    }, -1);
    self.$attr_reader("cells");
    
    $def(self, '$name', function $$name() {
      var self = this;

      return self.matrix.$name()
    }, 0);
    
    $def(self, '$get_cell_data', function $$get_cell_data(codes, cell_nb) {
      var self = this;

      return $send(codes, 'each', [], function $$3(proc){var self = $$3.$$s == null ? this : $$3.$$s;

        
        if (proc == null) proc = nil;
        if ($truthy(proc['$is_a?']($$('Proc')))) {
          return $send(self, 'assign', [cell_nb], proc.$to_proc())
        } else {
          return nil
        };}, {$$arity: 1, $$s: self})
    }, 2);
    
    $def(self, '$add', function $$add(params) {
      var self = this, nb_of_cols = nil, nb_of_rows = nil, current_id = nil, temp_id = nil, old_matrix = nil;

      
      nb_of_cols = $rb_plus(self.nb_of_cols, params['$[]']("columns").$to_i());
      nb_of_rows = $rb_plus(self.nb_of_rows, params['$[]']("rows").$to_i());
      current_id = self.matrix.$atome()['$[]']("id");
      $send(self.cells, 'each', [], function $$4(cell){
        
        if (cell == null) cell = nil;
        cell.$delete(true);
        return cell.$unbind("all");}, 1);
      temp_id = "" + (current_id) + "_temporary";
      self.matrix['$id='](temp_id);
      old_matrix = self.$grab(temp_id);
      old_matrix.$delete(true);
      $$('Matrix').$new($hash2(["col", "row", "width", "height", "id", "margin", "matrix_style", "cell_style"], {"col": nb_of_cols, "row": nb_of_rows, "width": 300, "height": 300, "id": current_id, "margin": self.matrix_margin, "matrix_style": self.matrix_style, "cell_style": self.cell_style}));
      return $send(self.matrix_dataset, 'each_with_index', [], function $$5(cell_data, index){var self = $$5.$$s == null ? this : $$5.$$s;

        
        if (cell_data == null) cell_data = nil;
        if (index == null) index = nil;
        return self.$get_cell_data(cell_data, index);}, {$$arity: 2, $$s: self});
    }, 1);
    
    $def(self, '$assign', function $$assign(cell_nb) {
      var proc = $$assign.$$p || nil, self = this, current_cell = nil;

      $$assign.$$p = null;
      
      ;
      if (cell_nb == null) cell_nb = nil;
      current_cell = self.$grab("" + (self.matrix_id) + "_" + (cell_nb));
      if ($truthy(proc)) {
        
        self.matrix_dataset['$[]'](cell_nb)['$<<'](proc);
        if ($truthy(proc['$is_a?']($$('Proc')))) {
          return $send(current_cell, 'instance_exec', [], proc.$to_proc())
        } else {
          return nil
        };
      } else {
        return self.matrix_dataset['$[]'](cell_nb)
      };
    }, -1);
    return $def(self, '$reformat', function $$reformat(params) {
      var self = this;

      
      self.nb_of_rows = params['$[]']("rows");
      self.nb_of_cols = params['$[]']("cols");
      return self.$resize_matrix($hash2(["height", "width"], {"height": self.$height(), "width": self.$width()}));
    }, 1);
  })($nesting[0], null, $nesting)
};

Opal.modules["atome/genesis/generators/material"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_particle,build_option,each,send,puts');
  
  generator = $$('Genesis').$generator();
  generator.$build_particle("red");
  generator.$build_particle("green");
  generator.$build_particle("blue");
  generator.$build_particle("alpha");
  generator.$build_particle("diffusion");
  generator.$build_particle("visual");
  generator.$build_particle("overflow");
  generator.$build_particle("edit");
  generator.$build_particle("style");
  $send(generator, 'build_option', ["pre_render_style"], function $$1(styles_send, _user_proc){var self = $$1.$$s == null ? this : $$1.$$s;

    
    if (styles_send == null) styles_send = nil;
    if (_user_proc == null) _user_proc = nil;
    return $send(styles_send, 'each', [], function $$2(particle_send, value){var self = $$2.$$s == null ? this : $$2.$$s;

      
      if (particle_send == null) particle_send = nil;
      if (value == null) value = nil;
      return self.$send(particle_send, value);}, {$$arity: 2, $$s: self});}, {$$arity: 2, $$s: self});
  generator.$build_particle("hide");
  return $send(generator, 'build_particle', ["remove"], function $$3(particle_to_remove){var self = $$3.$$s == null ? this : $$3.$$s;

    
    if (particle_to_remove == null) particle_to_remove = nil;
    
    switch (particle_to_remove) {
      case "color":
        return self.$send(particle_to_remove, "black")
      case "shadow":
        return self.$puts("code to write")
      default:
        return self.$send(particle_to_remove, 0)
    };}, {$$arity: 1, $$s: self});
};

Opal.modules["atome/extensions/atome"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $def = Opal.def, $hash2 = Opal.hash2, $send = Opal.send, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil;

  Opal.add_stubs('[],atomes,box,grab,to_proc,circle,define_method,send');
  
  
  $def(self, '$grab', function $$grab(atome_to_get) {
    
    return $$('Universe').$atomes()['$[]'](atome_to_get)
  }, 1);
  
  $def(self, '$box', function $$box(params) {
    var proc = $$box.$$p || nil, self = this;

    $$box.$$p = null;
    
    ;
    if (params == null) params = $hash2([], {});
    return $send(self.$grab("view"), 'box', [params], proc.$to_proc());
  }, -1);
  
  $def(self, '$circle', function $$circle(params) {
    var proc = $$circle.$$p || nil, self = this;

    $$circle.$$p = null;
    
    ;
    if (params == null) params = $hash2([], {});
    return $send(self.$grab("view"), 'circle', [params], proc.$to_proc());
  }, -1);
  return $def(self, '$create_method_at_object_level', function $$create_method_at_object_level(element) {
    var $yield = $$create_method_at_object_level.$$p || nil, self = this;

    $$create_method_at_object_level.$$p = null;
    return $send($$('Object'), 'define_method', [element], function $$1(params){var user_proc = $$1.$$p || nil, self = $$1.$$s == null ? this : $$1.$$s;

      $$1.$$p = null;
      
      ;
      if (params == null) params = nil;
      return $send(self.$grab("view"), 'send', [element, params], user_proc.$to_proc());}, {$$arity: -1, $$s: self})
  }, 1);
};

Opal.modules["atome/version"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $const_set = Opal.const_set, $nesting = [], nil = Opal.nil;

  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'Atome');

    var $nesting = [self].concat($parent_nesting);

    return $const_set($nesting[0], 'VERSION', "0.5.2.4")
  })($nesting[0], null, $nesting)
};

Opal.modules["atome/genesis/generators/event"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $eqeq = Opal.eqeq, $hash2 = Opal.hash2, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_particle,build_sanitizer,==,build_option');
  
  generator = $$('Genesis').$generator();
  generator.$build_particle("touch");
  generator.$build_particle("play");
  generator.$build_particle("time");
  generator.$build_particle("pause");
  generator.$build_particle("on");
  generator.$build_particle("fullscreen");
  generator.$build_particle("mute");
  generator.$build_particle("at");
  generator.$build_particle("drag");
  $send(generator, 'build_sanitizer', ["drag"], function $$1(params){
    
    if (params == null) params = nil;
    if ($eqeq(params, true)) {
      params = $hash2(["move"], {"move": true})
    };
    return params;}, 1);
  $send(generator, 'build_particle', ["sort"], function $$2(_value, sort_proc){var self = $$2.$$s == null ? this : $$2.$$s;

    
    if (_value == null) _value = nil;
    if (sort_proc == null) sort_proc = nil;
    return (self.sort_proc = sort_proc);}, {$$arity: 2, $$s: self});
  generator.$build_particle("targets");
  generator.$build_particle("start");
  $send(generator, 'build_option', ["pre_render_start"], function $$3(_value, user_proc){var self = $$3.$$s == null ? this : $$3.$$s;

    
    if (_value == null) _value = nil;
    if (user_proc == null) user_proc = nil;
    return (self.animation_start_proc = user_proc);}, {$$arity: 2, $$s: self});
  generator.$build_particle("stop");
  $send(generator, 'build_option', ["pre_render_stop"], function $$4(_value, user_proc){var self = $$4.$$s == null ? this : $$4.$$s;

    
    if (_value == null) _value = nil;
    if (user_proc == null) user_proc = nil;
    return (self.animation_stop_proc = user_proc);}, {$$arity: 2, $$s: self});
  generator.$build_particle("begin");
  generator.$build_particle("end");
  generator.$build_particle("duration");
  generator.$build_particle("mass");
  generator.$build_particle("damping");
  generator.$build_particle("stiffness");
  generator.$build_particle("velocity");
  generator.$build_particle("repeat");
  generator.$build_particle("ease");
  return generator.$build_particle("unbind");
};

Opal.modules["atome/kernel/essentials"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $def = Opal.def, $return_ivar = Opal.return_ivar, $truthy = Opal.truthy, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('private,[],to_s');
  return (function($base, $super) {
    var self = $klass($base, $super, 'Atome');

    var $proto = self.$$prototype;

    $proto.atome = $proto.value = $proto.result = nil;
    
    self.$private();
    
    $def(self, '$get', function $$get(element) {
      var self = this;

      return self.atome['$[]'](element)
    }, 1);
    
    $def(self, '$value', $return_ivar("atome"), 0);
    return $def(self, '$to_s', function $$to_s() {
      var self = this;

      
      if ($truthy(self.value)) {
        self.result = self.value.$to_s()
      } else if ($truthy(self.atome)) {
        self.result = self.atome.$to_s()
      };
      return self.result.$to_s();
    }, 0);
  })($nesting[0], null)
};

Opal.modules["atome/renderers/browser/helpers/text_helper"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $send = Opal.send, $defs = Opal.defs, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('[]=,style,text=,browser_object');
  return (function($base) {
    var self = $module($base, 'BrowserHelper');

    
    
    $defs(self, '$browser_left_text', function $$browser_left_text(value, browser_object, _atome) {
      var $a;

      return ($a = ["left", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_right_text', function $$browser_right_text(value, browser_object, _atome) {
      var $a;

      return ($a = ["right", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_top_text', function $$browser_top_text(value, browser_object, _atome) {
      var $a;

      return ($a = ["top", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_bottom_text', function $$browser_bottom_text(value, browser_object, _atome) {
      var $a;

      return ($a = ["bottom", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    return $defs(self, '$browser_data_text', function $$browser_data_text(value, atome_send) {
      var $a;

      return ($a = [value], $send(atome_send.$browser_object(), 'text=', $a), $a[$a.length - 1])
    }, 2);
  })($nesting[0])
};

Opal.modules["atome/renderers/server/server"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var self = Opal.top, nil = Opal.nil;

  Opal.add_stubs('require');
  return self.$require("atome/renderers/server/utility")
};

Opal.modules["atome/genesis/generators/effect"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_particle');
  
  generator = $$('Genesis').$generator();
  generator.$build_particle("smooth");
  return generator.$build_particle("blur");
};

Opal.modules["atome/renderers/headless/headless"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var self = Opal.top, nil = Opal.nil;

  Opal.add_stubs('require');
  return self.$require("atome/renderers/headless/utility")
};

Opal.modules["fileutils"] = Opal.return_val(Opal.nil); /* Generated by Opal 1.6.0 */

Opal.modules["atome/renderers/browser/helpers/shadow_helper"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $send = Opal.send, $rb_times = Opal.rb_times, $defs = Opal.defs, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('[]=,[],*');
  return (function($base) {
    var self = $module($base, 'BrowserHelper');

    
    
    $defs(self, '$browser_left_shadow', function $$browser_left_shadow(value, _browser_object, atome) {
      var $a, ls_left = nil, ls_top = nil, ls_blur = nil, red = nil, green = nil, blue = nil, direction = nil, alpha = nil, shadow_updated = nil;

      
      ls_left = "" + (($a = ["left", value], $send(atome, '[]=', $a), $a[$a.length - 1])) + "px";
      ls_top = "" + (atome['$[]']("top")) + "px";
      ls_blur = "" + (atome['$[]']("blur")) + "px";
      red = $rb_times(atome['$[]']("red"), 255);
      green = $rb_times(atome['$[]']("green"), 255);
      blue = $rb_times(atome['$[]']("blue"), 255);
      direction = atome['$[]']("direction");
      alpha = atome['$[]']("alpha");
      shadow_updated = "" + (ls_left) + " " + (ls_top) + " " + (ls_blur) + " rgba(" + (red) + ", " + (green) + ", " + (blue) + ", " + (alpha) + ") " + (direction);
      return document.getElementById(atome['$[]']("id")).sheet.cssRules[0].style.boxShadow = shadow_updated;
    }, 3);
    return $defs(self, '$browser_top_shadow', function $$browser_top_shadow(value, _browser_object, atome) {
      var $a, rs_left = nil, rs_top = nil, rs_blur = nil, red = nil, green = nil, blue = nil, direction = nil, alpha = nil, shadow_updated = nil;

      
      rs_left = "" + (atome['$[]']("left")) + "px";
      rs_top = "" + (($a = ["top", value], $send(atome, '[]=', $a), $a[$a.length - 1])) + "px";
      rs_blur = "" + (atome['$[]']("blur")) + "px";
      red = $rb_times(atome['$[]']("red"), 255);
      green = $rb_times(atome['$[]']("green"), 255);
      blue = $rb_times(atome['$[]']("blue"), 255);
      direction = atome['$[]']("direction");
      alpha = atome['$[]']("alpha");
      shadow_updated = "" + (rs_left) + "px " + (rs_top) + "px " + (rs_blur) + "px rgba(" + (red) + ", " + (green) + ", " + (blue) + ", " + (alpha) + ") " + (direction);
      return document.getElementById(atome['$[]']("id")).sheet.cssRules[0].style.boxShadow = shadow_updated;
    }, 3);
  })($nesting[0])
};

Opal.modules["atome/presets/atome"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $truthy = Opal.truthy, $hash2 = Opal.hash2, $def = Opal.def, $send = Opal.send, $hash = Opal.hash, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('[],default_params,[]=,merge,length,atomes,value,id,atome_common,new,to_proc');
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'Atome');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    
    
    $def(self, '$atome_common', function $$atome_common(atome_type, generated_id, generated_render, generated_parents, params) {
      var temp_default = nil, $ret_or_1 = nil;

      
      temp_default = ($truthy(($ret_or_1 = $$('Essentials').$default_params()['$[]'](atome_type))) ? ($ret_or_1) : ($hash2([], {})));
      temp_default['$[]=']("id", generated_id);
      temp_default['$[]=']("parents", generated_parents);
      temp_default['$[]=']("renderers", generated_render);
      return temp_default.$merge(params);
    }, 5);
    
    $def(self, '$box', function $$box(params) {
      var bloc = $$box.$$p || nil, self = this, default_renderer = nil, atome_type = nil, generated_render = nil, $ret_or_1 = nil, generated_id = nil, generated_parents = nil;

      $$box.$$p = null;
      
      ;
      if (params == null) params = $hash2([], {});
      default_renderer = $$('Essentials').$default_params()['$[]']("render_engines");
      atome_type = "box";
      generated_render = ($truthy(($ret_or_1 = params['$[]']("renderers"))) ? ($ret_or_1) : (default_renderer));
      generated_id = ($truthy(($ret_or_1 = params['$[]']("id"))) ? ($ret_or_1) : ("" + (atome_type) + "_" + ($$('Universe').$atomes().$length())));
      generated_parents = ($truthy(($ret_or_1 = params['$[]']("parents"))) ? ($ret_or_1) : ([self.$id().$value()]));
      params = self.$atome_common(atome_type, generated_id, generated_render, generated_parents, params);
      return $send($$('Atome'), 'new', [$hash(atome_type, params)], bloc.$to_proc());
    }, -1);
    
    $def(self, '$circle', function $$circle(params) {
      var bloc = $$circle.$$p || nil, self = this, default_renderer = nil, atome_type = nil, generated_render = nil, $ret_or_1 = nil, generated_id = nil, generated_parents = nil;

      $$circle.$$p = null;
      
      ;
      if (params == null) params = $hash2([], {});
      default_renderer = $$('Essentials').$default_params()['$[]']("render_engines");
      atome_type = "circle";
      generated_render = ($truthy(($ret_or_1 = params['$[]']("renderers"))) ? ($ret_or_1) : (default_renderer));
      generated_id = ($truthy(($ret_or_1 = params['$[]']("id"))) ? ($ret_or_1) : ("" + (atome_type) + "_" + ($$('Universe').$atomes().$length())));
      generated_parents = ($truthy(($ret_or_1 = params['$[]']("parents"))) ? ($ret_or_1) : ([self.$id().$value()]));
      params = self.$atome_common(atome_type, generated_id, generated_render, generated_parents, params);
      return $send($$('Atome'), 'new', [$hash(atome_type, params)], bloc.$to_proc());
    }, -1);
    
    $def(self, '$image', function $$image(params) {
      var bloc = $$image.$$p || nil, self = this, default_renderer = nil, generated_id = nil, $ret_or_1 = nil, generated_render = nil, generated_parents = nil, temp_default = nil;

      $$image.$$p = null;
      
      ;
      if (params == null) params = $hash2([], {});
      default_renderer = $$('Essentials').$default_params()['$[]']("render_engines");
      generated_id = ($truthy(($ret_or_1 = params['$[]']("id"))) ? ($ret_or_1) : ("image_" + ($$('Universe').$atomes().$length())));
      generated_render = ($truthy(($ret_or_1 = params['$[]']("renderers"))) ? ($ret_or_1) : (default_renderer));
      generated_parents = ($truthy(($ret_or_1 = params['$[]']("parents"))) ? ($ret_or_1) : (self.$id().$value()));
      temp_default = $hash2(["renderers", "id", "type", "parents", "children", "width", "height", "path"], {"renderers": generated_render, "id": generated_id, "type": "image", "parents": [generated_parents], "children": [], "width": 99, "height": 99, "path": "./medias/images/atome.svg"});
      params = temp_default.$merge(params);
      return $send($$('Atome'), 'new', [$hash2(["image"], {"image": params})], bloc.$to_proc());
    }, -1);
    
    $def(self, '$text', function $$text(params) {
      var bloc = $$text.$$p || nil, self = this, default_renderer = nil, atome_type = nil, generated_render = nil, $ret_or_1 = nil, generated_id = nil, generated_parents = nil;

      $$text.$$p = null;
      
      ;
      if (params == null) params = $hash2([], {});
      default_renderer = $$('Essentials').$default_params()['$[]']("render_engines");
      atome_type = "text";
      generated_render = ($truthy(($ret_or_1 = params['$[]']("renderers"))) ? ($ret_or_1) : (default_renderer));
      generated_id = ($truthy(($ret_or_1 = params['$[]']("id"))) ? ($ret_or_1) : ("" + (atome_type) + "_" + ($$('Universe').$atomes().$length())));
      generated_parents = ($truthy(($ret_or_1 = params['$[]']("parents"))) ? ($ret_or_1) : ([self.$id().$value()]));
      params = self.$atome_common(atome_type, generated_id, generated_render, generated_parents, params);
      return $send($$('Atome'), 'new', [$hash(atome_type, params)], bloc.$to_proc());
    }, -1);
    
    $def(self, '$element', function $$element(params) {
      var bloc = $$element.$$p || nil, self = this, atome_type = nil, generated_render = nil, $ret_or_1 = nil, generated_id = nil, generated_parents = nil;

      $$element.$$p = null;
      
      ;
      if (params == null) params = $hash2([], {});
      atome_type = "element";
      generated_render = ($truthy(($ret_or_1 = params['$[]']("renderers"))) ? ($ret_or_1) : ([]));
      generated_id = ($truthy(($ret_or_1 = params['$[]']("id"))) ? ($ret_or_1) : ("" + (atome_type) + "_" + ($$('Universe').$atomes().$length())));
      generated_parents = ($truthy(($ret_or_1 = params['$[]']("parents"))) ? ($ret_or_1) : ([self.$id().$value()]));
      params = self.$atome_common(atome_type, generated_id, generated_render, generated_parents, params);
      return $send($$('Atome'), 'new', [$hash(atome_type, params)], bloc.$to_proc());
    }, -1);
    
    $def(self, '$web', function $$web(params) {
      var bloc = $$web.$$p || nil, self = this, default_renderer = nil, generated_id = nil, $ret_or_1 = nil, generated_render = nil, generated_parents = nil, temp_default = nil;

      $$web.$$p = null;
      
      ;
      if (params == null) params = $hash2([], {});
      default_renderer = $$('Essentials').$default_params()['$[]']("render_engines");
      generated_id = ($truthy(($ret_or_1 = params['$[]']("id"))) ? ($ret_or_1) : ("web_" + ($$('Universe').$atomes().$length())));
      generated_render = ($truthy(($ret_or_1 = params['$[]']("renderers"))) ? ($ret_or_1) : (default_renderer));
      generated_parents = ($truthy(($ret_or_1 = params['$[]']("parents"))) ? ($ret_or_1) : (self.$id().$value()));
      temp_default = $hash2(["renderers", "id", "type", "parents", "children", "width", "height", "path"], {"renderers": generated_render, "id": generated_id, "type": "web", "parents": [generated_parents], "children": [], "width": 120, "height": 120, "path": "https://www.youtube.com/embed/usQDazZKWAk"});
      params = temp_default.$merge(params);
      return $send($$('Atome'), 'new', [$hash2(["image"], {"image": params})], bloc.$to_proc());
    }, -1);
    return $def(self, '$animation', function $$animation(params) {
      var bloc = $$animation.$$p || nil, self = this, default_renderer = nil, atome_type = nil, generated_render = nil, $ret_or_1 = nil, generated_id = nil, generated_parents = nil;

      $$animation.$$p = null;
      
      ;
      if (params == null) params = $hash2([], {});
      default_renderer = $$('Essentials').$default_params()['$[]']("render_engines");
      atome_type = "animation";
      generated_render = ($truthy(($ret_or_1 = params['$[]']("renderers"))) ? ($ret_or_1) : (default_renderer));
      generated_id = ($truthy(($ret_or_1 = params['$[]']("id"))) ? ($ret_or_1) : ("" + (atome_type) + "_" + ($$('Universe').$atomes().$length())));
      generated_parents = ($truthy(($ret_or_1 = params['$[]']("parents"))) ? ($ret_or_1) : ([]));
      params = self.$atome_common(atome_type, generated_id, generated_render, generated_parents, params);
      return $send($$('Atome'), 'new', [$hash(atome_type, params)], bloc.$to_proc());
    }, -1);
  })($nesting[0], null, $nesting)
};

Opal.modules["atome/renderers/html/html"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $def = Opal.def, $return_val = Opal.return_val, self = Opal.top, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('require,aleputsrt,class');
  
  self.$require("atome/renderers/html/effect");
  self.$require("atome/renderers/html/event");
  self.$require("atome/renderers/html/geometry");
  self.$require("atome/renderers/html/identity");
  self.$require("atome/renderers/html/spatial");
  self.$require("atome/renderers/html/atome");
  self.$require("atome/renderers/html/utility");
  return (function($base, $super) {
    var self = $klass($base, $super, 'Html');

    var $proto = self.$$prototype;

    $proto.html = nil;
    
    
    $def(self, '$initialize', function $$initialize() {
      var self = this, html = nil;

      
      html = document.createElement("div");
      document.body.appendChild(html);
      document.body.appendChild(html);
      return (self.html = html);
    }, 0);
    
    $def(self, '$add_class', function $$add_class(class_to_add) {
      var self = this;

      return self.html.classList.add(class_to_add)
    }, 1);
    
    $def(self, '$attr', function $$attr(attribute, value) {
      var self = this;

      return self.html.setAttribute(attribute, value)
    }, 2);
    
    $def(self, '$style', $return_val(nil), 0);
    
    $def(self, '$append_shape', function $$append_shape(parent) {
      var self = this, parent_found = nil;

      
      parent_found = document.getElementById(parent);
      parent_found;
      return parent_found.appendChild(self.html);
    }, 1);
    
    $def(self, '$append_color', function $$append_color(parent) {
      var self = this;

      return self.$aleputsrt("color : " + (parent.$class()))
    }, 1);
    return $def(self, '$append_to', $return_val(nil), 0);
  })($nesting[0], null);
};

Opal.modules["atome/renderers/browser/helpers/animation_helper"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $hash2 = Opal.hash2, $defs = Opal.defs, $eqeqeq = Opal.eqeqeq, $send = Opal.send, $truthy = Opal.truthy, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('===,[],atome,grab,atome_js,anim_value_analysis,anim_convertor,send_anim_to_js,[]=,delete,each,sanitize_anim_params,anim_pop_motion_converter,play_active_proc=,begin_animation');
  return (function($base, $parent_nesting) {
    var self = $module($base, 'BrowserHelper');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    
    $defs(self, '$anim_convertor', function $$anim_convertor(value) {
      
      return $hash2(["left", "right", "top", "bottom", "smooth", "left_add", "right_add", "width", "height"], {"left": ["left", "" + (value) + "px"], "right": ["right", "" + (value) + "px"], "top": ["top", "" + (value) + "px"], "bottom": ["bottom", "" + (value) + "px"], "smooth": ["border-radius", "" + (value) + "px"], "left_add": ["transform", "translateX(" + (value) + "px)"], "right_add": ["transform", "translateY(" + (value) + "px)"], "width": ["width", "" + (value) + "px"], "height": ["height", "" + (value) + "px"]})
    }, 1);
    $defs(self, '$anim_value_analysis', function $$anim_value_analysis(value, particle_found, atome_found) {
      var self = this, $ret_or_1 = nil;

      
      if ($eqeqeq("self", ($ret_or_1 = value))) {
        value = atome_found.$atome()['$[]'](particle_found)
      } else if ($eqeqeq($$('Integer'), $ret_or_1)) {
        value
      } else {
        
        value = self.$grab(value).$atome()['$[]'](particle_found);
        value;
      };
      return value;
    }, 3);
    $defs(self, '$send_anim_to_js', function $$send_anim_to_js(animation, atome_hash, atome_found, atome_id, animation_atome) {
      var self = this, animated_particle = nil, start_value = nil, end_value = nil, original_particle = nil;

      
      animated_particle = animation['$[]'](0);
      start_value = animation['$[]'](1);
      end_value = animation['$[]'](2);
      original_particle = animation['$[]'](3);
      return self.$atome_js().animate(animated_particle, atome_hash['$[]']("duration"), atome_hash['$[]']("damping"), atome_hash['$[]']("ease"), atome_hash['$[]']("mass"), atome_hash['$[]']("repeat"), atome_hash['$[]']("stiffness"), atome_hash['$[]']("velocity"), start_value, end_value, atome_id, atome_found, atome_hash, original_particle, animation_atome);
    }, 5);
    $defs(self, '$sanitize_anim_params', function $$sanitize_anim_params(value, particle_found, atome_hash, atome_found, atome_id, animation_atome) {
      var self = this, start_value = nil, end_value = nil, animated_particle = nil, animation = nil;

      
      start_value = self.$anim_value_analysis(value, particle_found, atome_found);
      start_value = $$('BrowserHelper').$anim_convertor(start_value)['$[]'](particle_found)['$[]'](1);
      end_value = self.$anim_value_analysis(atome_hash['$[]']("end")['$[]'](particle_found), particle_found, atome_found);
      end_value = $$('BrowserHelper').$anim_convertor(end_value)['$[]'](particle_found)['$[]'](1);
      animated_particle = $$('BrowserHelper').$anim_convertor(value)['$[]'](particle_found)['$[]'](0);
      animation = [animated_particle, start_value, end_value, particle_found];
      return self.$send_anim_to_js(animation, atome_hash, atome_found, atome_id, animation_atome);
    }, 6);
    $defs(self, '$anim_pop_motion_converter', function $$anim_pop_motion_converter(atome_hash, atome_found, atome_id, animation_atome) {
      var self = this;

      
      atome_hash['$[]=']("dampingRatio", atome_hash.$delete("damping"));
      return $send(atome_hash['$[]']("begin"), 'each', [], function $$1(particle_found, value){var self = $$1.$$s == null ? this : $$1.$$s;

        
        if (particle_found == null) particle_found = nil;
        if (value == null) value = nil;
        return self.$sanitize_anim_params(value, particle_found, atome_hash, atome_found, atome_id, animation_atome);}, {$$arity: 2, $$s: self});
    }, 4);
    $defs(self, '$begin_animation', function $$begin_animation(atome_hash, atome_found, atome_id, animation_atome) {
      var self = this;

      return self.$anim_pop_motion_converter(atome_hash, atome_found, atome_id, animation_atome)
    }, 4);
    return $defs(self, '$browser_play_animation', function $$browser_play_animation(_options, _browser_object, atome_hash, animation_atome, proc) {
      var self = this;

      
      if (!$truthy(atome_hash['$[]']("targets"))) {
        atome_hash['$[]=']("targets", ["eDen"])
      };
      animation_atome['$play_active_proc='](proc);
      return $send(atome_hash['$[]']("targets"), 'each', [], function $$2(target){var self = $$2.$$s == null ? this : $$2.$$s, atome_found = nil, atome_id = nil;

        
        if (target == null) target = nil;
        atome_found = self.$grab(target);
        atome_id = atome_found.$atome()['$[]']("id");
        return self.$begin_animation(atome_hash, atome_found, atome_id, animation_atome);}, {$$arity: 1, $$s: self});
    }, 5);
  })($nesting[0], $nesting)
};

Opal.modules["atome/renderers/browser/helpers/web_helper"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $send = Opal.send, $defs = Opal.defs, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('[]=,style,append_to,[],browser_document');
  return (function($base) {
    var self = $module($base, 'BrowserHelper');

    
    
    $defs(self, '$browser_left_web', function $$browser_left_web(value, browser_object, _atome) {
      var $a;

      return ($a = ["left", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_right_web', function $$browser_right_web(value, browser_object, _atome) {
      var $a;

      return ($a = ["right", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_top_web', function $$browser_top_web(value, browser_object, _atome) {
      var $a;

      return ($a = ["top", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_bottom_web', function $$browser_bottom_web(value, browser_object, _atome) {
      var $a;

      return ($a = ["bottom", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_path_web', function $$browser_path_web(value, browser_object, _atome) {
      var $a;

      return ($a = ["src", value], $send(browser_object, '[]=', $a), $a[$a.length - 1])
    }, 3);
    return $defs(self, '$browser_attach_web', function $$browser_attach_web(parents, html_object, _atome) {
      var self = this;

      return html_object.$append_to(self.$browser_document()['$[]'](parents))
    }, 3);
  })($nesting[0])
};

Opal.modules["atome/atome"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $hash2 = Opal.hash2, $send = Opal.send, $truthy = Opal.truthy, $def = Opal.def, $eqeq = Opal.eqeq, $hash = Opal.hash, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('include,private,each_value,[]=,create_particle,set_type,[],collapse,define_method,==,is_a?,instance_exec,to_proc,sanitize,send,get_particle,particle_creation,create_atome,atome_creation_pre_treatment,get_atome,create_method_at_object_level,get_optional_method,broadcasting,inject_value,public,attr_accessor,attr_reader,security_pass,store_code_bloc,run_optional_proc,to_sym,rendering,store_value,new,value=,real_atome=,property=,user_proc=,connected');
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'Atome');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting), $proto = self.$$prototype;

    $proto.atome = $proto.property = $proto.real_atome = nil;
    
    self.$include($$('Essentials'));
    self.$private();
    
    $def(self, '$initialize', function $$initialize(atomes) {
      var atomes_proc = $$initialize.$$p || nil, self = this;

      $$initialize.$$p = null;
      
      ;
      if (atomes == null) atomes = $hash2([], {});
      return $send(atomes, 'each_value', [], function $$1(elements){var self = $$1.$$s == null ? this : $$1.$$s;
        if (self.atome == null) self.atome = nil;

        
        if (elements == null) elements = nil;
        self.broadcast = $hash2([], {});
        self.at_time = $hash2([], {});
        self.markers = $hash2([], {});
        if ($truthy(atomes_proc)) {
          elements['$[]=']("code", atomes_proc)
        };
        self.atome = elements;
        self.$create_particle("type");
        self.$set_type(self.atome['$[]']("type"));
        return self.$collapse();}, {$$arity: 1, $$s: self});
    }, -1);
    
    $def(self, '$new_particle', function $$new_particle(element) {
      var method_proc = $$new_particle.$$p || nil, self = this;

      $$new_particle.$$p = null;
      
      ;
      return $send($$('Atome'), 'define_method', [element], function $$2(params){var user_proc = $$2.$$p || nil, self = $$2.$$s == null ? this : $$2.$$s;

        $$2.$$p = null;
        
        ;
        if (params == null) params = nil;
        if (($truthy(params) || ($eqeq(params, false)))) {
          
          if ($truthy(method_proc['$is_a?']($$('Proc')))) {
            $send(self, 'instance_exec', [params, user_proc], method_proc.$to_proc())
          };
          params = self.$sanitize(element, params);
          self.$create_particle(element);
          return $send(self, 'send', ["set_" + (element), params], user_proc.$to_proc());
        } else {
          return $send(self, 'get_particle', [element], user_proc.$to_proc())
        };}, {$$arity: -1, $$s: self});
    }, 1);
    
    $def(self, '$additional_particle_methods', function $$additional_particle_methods(element) {
      var method_proc = $$additional_particle_methods.$$p || nil, self = this;

      $$additional_particle_methods.$$p = null;
      
      ;
      return $send($$('Atome'), 'define_method', ["" + (element) + "="], function $$3(params){var user_proc = $$3.$$p || nil, self = $$3.$$s == null ? this : $$3.$$s;

        $$3.$$p = null;
        
        ;
        if (params == null) params = nil;
        if ($truthy(method_proc['$is_a?']($$('Proc')))) {
          $send(self, 'instance_exec', [params, user_proc], method_proc.$to_proc())
        };
        params = self.$sanitize(element, params);
        return $send(self, 'particle_creation', [element, params], user_proc.$to_proc());}, {$$arity: -1, $$s: self});
    }, 1);
    
    $def(self, '$atome_creation_pre_treatment', function $$atome_creation_pre_treatment(element, params) {
      var user_proc = $$atome_creation_pre_treatment.$$p || nil, self = this;

      $$atome_creation_pre_treatment.$$p = null;
      
      ;
      params = self.$sanitize(element, params);
      self.$create_atome(element);
      return $send(self, 'send', ["set_" + (element), params], user_proc.$to_proc());
    }, 2);
    
    $def(self, '$new_atome', function $$new_atome(element) {
      var method_proc = $$new_atome.$$p || nil, self = this;

      $$new_atome.$$p = null;
      
      ;
      $send($$('Atome'), 'define_method', [element], function $$4(params){var user_proc = $$4.$$p || nil, self = $$4.$$s == null ? this : $$4.$$s;

        $$4.$$p = null;
        
        ;
        if (params == null) params = nil;
        if ($truthy(params)) {
          
          if ($truthy(method_proc['$is_a?']($$('Proc')))) {
            $send(self, 'instance_exec', [params, user_proc], method_proc.$to_proc())
          };
          return $send(self, 'atome_creation_pre_treatment', [element, params], user_proc.$to_proc());
        } else {
          return $send(self, 'get_atome', [element], user_proc.$to_proc())
        };}, {$$arity: -1, $$s: self});
      return self.$create_method_at_object_level(element);
    }, 1);
    
    $def(self, '$new_render_engine', function $$new_render_engine(renderer_name) {
      var method_proc = $$new_render_engine.$$p || nil, self = this;

      $$new_render_engine.$$p = null;
      
      ;
      return $send($$('Atome'), 'define_method', [renderer_name], function $$5(params){var user_proc = $$5.$$p || nil, self = $$5.$$s == null ? this : $$5.$$s;

        $$5.$$p = null;
        
        ;
        if (params == null) params = nil;
        if ($truthy(method_proc['$is_a?']($$('Proc')))) {
          return $send(self, 'instance_exec', [params, user_proc], method_proc.$to_proc())
        } else {
          return nil
        };}, {$$arity: -1, $$s: self});
    }, 1);
    
    $def(self, '$run_optional_proc', function $$run_optional_proc(proc_name, atome, value) {
      var user_proc = $$run_optional_proc.$$p || nil, self = this, option_found = nil;

      $$run_optional_proc.$$p = null;
      
      ;
      if (atome == null) atome = self;
      if (value == null) value = "";
      option_found = $$('Universe').$get_optional_method(proc_name);
      if ($truthy(option_found['$is_a?']($$('Proc')))) {
        return $send(atome, 'instance_exec', [value, user_proc], option_found.$to_proc())
      } else {
        return nil
      };
    }, -2);
    
    $def(self, '$inject_value', function $$inject_value(element, value) {
      var $a, self = this;

      return ($a = [element, value], $send(self.atome, '[]=', $a), $a[$a.length - 1])
    }, 2);
    
    $def(self, '$store_value', function $$store_value(element, value) {
      var self = this;

      
      self.$broadcasting(element, value);
      return self.$inject_value(element, value);
    }, 2);
    self.$public();
    self.$attr_accessor("property", "value", "real_atome", "user_proc", "markers");
    self.$attr_reader("atome", "structure", "at_time");
    
    $def(self, '$set', function $$set(value) {
      var $a, self = this;

      return ($a = [self.property, value], $send(self.real_atome, '[]=', $a), $a[$a.length - 1])
    }, 1);
    
    $def(self, '$particle_creation', function $$particle_creation(element, params) {
      var user_proc = $$particle_creation.$$p || nil, self = this;

      $$particle_creation.$$p = null;
      
      ;
      if (!$truthy(self.$security_pass(element, params))) {
        return false
      };
      if ($truthy(user_proc)) {
        $send(self, 'store_code_bloc', [element], user_proc.$to_proc())
      };
      $send(self, 'run_optional_proc', [(("pre_render_") + (element)).$to_sym(), self, params], user_proc.$to_proc());
      $send(self, 'rendering', [element, params], user_proc.$to_proc());
      $send(self, 'run_optional_proc', [(("post_render_") + (element)).$to_sym(), self, params], user_proc.$to_proc());
      self.$store_value(element, params);
      return self;
    }, 2);
    
    $def(self, '$create_particle', function $$create_particle(element) {
      var $yield = $$create_particle.$$p || nil, self = this;

      $$create_particle.$$p = null;
      return $send($$('Atome'), 'define_method', ["set_" + (element)], function $$6(params){var user_proc = $$6.$$p || nil, self = $$6.$$s == null ? this : $$6.$$s;

        $$6.$$p = null;
        
        ;
        if (params == null) params = nil;
        return $send(self, 'particle_creation', [element, params], user_proc.$to_proc());}, {$$arity: 1, $$s: self})
    }, 1);
    
    $def(self, '$get', function $$get(element) {
      var self = this;

      return self.atome['$[]'](element)
    }, 1);
    
    $def(self, '$get_particle', function $$get_particle(element) {
      var user_proc = $$get_particle.$$p || nil, self = this, virtual_atome = nil;

      $$get_particle.$$p = null;
      
      ;
      virtual_atome = $$('Atome').$new($hash2([], {}));
      virtual_atome['$value='](self.atome['$[]'](element));
      virtual_atome['$real_atome='](self.atome);
      virtual_atome['$property='](element);
      virtual_atome['$user_proc='](user_proc);
      $send(self, 'run_optional_proc', [(("pre_get_") + (element)).$to_sym(), virtual_atome], user_proc.$to_proc());
      return virtual_atome;
    }, 1);
    
    $def(self, '$get_atome', function $$get_atome(element) {
      var user_proc = $$get_atome.$$p || nil, self = this, virtual_atome = nil;

      $$get_atome.$$p = null;
      
      ;
      virtual_atome = $$('Atome').$new($hash2([], {}));
      virtual_atome['$real_atome='](self.atome);
      virtual_atome['$property='](element);
      virtual_atome['$user_proc='](user_proc);
      virtual_atome['$value='](self.atome['$[]'](element));
      return virtual_atome;
    }, 1);
    
    $def(self, '$create_atome', function $$create_atome(new_atome) {
      var $yield = $$create_atome.$$p || nil;

      $$create_atome.$$p = null;
      return $send($$('Atome'), 'define_method', ["set_" + (new_atome)], function $$7(params){var user_proc = $$7.$$p || nil;

        $$7.$$p = null;
        
        ;
        if (params == null) params = nil;
        return $send($$('Atome'), 'new', [$hash(new_atome, params)], user_proc.$to_proc());}, 1)
    }, 1);
    return $$('Universe').$connected();
  })($nesting[0], null, $nesting)
};

Opal.modules["atome/renderers/browser/spatial"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $eqeq = Opal.eqeq, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,send,[],==,[]=,style,remove_class,add_class');
  
  generator = $$('Genesis').$generator();
  $send(generator, 'build_render', ["browser_left"], function $$1(value, _user_proc){var self = $$1.$$s == null ? this : $$1.$$s;
    if (self.atome == null) self.atome = nil;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    if (_user_proc == null) _user_proc = nil;
    return $$('BrowserHelper').$send("browser_left_" + (self.atome['$[]']("type")), value, self.browser_object, self.atome);}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["browser_right"], function $$2(value, _user_proc){var self = $$2.$$s == null ? this : $$2.$$s;
    if (self.atome == null) self.atome = nil;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    if (_user_proc == null) _user_proc = nil;
    return $$('BrowserHelper').$send("browser_right_" + (self.atome['$[]']("type")), value, self.browser_object, self.atome);}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["browser_top"], function $$3(value, _user_proc){var self = $$3.$$s == null ? this : $$3.$$s;
    if (self.atome == null) self.atome = nil;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    if (_user_proc == null) _user_proc = nil;
    return $$('BrowserHelper').$send("browser_top_" + (self.atome['$[]']("type")), value, self.browser_object, self.atome);}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["browser_bottom"], function $$4(value, _user_proc){var self = $$4.$$s == null ? this : $$4.$$s;
    if (self.atome == null) self.atome = nil;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    if (_user_proc == null) _user_proc = nil;
    return $$('BrowserHelper').$send("browser_bottom_" + (self.atome['$[]']("type")), value, self.browser_object, self.atome);}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["browser_rotate"], function $$5(value, _user_proc){var $a, self = $$5.$$s == null ? this : $$5.$$s;
    if (self.browser_type == null) self.browser_type = nil;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    if (_user_proc == null) _user_proc = nil;
    if ($eqeq(self.browser_type, "style")) {
      return nil
    } else {
      return ($a = ["transform", "rotate(" + (value) + "deg)"], $send(self.browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    };}, {$$arity: 2, $$s: self});
  return $send(generator, 'build_render', ["browser_center"], function $$6(value, _user_proc){var $a, self = $$6.$$s == null ? this : $$6.$$s;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    if (_user_proc == null) _user_proc = nil;
    
    switch (value) {
      case "horizontal":
        
        self.browser_object.$remove_class("center");
        self.browser_object.$remove_class("center_vertical");
        self.browser_object.$add_class("center_horizontal");
        self.browser_object.$style()['$[]=']("bottom", "auto");
        self.browser_object.$style()['$[]=']("right", "auto");
        self.browser_object.$style()['$[]=']("top", "0px");
        return ($a = ["left", "50%"], $send(self.browser_object.$style(), '[]=', $a), $a[$a.length - 1]);
      case "vertical":
        
        self.browser_object.$remove_class("center");
        self.browser_object.$remove_class("center_horizontal");
        self.browser_object.$add_class("center_vertical");
        self.browser_object.$style()['$[]=']("bottom", "auto");
        self.browser_object.$style()['$[]=']("right", "auto");
        self.browser_object.$style()['$[]=']("left", "0px");
        return ($a = ["top", "50%"], $send(self.browser_object.$style(), '[]=', $a), $a[$a.length - 1]);
      default:
        
        self.browser_object.$remove_class("center_vertical");
        self.browser_object.$remove_class("center_horizontal");
        self.browser_object.$add_class("center");
        self.browser_object.$style()['$[]=']("bottom", "auto");
        self.browser_object.$style()['$[]=']("right", "auto");
        self.browser_object.$style()['$[]=']("left", "50%");
        return ($a = ["top", "50%"], $send(self.browser_object.$style(), '[]=', $a), $a[$a.length - 1]);
    };}, {$$arity: 2, $$s: self});
};

Opal.modules["atome/renderers/browser/helpers/effect_helper"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $defs = Opal.defs, $send = Opal.send, $rb_times = Opal.rb_times, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('alert,[],[]=,*,style');
  return (function($base) {
    var self = $module($base, 'BrowserHelper');

    
    
    $defs(self, '$common_shadow_helper', function $$common_shadow_helper() {
      var self = this;

      return self.$alert("zgeg")
    }, 0);
    $defs(self, '$browser_blur_style', function $$browser_blur_style(_browser_object, value, atome) {
      var $a, b_left = nil, b_top = nil, b_blur = nil, b_red = nil, b_green = nil, b_blue = nil, b_direction = nil, b_alpha = nil, shadow_updated = nil;

      
      b_left = "" + (atome['$[]']("left")) + "px";
      b_top = "" + (atome['$[]']("top")) + "px";
      b_blur = "" + (($a = ["blur", value], $send(atome, '[]=', $a), $a[$a.length - 1])) + "px";
      b_red = $rb_times(atome['$[]']("red"), 255);
      b_green = $rb_times(atome['$[]']("green"), 255);
      b_blue = $rb_times(atome['$[]']("blue"), 255);
      b_direction = atome['$[]']("direction");
      b_alpha = atome['$[]']("alpha");
      shadow_updated = "" + (b_left) + " " + (b_top) + " " + (b_blur) + " rgba(" + (b_red) + ", " + (b_green) + ", " + (b_blue) + ", " + (b_alpha) + ") " + (b_direction);
      return document.getElementById(atome['$[]']("id")).sheet.cssRules[0].style.boxShadow = shadow_updated;
    }, 3);
    return $defs(self, '$browser_blur_div', function $$browser_blur_div(browser_object, value, _atome) {
      var $a;

      return ($a = ["filter", "blur(" + (value) + "px)"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
  })($nesting[0])
};

Opal.modules["atome/renderers/browser/material"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $rb_times = Opal.rb_times, $eqeq = Opal.eqeq, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,*,[]=,[],send,style,browser_object,==,attributes');
  
  generator = $$('Genesis').$generator();
  $send(generator, 'build_render', ["red"], function $$1(value){var $a, self = $$1.$$s == null ? this : $$1.$$s, red = nil, green = nil, blue = nil, alpha = nil, color_updated = nil;
    if (self.atome == null) self.atome = nil;

    
    if (value == null) value = nil;
    red = $rb_times(($a = ["red", value], $send(self.atome, '[]=', $a), $a[$a.length - 1]), 255);
    green = $rb_times(self.atome['$[]']("green"), 255);
    blue = $rb_times(self.atome['$[]']("blue"), 255);
    alpha = self.atome['$[]']("alpha");
    color_updated = "rgba(" + (red) + ", " + (green) + ", " + (blue) + ", " + (alpha) + ")";
    return $$('BrowserHelper').$send("browser_colorize_" + (self.atome['$[]']("type")), color_updated, self.atome);}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["green"], function $$2(value){var $a, self = $$2.$$s == null ? this : $$2.$$s, red = nil, green = nil, blue = nil, alpha = nil, color_updated = nil;
    if (self.atome == null) self.atome = nil;

    
    if (value == null) value = nil;
    red = $rb_times(self.atome['$[]']("red"), 255);
    green = $rb_times(($a = ["green", value], $send(self.atome, '[]=', $a), $a[$a.length - 1]), 255);
    blue = $rb_times(self.atome['$[]']("blue"), 255);
    alpha = self.atome['$[]']("alpha");
    color_updated = "rgba(" + (red) + ", " + (green) + ", " + (blue) + ", " + (alpha) + ")";
    return $$('BrowserHelper').$send("browser_colorize_" + (self.atome['$[]']("type")), color_updated, self.atome);}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["blue"], function $$3(value){var $a, self = $$3.$$s == null ? this : $$3.$$s, red = nil, green = nil, blue = nil, alpha = nil, color_updated = nil;
    if (self.atome == null) self.atome = nil;

    
    if (value == null) value = nil;
    red = $rb_times(self.atome['$[]']("red"), 255);
    green = $rb_times(self.atome['$[]']("green"), 255);
    blue = $rb_times(($a = ["blue", value], $send(self.atome, '[]=', $a), $a[$a.length - 1]), 255);
    alpha = self.atome['$[]']("alpha");
    color_updated = "rgba(" + (red) + ", " + (green) + ", " + (blue) + ", " + (alpha) + ")";
    return $$('BrowserHelper').$send("browser_colorize_" + (self.atome['$[]']("type")), color_updated, self.atome);}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["alpha"], function $$4(value){var $a, self = $$4.$$s == null ? this : $$4.$$s, red = nil, green = nil, blue = nil, alpha = nil, color_updated = nil;
    if (self.atome == null) self.atome = nil;

    
    if (value == null) value = nil;
    red = $rb_times(self.atome['$[]']("red"), 255);
    green = $rb_times(self.atome['$[]']("green"), 255);
    blue = $rb_times(self.atome['$[]']("blue"), 255);
    alpha = ($a = ["alpha", value], $send(self.atome, '[]=', $a), $a[$a.length - 1]);
    color_updated = "rgba(" + (red) + ", " + (green) + ", " + (blue) + ", " + (alpha) + ")";
    return $$('BrowserHelper').$send("browser_colorize_" + (self.atome['$[]']("type")), color_updated, self.atome);}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["visual"], function $$5(value){var $a, self = $$5.$$s == null ? this : $$5.$$s;

    
    if (value == null) value = nil;
    return ($a = ["font-size", "" + (value['$[]']("size")) + "px"], $send(self.$browser_object().$style(), '[]=', $a), $a[$a.length - 1]);}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["browser_edit"], function $$6(value){var $a, self = $$6.$$s == null ? this : $$6.$$s, caret_color = nil, user_select = nil, selection_color = nil;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    if ($eqeq(value, true)) {
      
      caret_color = "white";
      user_select = "text";
      selection_color = "blue";
    } else {
      
      caret_color = "transparent";
      user_select = "none";
      selection_color = "transparent";
    };
    self.browser_object.$attributes()['$[]=']("contenteditable", value);
    self.browser_object.$style()['$[]=']("caret-color", caret_color);
    self.browser_object.$style()['$[]=']("webkit-user-select", user_select);
    self.browser_object.$style()['$[]=']("-moz-user-select", user_select);
    return ($a = ["user-select", user_select], $send(self.browser_object.$style(), '[]=', $a), $a[$a.length - 1]);}, {$$arity: 1, $$s: self});
  return $send(generator, 'build_render', ["browser_hide"], function $$7(value){var $a, self = $$7.$$s == null ? this : $$7.$$s;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    return ($a = ["display", "none"], $send(self.browser_object.$style(), '[]=', $a), $a[$a.length - 1]);}, {$$arity: 1, $$s: self});
};

Opal.modules["atome/genesis/generators/spatial"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $truthy = Opal.truthy, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_particle,is_a?,instance_exec,to_proc');
  
  generator = $$('Genesis').$generator();
  $send(generator, 'build_particle', ["left"], function $$1(_params, user_proc){var self = $$1.$$s == null ? this : $$1.$$s;

    
    if (_params == null) _params = nil;
    if (user_proc == null) user_proc = nil;
    if ($truthy(user_proc['$is_a?']($$('Proc')))) {
      return $send(self, 'instance_exec', [], user_proc.$to_proc())
    } else {
      return nil
    };}, {$$arity: 2, $$s: self});
  generator.$build_particle("right");
  generator.$build_particle("top");
  generator.$build_particle("bottom");
  generator.$build_particle("rotate");
  generator.$build_particle("direction");
  return generator.$build_particle("center");
};

Opal.modules["atome/renderers/html/spatial"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $eqeq = Opal.eqeq, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,==,[]=,style');
  
  generator = $$('Genesis').$generator();
  $send(generator, 'build_render', ["html_left"], function $$1(value, _user_proc){var $a, self = $$1.$$s == null ? this : $$1.$$s;
    if (self.html_type == null) self.html_type = nil;
    if (self.html_object == null) self.html_object = nil;

    
    if (value == null) value = nil;
    if (_user_proc == null) _user_proc = nil;
    if ($eqeq(self.html_type, "style")) {
      return nil
    } else {
      return ($a = ["left", "" + (value) + "px"], $send(self.html_object.$style(), '[]=', $a), $a[$a.length - 1])
    };}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["html_right"], function $$2(value, _user_proc){var $a, self = $$2.$$s == null ? this : $$2.$$s;
    if (self.html_type == null) self.html_type = nil;
    if (self.html_object == null) self.html_object = nil;

    
    if (value == null) value = nil;
    if (_user_proc == null) _user_proc = nil;
    if ($eqeq(self.html_type, "style")) {
      return nil
    } else {
      return ($a = ["right", "" + (value) + "px"], $send(self.html_object.$style(), '[]=', $a), $a[$a.length - 1])
    };}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["html_top"], function $$3(value, _user_proc){var $a, self = $$3.$$s == null ? this : $$3.$$s;
    if (self.html_type == null) self.html_type = nil;
    if (self.html_object == null) self.html_object = nil;

    
    if (value == null) value = nil;
    if (_user_proc == null) _user_proc = nil;
    if ($eqeq(self.html_type, "style")) {
      return nil
    } else {
      return ($a = ["top", "" + (value) + "px"], $send(self.html_object.$style(), '[]=', $a), $a[$a.length - 1])
    };}, {$$arity: 2, $$s: self});
  return $send(generator, 'build_render', ["html_bottom"], function $$4(value, _user_proc){var $a, self = $$4.$$s == null ? this : $$4.$$s;
    if (self.html_type == null) self.html_type = nil;
    if (self.html_object == null) self.html_object = nil;

    
    if (value == null) value = nil;
    if (_user_proc == null) _user_proc = nil;
    if ($eqeq(self.html_type, "style")) {
      return nil
    } else {
      return ($a = ["bottom", "" + (value) + "px"], $send(self.html_object.$style(), '[]=', $a), $a[$a.length - 1])
    };}, {$$arity: 2, $$s: self});
};

Opal.modules["atome/genesis/generators/identity"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $neqeq = Opal.neqeq, $truthy = Opal.truthy, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_particle,grab,<<,[],atome,refresh,build_sanitizer,!=,update_atome_id,add_to_atomes,build_option,each,children,id,[]=,attach');
  
  generator = $$('Genesis').$generator();
  generator.$build_particle("type");
  generator.$build_particle("parents");
  generator.$build_particle("children");
  $send(generator, 'build_particle', ["link"], function $$1(child_id){var self = $$1.$$s == null ? this : $$1.$$s, child_found = nil;
    if (self.atome == null) self.atome = nil;

    
    if (child_id == null) child_id = nil;
    child_found = self.$grab(child_id);
    child_found.$atome()['$[]']("parents")['$<<'](self.atome['$[]']("id"));
    return child_found.$refresh();}, {$$arity: 1, $$s: self});
  generator.$build_particle("id");
  $send(generator, 'build_sanitizer', ["id"], function $$2(params){var self = $$2.$$s == null ? this : $$2.$$s;
    if (self.atome == null) self.atome = nil;

    
    if (params == null) params = nil;
    if ($neqeq(self.atome['$[]']("id"), params)) {
      $$('Universe').$update_atome_id(params, self, self.atome['$[]']("id"))
    } else {
      $$('Universe').$add_to_atomes(params, self)
    };
    return params;}, {$$arity: 1, $$s: self});
  $send(generator, 'build_option', ["pre_render_parents"], function $$3(parents_id_found){var self = $$3.$$s == null ? this : $$3.$$s;

    
    if (parents_id_found == null) parents_id_found = nil;
    return $send(parents_id_found, 'each', [], function $$4(parents_id){var self = $$4.$$s == null ? this : $$4.$$s, parents_found = nil;

      
      if (parents_id == null) parents_id = nil;
      parents_found = self.$grab(parents_id);
      if ($truthy(parents_found)) {
        return parents_found.$children()['$<<'](self.$id())
      } else {
        return nil
      };}, {$$arity: 1, $$s: self});}, {$$arity: 1, $$s: self});
  generator.$build_particle("name");
  generator.$build_particle("active");
  $send(generator, 'build_particle', ["attach"], function $$5(parents){var self = $$5.$$s == null ? this : $$5.$$s;

    
    if (parents == null) parents = nil;
    return $send(parents, 'each', [], function $$6(parent){var $a, self = $$6.$$s == null ? this : $$6.$$s;

      
      if (parent == null) parent = nil;
      return ($a = ["attached", self.$atome()['$[]']("id")], $send(self.$grab(parent).$atome(), '[]=', $a), $a[$a.length - 1]);}, {$$arity: 1, $$s: self});}, {$$arity: 1, $$s: self});
  return $send(generator, 'build_particle', ["attached"], function $$7(targets){var self = $$7.$$s == null ? this : $$7.$$s;

    
    if (targets == null) targets = nil;
    return $send(targets, 'each', [], function $$8(target){var self = $$8.$$s == null ? this : $$8.$$s;

      
      if (target == null) target = nil;
      return self.$grab(target).$attach([self.$atome()['$[]']("id")]);}, {$$arity: 1, $$s: self});}, {$$arity: 1, $$s: self});
};

Opal.modules["atome/helpers/color_helper/color"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $const_set = Opal.const_set, $klass = Opal.klass, $def = Opal.def, $truthy = Opal.truthy, $send = Opal.send, $rb_le = Opal.rb_le, $rb_lt = Opal.rb_lt, $rb_minus = Opal.rb_minus, $rb_gt = Opal.rb_gt, $to_ary = Opal.to_ary, $alias = Opal.alias, $rb_ge = Opal.rb_ge, $range = Opal.range, $send2 = Opal.send2, $find_super = Opal.find_super, $eqeqeq = Opal.eqeqeq, $to_a = Opal.to_a, $eqeq = Opal.eqeq, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, $$$ = Opal.$$$;

  Opal.add_stubs('equivalent?,first,names,names=,uniq,sort,map,compact,flatten,Array,to_proc,alias_method,<=,abs,<,near_zero?,-,>,near_one?,kind_of?,all?,zip,to_a,coerce,near?,near_zero_or_less?,near_one_or_more?,normalize,end,begin,>=,to_i,normalize_to_range,normalize_byte,normalize_word,require,warn,const_defined?,const_get,upcase,to_s,===,new,==,size,from_html,to_hsl');
  
  (function($base, $parent_nesting) {
    var self = $module($base, 'Color');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    
    $const_set($nesting[0], 'COLOR_VERSION', "1.8");
    $klass($nesting[0], null, 'RGB');
    $klass($nesting[0], null, 'CMYK');
    $klass($nesting[0], null, 'HSL');
    $klass($nesting[0], null, 'GrayScale');
    $klass($nesting[0], null, 'YIQ');
    $const_set($nesting[0], 'COLOR_EPSILON', 1.0e-05);
    $const_set($nesting[0], 'COLOR_TOLERANCE', 0.0001);
    
    $def(self, '$==', function $Color_$eq_eq$1(other) {
      var self = this;

      return $$('Color')['$equivalent?'](self, other)
    }, 1);
    
    $def(self, '$name', function $$name() {
      var self = this;

      return self.$names().$first()
    }, 0);
    
    $def(self, '$names', function $$names() {
      var $a, self = this;
      if (self.names == null) self.names = nil;

      
      if (!$truthy((($a = self['names'], $a != null && $a !== nil) ? 'instance-variable' : nil))) {
        self['$names='](nil)
      };
      return self.names;
    }, 0);
    
    $def(self, '$names=', function $Color_names$eq$2(n) {
      var self = this;

      return (self.names = $send($send(self.$Array(n).$flatten().$compact(), 'map', [], "to_s".$to_proc()), 'map', [], "downcase".$to_proc()).$sort().$uniq())
    }, 1);
    return self.$alias_method("name=", "names=");
  })($nesting[0], $nesting);
  (function(self, $parent_nesting) {
    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    
    
    $def(self, '$near_zero?', function $near_zero$ques$3(value) {
      
      return $rb_le(value.$abs(), $$$($$('Color'), 'COLOR_EPSILON'))
    }, 1);
    
    $def(self, '$near_zero_or_less?', function $near_zero_or_less$ques$4(value) {
      var self = this, $ret_or_1 = nil;

      if ($truthy(($ret_or_1 = $rb_lt(value, 0.0)))) {
        return $ret_or_1
      } else {
        return self['$near_zero?'](value)
      }
    }, 1);
    
    $def(self, '$near_one?', function $near_one$ques$5(value) {
      var self = this;

      return self['$near_zero?']($rb_minus(value, 1.0))
    }, 1);
    
    $def(self, '$near_one_or_more?', function $near_one_or_more$ques$6(value) {
      var self = this, $ret_or_1 = nil;

      if ($truthy(($ret_or_1 = $rb_gt(value, 1.0)))) {
        return $ret_or_1
      } else {
        return self['$near_one?'](value)
      }
    }, 1);
    
    $def(self, '$near?', function $near$ques$7(x, y) {
      
      return $rb_le($rb_minus(x, y).$abs(), $$$($$('Color'), 'COLOR_TOLERANCE'))
    }, 2);
    
    $def(self, '$equivalent?', function $equivalent$ques$8(a, b) {
      var self = this;

      
      if (!($truthy(a['$kind_of?']($$('Color'))) && ($truthy(b['$kind_of?']($$('Color')))))) {
        return false
      };
      return $send(a.$to_a().$zip(a.$coerce(b).$to_a()), 'all?', [], function $$9($mlhs_tmp1){var $a, $b, self = $$9.$$s == null ? this : $$9.$$s, x = nil, y = nil;

        
        if ($mlhs_tmp1 == null) $mlhs_tmp1 = nil;
        $b = $mlhs_tmp1, $a = $to_ary($b), (x = ($a[0] == null ? nil : $a[0])), (y = ($a[1] == null ? nil : $a[1])), $b;
        return self['$near?'](x, y);}, {$$arity: 1, $$s: self, $$has_top_level_mlhs_arg: true});
    }, 2);
    
    $def(self, '$coerce', function $$coerce(a, b) {
      
      return a.$coerce(b)
    }, 2);
    
    $def(self, '$normalize', function $$normalize(value) {
      var self = this;

      if ($truthy(self['$near_zero_or_less?'](value))) {
        return 0.0
      } else if ($truthy(self['$near_one_or_more?'](value))) {
        return 1.0
      } else {
        return value
      }
    }, 1);
    $alias(self, "normalize_fractional", "normalize");
    
    $def(self, '$normalize_to_range', function $$normalize_to_range(value, range) {
      
      
      if ($truthy($rb_lt(range.$end(), range.$begin()))) {
        range = Opal.Range.$new(range.$end(), range.$begin(), false)
      };
      if ($truthy($rb_le(value, range.$begin()))) {
        return range.$begin()
      } else if ($truthy($rb_ge(value, range.$end()))) {
        return range.$end()
      } else {
        return value
      };
    }, 2);
    
    $def(self, '$normalize_byte', function $$normalize_byte(value) {
      var self = this;

      return self.$normalize_to_range(value, $range(0, 255, false)).$to_i()
    }, 1);
    $alias(self, "normalize_8bit", "normalize_byte");
    
    $def(self, '$normalize_word', function $$normalize_word(value) {
      var self = this;

      return self.$normalize_to_range(value, $range(0, 65535, false)).$to_i()
    }, 1);
    return $alias(self, "normalize_16bit", "normalize_word");
  })(Opal.get_singleton_class($$('Color')), $nesting);
  self.$require("atome/helpers/color_helper/color/rgb");
  self.$require("atome/helpers/color_helper/color/cmyk");
  self.$require("atome/helpers/color_helper/color/grayscale");
  self.$require("atome/helpers/color_helper/color/hsl");
  self.$require("atome/helpers/color_helper/color/yiq");
  self.$require("atome/helpers/color_helper/color/css");
  return (function(self, $parent_nesting) {
    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    
    
    $def(self, '$const_missing', function $$const_missing(name) {
      var $yield = $$const_missing.$$p || nil, self = this;

      $$const_missing.$$p = null;
      
      switch (name) {
        case "VERSION":
        case "VERSION":
        case "COLOR_TOOLS_VERSION":
        case "COLOR_TOOLS_VERSION":
          
          self.$warn("Color::" + (name) + " has been deprecated. Use Color::COLOR_VERSION instead.");
          return $$$($$('Color'), 'COLOR_VERSION');
        default:
          if ($truthy($$$($$('Color'), 'RGB')['$const_defined?'](name))) {
            
            self.$warn("Color::" + (name) + " has been deprecated. Use Color::RGB::" + (name) + " instead.");
            return $$$($$('Color'), 'RGB').$const_get(name);
          } else {
            return $send2(self, $find_super(self, 'const_missing', $$const_missing, false, true), 'const_missing', [name], $yield)
          }
      }
    }, 1);
    return $def(self, '$new', function $new$10(values, mode) {
      var self = this, color = nil, $ret_or_1 = nil;

      
      if (mode == null) mode = "rgb";
      self.$warn("Color.new has been deprecated. Use Color::" + (mode.$to_s().$upcase()) + ".new instead.");
      color = ($eqeqeq("hsl", ($ret_or_1 = mode)) ? ($send($$$($$('Color'), 'HSL'), 'new', $to_a(values))) : ($eqeqeq("rgb", $ret_or_1) ? (((values = [values].$flatten()), ($eqeq(values.$size(), 1) ? ($send($$$($$('Color'), 'RGB'), 'from_html', $to_a(values))) : ($send($$$($$('Color'), 'RGB'), 'new', $to_a(values)))))) : ($eqeqeq("cmyk", $ret_or_1) ? ($send($$$($$('Color'), 'CMYK'), 'new', $to_a(values))) : (nil))));
      return color.$to_hsl();
    }, -2);
  })(Opal.get_singleton_class($$('Color')), $nesting);
};

Opal.modules["atome/renderers/server/utility"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render');
  
  generator = $$('Genesis').$generator();
  generator.$build_render("server_schedule");
  return generator.$build_render("server_reader");
};

Opal.modules["atome/renderers/browser/helpers/drag_helper"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $defs = Opal.defs, $send = Opal.send, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('drag_move_proc=,atome_js,!=,to_n,drag_start_proc=,drag_end_proc=');
  return (function($base) {
    var self = $module($base, 'BrowserHelper');

    
    
    $defs(self, '$browser_drag_move', function $$browser_drag_move(params, atome_id, atome, proc) {
      var self = this;

      
      atome['$drag_move_proc='](proc);
      return self.$atome_js().drag(params, atome_id, atome);
    }, 4);
    $defs(self, '$browser_drag_lock', function $$browser_drag_lock(params, atome_id, atome, _proc) {
      var self = this;

      return self.$atome_js().lock(params, atome_id, atome)
    }, 4);
    $defs(self, '$browser_drag_remove', function $$browser_drag_remove(params, atome_id, atome, _proc) {
      var self = this;

      
      params = params['$!='](true);
      return self.$atome_js().remove(params, atome_id, atome);
    }, 4);
    $defs(self, '$browser_drag_snap', function $$browser_drag_snap(params, atome_id, atome, _proc) {
      var self = this;

      return self.$atome_js().snap(params.$to_n(), atome_id, atome)
    }, 4);
    $defs(self, '$browser_drag_inertia', function $$browser_drag_inertia(params, atome_id, atome, _proc) {
      var self = this;

      return self.$atome_js().inertia(params, atome_id, atome)
    }, 4);
    $defs(self, '$browser_drag_constraint', function $$browser_drag_constraint(params, atome_id, atome, _proc) {
      var self = this;

      return self.$atome_js().constraint(params.$to_n(), atome_id, atome)
    }, 4);
    $defs(self, '$browser_drag_start', function $$browser_drag_start(_params, _atome_id, atome, proc) {
      var $a;

      return ($a = [proc], $send(atome, 'drag_start_proc=', $a), $a[$a.length - 1])
    }, 4);
    return $defs(self, '$browser_drag_end', function $$browser_drag_end(_params, _atome_id, atome, proc) {
      var $a;

      return ($a = [proc], $send(atome, 'drag_end_proc=', $a), $a[$a.length - 1])
    }, 4);
  })($nesting[0])
};

Opal.modules["atome/genesis/generators/geometry"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_particle');
  
  generator = $$('Genesis').$generator();
  generator.$build_particle("width");
  return generator.$build_particle("height");
};

Opal.modules["atome/renderers/html/utility"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,remove,html_object,each,[],grab,children');
  
  generator = $$('Genesis').$generator();
  generator.$build_render("html_bloc");
  generator.$build_render("html_id");
  generator.$build_render("html_render");
  $send(generator, 'build_render', ["html_delete"], function $$1(){var $a, self = $$1.$$s == null ? this : $$1.$$s;

    return ($a = self.$html_object(), ($a === nil || $a == null) ? nil : $a.$remove())}, {$$arity: 0, $$s: self});
  $send(generator, 'build_render', ["html_clear"], function $$2(){var self = $$2.$$s == null ? this : $$2.$$s;
    if (self.atome == null) self.atome = nil;

    
    $send(self.atome['$[]']("children"), 'each', [], function $$3(child_found){var $a, self = $$3.$$s == null ? this : $$3.$$s;

      
      if (child_found == null) child_found = nil;
      return ($a = self.$grab(child_found).$html_object(), ($a === nil || $a == null) ? nil : $a.$remove());}, {$$arity: 1, $$s: self});
    return self.$children([]);}, {$$arity: 0, $$s: self});
  generator.$build_render("html_schedule");
  return generator.$build_render("html_reader");
};

Opal.modules["atome/helpers/essentials"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $hash2 = Opal.hash2, $return_ivar = Opal.return_ivar, $defs = Opal.defs, $truthy = Opal.truthy, $def = Opal.def, $send = Opal.send, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('merge!,current_user,[]=,[],merge');
  return (function($base, $parent_nesting) {
    var self = $module($base, 'Essentials');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    
    self.default_params = $hash2(["render_engines", "animation", "element", "box", "circle", "shape", "text", "drm", "shadow"], {"render_engines": ["browser"], "animation": $hash2(["type"], {"type": "animation"}), "element": $hash2(["type", "renderers"], {"type": "element", "renderers": []}), "box": $hash2(["renderers", "id", "type", "parents", "children", "width", "height", "color", "left", "top"], {"renderers": "", "id": "", "type": "shape", "parents": [], "children": [], "width": 99, "height": 99, "color": $hash2(["left", "top", "red", "green", "blue", "alpha", "diffusion"], {"left": 0, "top": 0, "red": 0.1, "green": 0.9, "blue": 0.9, "alpha": 1, "diffusion": "linear"}), "left": 100, "top": 100}), "circle": $hash2(["renderers", "id", "type", "parents", "children", "width", "height", "color", "left", "top", "smooth"], {"renderers": "", "id": "", "type": "shape", "parents": [], "children": [], "width": 99, "height": 99, "color": $hash2(["left", "top", "red", "green", "blue", "alpha", "diffusion"], {"left": 0, "top": 0, "red": 0.1, "green": 0.9, "blue": 0.9, "alpha": 1, "diffusion": "linear"}), "left": 100, "top": 100, "smooth": "100%"}), "shape": $hash2(["renderers", "id", "width", "type", "height", "left", "top", "color", "generator"], {"renderers": "", "id": "", "width": 100, "type": "shape", "height": 100, "left": 100, "top": 100, "color": $hash2(["left", "top", "red", "green", "blue", "alpha", "diffusion"], {"left": 0, "top": 0, "red": 0.1, "green": 0.9, "blue": 0.9, "alpha": 1, "diffusion": "linear"}), "generator": "manual"}), "text": $hash2(["type", "parents", "children", "visual", "data", "width", "height"], {"type": "text", "parents": ["view"], "children": [], "visual": $hash2(["size"], {"size": 25}), "data": "this is a text sample", "width": 199, "height": 33}), "drm": $hash2(["type"], {"type": "drm"}), "shadow": $hash2([], {})});
    $defs(self, '$default_params', $return_ivar("default_params"), 0);
    $defs(self, '$new_default_params', function $$new_default_params(new_default) {
      var self = this;
      if (self.default_params == null) self.default_params = nil;

      return self.default_params['$merge!'](new_default)
    }, 1);
    
    $def(self, '$validation', function $$validation(atome_instance_var) {
      
      if ($truthy(atome_instance_var)) {
        return true
      } else {
        return nil
      }
    }, 1);
    return $def(self, '$add_essential_drm', function $$add_essential_drm(params) {
      var $a, essential_drm = nil;

      
      essential_drm = $hash2(["authorisation", "atome"], {"authorisation": $hash2(["read", "write"], {"read": [$$('Atome').$current_user()], "write": [$$('Atome').$current_user()]}), "atome": $hash2(["read", "write"], {"read": ["all"], "write": ["me"]})});
      return ($a = ["drm", ($truthy(params['$[]']("drm")) ? (essential_drm.$merge(params['$[]']("drm"))) : (essential_drm))], $send(params, '[]=', $a), $a[$a.length - 1]);
    }, 1);
  })($nesting[0], $nesting)
};

Opal.modules["atome/renderers/browser/identity"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $neqeq = Opal.neqeq, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,!=,[],id=,browser_object,send,user_proc,each,build_option,grab,parents');
  
  generator = $$('Genesis').$generator();
  $send(generator, 'build_render', ["browser_id"], function $$1(params){var $a, self = $$1.$$s == null ? this : $$1.$$s;
    if (self.atome == null) self.atome = nil;

    
    if (params == null) params = nil;
    if ($neqeq(self.atome['$[]']("id"), params)) {
      return ($a = [params], $send(self.$browser_object(), 'id=', $a), $a[$a.length - 1])
    } else {
      return nil
    };}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["browser_type"], function $$2(params){var self = $$2.$$s == null ? this : $$2.$$s;

    
    if (params == null) params = nil;
    return self.$send("browser_" + (params), self.$user_proc());}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["browser_parents"], function $$3(parents_found){var self = $$3.$$s == null ? this : $$3.$$s;

    
    if (parents_found == null) parents_found = nil;
    return $send(parents_found, 'each', [], function $$4(parent_found){var self = $$4.$$s == null ? this : $$4.$$s;
      if (self.browser_type == null) self.browser_type = nil;
      if (self.browser_object == null) self.browser_object = nil;
      if (self.atome == null) self.atome = nil;

      
      if (parent_found == null) parent_found = nil;
      return $$('BrowserHelper').$send("browser_attach_" + (self.browser_type), parent_found, self.browser_object, self.atome);}, {$$arity: 1, $$s: self});}, {$$arity: 1, $$s: self});
  $send(generator, 'build_option', ["pre_render_children"], function $$5(children_pass){var self = $$5.$$s == null ? this : $$5.$$s;

    
    if (children_pass == null) children_pass = nil;
    return $send(children_pass, 'each', [], function $$6(child_found){var self = $$6.$$s == null ? this : $$6.$$s, atome_found = nil;
      if (self.atome == null) self.atome = nil;

      
      if (child_found == null) child_found = nil;
      atome_found = self.$grab(child_found);
      return atome_found.$parents([self.atome['$[]']("id")]);}, {$$arity: 1, $$s: self});}, {$$arity: 1, $$s: self});
  return $send(generator, 'build_render', ["browser_attach"], function $$7(parents_found){var self = $$7.$$s == null ? this : $$7.$$s;

    
    if (parents_found == null) parents_found = nil;
    return $send(parents_found, 'each', [], function $$8(parent_found){var self = $$8.$$s == null ? this : $$8.$$s;
      if (self.browser_type == null) self.browser_type = nil;
      if (self.browser_object == null) self.browser_object = nil;
      if (self.atome == null) self.atome = nil;

      
      if (parent_found == null) parent_found = nil;
      return $$('BrowserHelper').$send("browser_attach_" + (self.browser_type), parent_found, self.browser_object, self.atome);}, {$$arity: 1, $$s: self});}, {$$arity: 1, $$s: self});
};

Opal.modules["atome/genesis/generators/communication"] = Opal.return_val(Opal.nil); /* Generated by Opal 1.6.0 */

Opal.modules["atome/helpers/color_helper/color/rgb"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $const_set = Opal.const_set, $def = Opal.def, $to_ary = Opal.to_ary, $send = Opal.send, $rb_divide = Opal.rb_divide, $truthy = Opal.truthy, $rb_times = Opal.rb_times, $rb_gt = Opal.rb_gt, $rb_minus = Opal.rb_minus, $rb_plus = Opal.rb_plus, $eqeq = Opal.eqeq, $rb_lt = Opal.rb_lt, $hash2 = Opal.hash2, $alias = Opal.alias, $eqeqeq = Opal.eqeqeq, $return_ivar = Opal.return_ivar, $to_a = Opal.to_a, $slice = Opal.slice, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, $$$ = Opal.$$$;

  Opal.add_stubs('include,to_rgb,map,normalize,/,call,%,round,*,>,hex,red_p,green_p,blue_p,css_hsl,to_hsl,css_hsla,-,to_f,min,brightness,max,from_fraction,+,near_zero?,near_zero_or_less?,==,<,downcase,to_s,raise,**,to_xyz,[],mix_with,dup,r=,r,g=,g,b=,b,y,to_yiq,l,to_grayscale,normalize_percent,l=,s=,s,h=,h,flatten,empty?,===,to_lab,each,delta_e94,values_at,sqrt,class,-@,max_rgb_as_grayscale,html,instance_variable_set,private,new,to_proc,alias_method,scan,size,to_i,each_slice,join,fetch,__by_hex,html_hexify,from_html,__by_name,by_name,by_hex,union,keys,by_css,constants,length,const_set,names=,names,[]=,freeze,require');
  
  (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'RGB');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting), $proto = self.$$prototype;

    $proto.r = $proto.g = $proto.b = nil;
    
    self.$include($$('Color'));
    $const_set($nesting[0], 'PDF_FORMAT_STR', "%.3f %.3f %.3f %s");
    
    $def(self, '$coerce', function $$coerce(other) {
      
      return other.$to_rgb()
    }, 1);
    
    $def(self, '$initialize', function $$initialize(r, g, b, radix) {
      var block = $$initialize.$$p || nil, $a, $b, self = this;

      $$initialize.$$p = null;
      
      ;
      if (r == null) r = 0;
      if (g == null) g = 0;
      if (b == null) b = 0;
      if (radix == null) radix = 255.0;
      $b = $send([r, g, b], 'map', [], function $$1(v){
        
        if (v == null) v = nil;
        return $$('Color').$normalize($rb_divide(v, radix));}, 1), $a = $to_ary($b), (self.r = ($a[0] == null ? nil : $a[0])), (self.g = ($a[1] == null ? nil : $a[1])), (self.b = ($a[2] == null ? nil : $a[2])), $b;
      if ($truthy(block)) {
        return block.$call(self)
      } else {
        return nil
      };
    }, -1);
    
    $def(self, '$pdf_fill', function $$pdf_fill() {
      var self = this;

      return $$('PDF_FORMAT_STR')['$%']([self.r, self.g, self.b, "rg"])
    }, 0);
    
    $def(self, '$pdf_stroke', function $$pdf_stroke() {
      var self = this;

      return $$('PDF_FORMAT_STR')['$%']([self.r, self.g, self.b, "RG"])
    }, 0);
    
    $def(self, '$hex', function $$hex() {
      var self = this, r = nil, g = nil, b = nil;

      
      r = $rb_times(self.r, 255).$round();
      if ($truthy($rb_gt(r, 255))) {
        r = 255
      };
      g = $rb_times(self.g, 255).$round();
      if ($truthy($rb_gt(g, 255))) {
        g = 255
      };
      b = $rb_times(self.b, 255).$round();
      if ($truthy($rb_gt(b, 255))) {
        b = 255
      };
      return "%02x%02x%02x"['$%']([r, g, b]);
    }, 0);
    
    $def(self, '$html', function $$html() {
      var self = this;

      return "#" + (self.$hex())
    }, 0);
    
    $def(self, '$css_rgb', function $$css_rgb() {
      var self = this;

      return "rgb(%3.2f%%, %3.2f%%, %3.2f%%)"['$%']([self.$red_p(), self.$green_p(), self.$blue_p()])
    }, 0);
    
    $def(self, '$css_rgba', function $$css_rgba(alpha) {
      var self = this;

      
      if (alpha == null) alpha = 1;
      return "rgba(%3.2f%%, %3.2f%%, %3.2f%%, %3.2f)"['$%']([self.$red_p(), self.$green_p(), self.$blue_p(), alpha]);
    }, -1);
    
    $def(self, '$css_hsl', function $$css_hsl() {
      var self = this;

      return self.$to_hsl().$css_hsl()
    }, 0);
    
    $def(self, '$css_hsla', function $$css_hsla() {
      var self = this;

      return self.$to_hsl().$css_hsla()
    }, 0);
    
    $def(self, '$to_cmyk', function $$to_cmyk() {
      var self = this, c = nil, m = nil, y = nil, k = nil;

      
      c = $rb_minus(1.0, self.r.$to_f());
      m = $rb_minus(1.0, self.g.$to_f());
      y = $rb_minus(1.0, self.b.$to_f());
      k = [c, m, y].$min();
      k = $rb_minus(k, $rb_times(k, self.$brightness()));
      c = [1.0, [0.0, $rb_minus(c, k)].$max()].$min();
      m = [1.0, [0.0, $rb_minus(m, k)].$max()].$min();
      y = [1.0, [0.0, $rb_minus(y, k)].$max()].$min();
      k = [1.0, [0.0, k].$max()].$min();
      return $$$($$('Color'), 'CMYK').$from_fraction(c, m, y, k);
    }, 0);
    
    $def(self, '$to_rgb', function $$to_rgb(ignored) {
      var self = this;

      
      if (ignored == null) ignored = nil;
      return self;
    }, -1);
    
    $def(self, '$to_yiq', function $$to_yiq() {
      var self = this, y = nil, i = nil, q = nil;

      
      y = $rb_plus($rb_plus($rb_times(self.r, 0.299), $rb_times(self.g, 0.587)), $rb_times(self.b, 0.114));
      i = $rb_plus($rb_plus($rb_times(self.r, 0.596), $rb_times(self.g, -0.275)), $rb_times(self.b, -0.321));
      q = $rb_plus($rb_plus($rb_times(self.r, 0.212), $rb_times(self.g, -0.523)), $rb_times(self.b, 0.311));
      return $$$($$('Color'), 'YIQ').$from_fraction(y, i, q);
    }, 0);
    
    $def(self, '$to_hsl', function $$to_hsl() {
      var self = this, min = nil, max = nil, delta = nil, lum = nil, hue = nil, sat = nil, sixth = nil;

      
      min = [self.r, self.g, self.b].$min();
      max = [self.r, self.g, self.b].$max();
      delta = $rb_minus(max, min).$to_f();
      lum = $rb_divide($rb_plus(max, min), 2.0);
      if ($truthy($$('Color')['$near_zero?'](delta))) {
        
        hue = 0;
        sat = 0;
      } else {
        
        if ($truthy($$('Color')['$near_zero_or_less?']($rb_minus(lum, 0.5)))) {
          sat = $rb_divide(delta, $rb_plus(max, min).$to_f())
        } else {
          sat = $rb_divide(delta, $rb_minus($rb_minus(2, max), min).$to_f())
        };
        sixth = $rb_divide(1, 6.0);
        if ($eqeq(self.r, max)) {
          
          hue = $rb_times(sixth, $rb_divide($rb_minus(self.g, self.b), delta));
          if ($truthy($rb_lt(self.g, self.b))) {
            hue = $rb_plus(hue, 1.0)
          };
        } else if ($eqeq(self.g, max)) {
          hue = $rb_plus($rb_times(sixth, $rb_divide($rb_minus(self.b, self.r), delta)), $rb_divide(1.0, 3.0))
        } else if ($eqeq(self.b, max)) {
          hue = $rb_plus($rb_times(sixth, $rb_divide($rb_minus(self.r, self.g), delta)), $rb_divide(2.0, 3.0))
        };
        if ($truthy($rb_lt(hue, 0))) {
          hue = $rb_plus(hue, 1)
        };
        if ($truthy($rb_gt(hue, 1))) {
          hue = $rb_minus(hue, 1)
        };
      };
      return $$$($$('Color'), 'HSL').$from_fraction(hue, sat, lum);
    }, 0);
    
    $def(self, '$to_xyz', function $$to_xyz(color_space) {
      var $a, $b, self = this, r = nil, g = nil, b = nil;

      
      if (color_space == null) color_space = "sRGB";
      if (!$eqeq(color_space.$to_s().$downcase(), "srgb")) {
        self.$raise($$('ArgumentError'), "Unsupported colour space " + (color_space) + ".")
      };
      $b = $send([self.r, self.g, self.b], 'map', [], function $$2(v){
        
        if (v == null) v = nil;
        if ($truthy($rb_gt(v, 0.04045))) {
          return $rb_times($rb_divide($rb_plus(v, 0.055), 1.055)['$**'](2.4), 100)
        } else {
          return $rb_times($rb_divide(v, 12.92), 100)
        };}, 1), $a = $to_ary($b), (r = ($a[0] == null ? nil : $a[0])), (g = ($a[1] == null ? nil : $a[1])), (b = ($a[2] == null ? nil : $a[2])), $b;
      return $hash2(["x", "y", "z"], {"x": $rb_plus($rb_plus($rb_times(r, 0.4124564), $rb_times(g, 0.3575761)), $rb_times(b, 0.1804375)), "y": $rb_plus($rb_plus($rb_times(r, 0.2126729), $rb_times(g, 0.7151522)), $rb_times(b, 0.072175)), "z": $rb_plus($rb_plus($rb_times(r, 0.0193339), $rb_times(g, 0.119192)), $rb_times(b, 0.9503041))});
    }, -1);
    
    $def(self, '$to_lab', function $$to_lab(color_space, reference_white) {
      var $a, $b, self = this, xyz = nil, xr = nil, yr = nil, zr = nil, epsilon = nil, kappa = nil, fx = nil, fy = nil, fz = nil;

      
      if (color_space == null) color_space = "sRGB";
      if (reference_white == null) reference_white = [95.047, 100.0, 108.883];
      xyz = self.$to_xyz();
      xr = $rb_divide(xyz['$[]']("x"), reference_white['$[]'](0));
      yr = $rb_divide(xyz['$[]']("y"), reference_white['$[]'](1));
      zr = $rb_divide(xyz['$[]']("z"), reference_white['$[]'](2));
      epsilon = $rb_divide(216, 24389.0);
      kappa = $rb_divide(24389, 27.0);
      $b = $send([xr, yr, zr], 'map', [], function $$3(t){
        
        if (t == null) t = nil;
        if ($truthy($rb_gt(t, epsilon))) {
          return t['$**']($rb_divide(1.0, 3))
        } else {
          return $rb_divide($rb_plus($rb_times(kappa, t), 16), 116.0)
        };}, 1), $a = $to_ary($b), (fx = ($a[0] == null ? nil : $a[0])), (fy = ($a[1] == null ? nil : $a[1])), (fz = ($a[2] == null ? nil : $a[2])), $b;
      return $hash2(["L", "a", "b"], {"L": $rb_minus($rb_times(116, fy), 16), "a": $rb_times(500, $rb_minus(fx, fy)), "b": $rb_times(200, $rb_minus(fy, fz))});
    }, -1);
    
    $def(self, '$lighten_by', function $$lighten_by(percent) {
      var self = this;

      return self.$mix_with($$('White'), percent)
    }, 1);
    
    $def(self, '$darken_by', function $$darken_by(percent) {
      var self = this;

      return self.$mix_with($$('Black'), percent)
    }, 1);
    
    $def(self, '$mix_with', function $$mix_with(mask, opacity) {
      var self = this, rgb = nil;

      
      opacity = $rb_divide(opacity, 100.0);
      rgb = self.$dup();
      rgb['$r=']($rb_plus($rb_times(self.r, opacity), $rb_times(mask.$r(), $rb_minus(1, opacity))));
      rgb['$g=']($rb_plus($rb_times(self.g, opacity), $rb_times(mask.$g(), $rb_minus(1, opacity))));
      rgb['$b=']($rb_plus($rb_times(self.b, opacity), $rb_times(mask.$b(), $rb_minus(1, opacity))));
      return rgb;
    }, 2);
    
    $def(self, '$brightness', function $$brightness() {
      var self = this;

      return self.$to_yiq().$y()
    }, 0);
    
    $def(self, '$to_grayscale', function $$to_grayscale() {
      var self = this;

      return $$$($$('Color'), 'GrayScale').$from_fraction(self.$to_hsl().$l())
    }, 0);
    $alias(self, "to_greyscale", "to_grayscale");
    
    $def(self, '$adjust_brightness', function $$adjust_brightness(percent) {
      var self = this, hsl = nil;

      
      percent = self.$normalize_percent(percent);
      hsl = self.$to_hsl();
      hsl['$l=']($rb_times(hsl.$l(), percent));
      return hsl.$to_rgb();
    }, 1);
    
    $def(self, '$adjust_saturation', function $$adjust_saturation(percent) {
      var self = this, hsl = nil;

      
      percent = self.$normalize_percent(percent);
      hsl = self.$to_hsl();
      hsl['$s=']($rb_times(hsl.$s(), percent));
      return hsl.$to_rgb();
    }, 1);
    
    $def(self, '$adjust_hue', function $$adjust_hue(percent) {
      var self = this, hsl = nil;

      
      percent = self.$normalize_percent(percent);
      hsl = self.$to_hsl();
      hsl['$h=']($rb_times(hsl.$h(), percent));
      return hsl.$to_rgb();
    }, 1);
    
    $def(self, '$closest_match', function $$closest_match(color_list, threshold_distance) {
      var self = this, $ret_or_1 = nil, lab = nil, closest_distance = nil, best_match = nil;

      
      if (threshold_distance == null) threshold_distance = 1000.0;
      color_list = [color_list].$flatten(1);
      if ($truthy(color_list['$empty?']())) {
        return nil
      };
      threshold_distance = (($eqeqeq("jnd", ($ret_or_1 = threshold_distance)) || ($eqeqeq("just_noticeable", $ret_or_1))) ? (2.3) : (threshold_distance.$to_f()));
      lab = self.$to_lab();
      closest_distance = threshold_distance;
      best_match = nil;
      $send(color_list, 'each', [], function $$4(c){var self = $$4.$$s == null ? this : $$4.$$s, distance = nil;

        
        if (c == null) c = nil;
        distance = self.$delta_e94(lab, c.$to_lab());
        if ($truthy($rb_lt(distance, closest_distance))) {
          
          closest_distance = distance;
          return (best_match = c);
        } else {
          return nil
        };}, {$$arity: 1, $$s: self});
      return best_match;
    }, -2);
    
    $def(self, '$delta_e94', function $$delta_e94(color_1, color_2, weighting_type) {
      var $a, $b, self = this, k_1 = nil, k_2 = nil, k_L = nil, k_C = nil, k_H = nil, l_1 = nil, a_1 = nil, b_1 = nil, l_2 = nil, a_2 = nil, b_2 = nil, delta_a = nil, delta_b = nil, c_1 = nil, c_2 = nil, delta_L = nil, delta_C = nil, delta_H2 = nil, s_L = nil, s_C = nil, s_H = nil, composite_L = nil, composite_C = nil, composite_H = nil;

      
      if (weighting_type == null) weighting_type = "graphic_arts";
      
      switch (weighting_type) {
        case "graphic_arts":
          
          k_1 = 0.045;
          k_2 = 0.015;
          k_L = 1;
          break;
        case "textiles":
          
          k_1 = 0.048;
          k_2 = 0.014;
          k_L = 2;
          break;
        default:
          self.$raise($$('ArgumentError'), "Unsupported weighting type " + (weighting_type) + ".")
      };
      k_C = (k_H = 1);
      $b = color_1.$values_at("L", "a", "b"), $a = $to_ary($b), (l_1 = ($a[0] == null ? nil : $a[0])), (a_1 = ($a[1] == null ? nil : $a[1])), (b_1 = ($a[2] == null ? nil : $a[2])), $b;
      $b = color_2.$values_at("L", "a", "b"), $a = $to_ary($b), (l_2 = ($a[0] == null ? nil : $a[0])), (a_2 = ($a[1] == null ? nil : $a[1])), (b_2 = ($a[2] == null ? nil : $a[2])), $b;
      delta_a = $rb_minus(a_1, a_2);
      delta_b = $rb_minus(b_1, b_2);
      c_1 = $$('Math').$sqrt($rb_plus(a_1['$**'](2), b_1['$**'](2)));
      c_2 = $$('Math').$sqrt($rb_plus(a_2['$**'](2), b_2['$**'](2)));
      delta_L = $rb_minus(color_1['$[]']("L"), color_2['$[]']("L"));
      delta_C = $rb_minus(c_1, c_2);
      delta_H2 = $rb_minus($rb_plus(delta_a['$**'](2), delta_b['$**'](2)), delta_C['$**'](2));
      s_L = 1;
      s_C = $rb_plus(1, $rb_times(k_1, c_1));
      s_H = $rb_plus(1, $rb_times(k_2, c_1));
      composite_L = $rb_divide(delta_L, $rb_times(k_L, s_L))['$**'](2);
      composite_C = $rb_divide(delta_C, $rb_times(k_C, s_C))['$**'](2);
      composite_H = $rb_divide(delta_H2, $rb_times(k_H, s_H)['$**'](2));
      return $$('Math').$sqrt($rb_plus($rb_plus(composite_L, composite_C), composite_H));
    }, -3);
    
    $def(self, '$red', function $$red() {
      var self = this;

      return $rb_times(self.r, 255.0)
    }, 0);
    
    $def(self, '$red_p', function $$red_p() {
      var self = this;

      return $rb_times(self.r, 100.0)
    }, 0);
    
    $def(self, '$r', $return_ivar("r"), 0);
    
    $def(self, '$red=', function $RGB_red$eq$5(rr) {
      var self = this;

      return (self.r = $$('Color').$normalize($rb_divide(rr, 255.0)))
    }, 1);
    
    $def(self, '$red_p=', function $RGB_red_p$eq$6(rr) {
      var self = this;

      return (self.r = $$('Color').$normalize($rb_divide(rr, 100.0)))
    }, 1);
    
    $def(self, '$r=', function $RGB_r$eq$7(rr) {
      var self = this;

      return (self.r = $$('Color').$normalize(rr))
    }, 1);
    
    $def(self, '$green', function $$green() {
      var self = this;

      return $rb_times(self.g, 255.0)
    }, 0);
    
    $def(self, '$green_p', function $$green_p() {
      var self = this;

      return $rb_times(self.g, 100.0)
    }, 0);
    
    $def(self, '$g', $return_ivar("g"), 0);
    
    $def(self, '$green=', function $RGB_green$eq$8(gg) {
      var self = this;

      return (self.g = $$('Color').$normalize($rb_divide(gg, 255.0)))
    }, 1);
    
    $def(self, '$green_p=', function $RGB_green_p$eq$9(gg) {
      var self = this;

      return (self.g = $$('Color').$normalize($rb_divide(gg, 100.0)))
    }, 1);
    
    $def(self, '$g=', function $RGB_g$eq$10(gg) {
      var self = this;

      return (self.g = $$('Color').$normalize(gg))
    }, 1);
    
    $def(self, '$blue', function $$blue() {
      var self = this;

      return $rb_times(self.b, 255.0)
    }, 0);
    
    $def(self, '$blue_p', function $$blue_p() {
      var self = this;

      return $rb_times(self.b, 100.0)
    }, 0);
    
    $def(self, '$b', $return_ivar("b"), 0);
    
    $def(self, '$blue=', function $RGB_blue$eq$11(bb) {
      var self = this;

      return (self.b = $$('Color').$normalize($rb_divide(bb, 255.0)))
    }, 1);
    
    $def(self, '$blue_p=', function $RGB_blue_p$eq$12(bb) {
      var self = this;

      return (self.b = $$('Color').$normalize($rb_divide(bb, 100.0)))
    }, 1);
    
    $def(self, '$b=', function $RGB_b$eq$13(bb) {
      var self = this;

      return (self.b = $$('Color').$normalize(bb))
    }, 1);
    
    $def(self, '$+', function $RGB_$plus$14(other) {
      var self = this;

      return self.$class().$from_fraction($rb_plus(self.$r(), other.$r()), $rb_plus(self.$g(), other.$g()), $rb_plus(self.$b(), other.$b()))
    }, 1);
    
    $def(self, '$-', function $RGB_$minus$15(other) {
      var self = this;

      return $rb_plus(self, other['$-@']())
    }, 1);
    
    $def(self, '$max_rgb_as_grayscale', function $$max_rgb_as_grayscale() {
      var self = this;

      return $$$($$('Color'), 'GrayScale').$from_fraction([self.r, self.g, self.b].$max())
    }, 0);
    $alias(self, "max_rgb_as_greyscale", "max_rgb_as_grayscale");
    
    $def(self, '$inspect', function $$inspect() {
      var self = this;

      return "RGB [" + (self.$html()) + "]"
    }, 0);
    
    $def(self, '$to_a', function $$to_a() {
      var self = this;

      return [self.$r(), self.$g(), self.$b()]
    }, 0);
    
    $def(self, '$-@', function $RGB_$minus$$16() {
      var self = this, rgb = nil;

      
      rgb = self.$dup();
      rgb.$instance_variable_set("@r", rgb.$r()['$-@']());
      rgb.$instance_variable_set("@g", rgb.$g()['$-@']());
      rgb.$instance_variable_set("@b", rgb.$b()['$-@']());
      return rgb;
    }, 0);
    self.$private();
    return $def(self, '$normalize_percent', function $$normalize_percent(percent) {
      
      
      percent = $rb_divide(percent, 100.0);
      percent = $rb_plus(percent, 1.0);
      percent = [percent, 2.0].$min();
      percent = [0.0, percent].$max();
      return percent;
    }, 1);
  })($$('Color'), null, $nesting);
  (function(self, $parent_nesting) {
    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    
    
    $def(self, '$from_percentage', function $$from_percentage(r, g, b) {
      var block = $$from_percentage.$$p || nil, self = this;

      $$from_percentage.$$p = null;
      
      ;
      if (r == null) r = 0;
      if (g == null) g = 0;
      if (b == null) b = 0;
      return $send(self, 'new', [r, g, b, 100.0], block.$to_proc());
    }, -1);
    
    $def(self, '$from_fraction', function $$from_fraction(r, g, b) {
      var block = $$from_fraction.$$p || nil, self = this;

      $$from_fraction.$$p = null;
      
      ;
      if (r == null) r = 0.0;
      if (g == null) g = 0.0;
      if (b == null) b = 0.0;
      return $send(self, 'new', [r, g, b, 1.0], block.$to_proc());
    }, -1);
    
    $def(self, '$from_grayscale_fraction', function $$from_grayscale_fraction(l) {
      var block = $$from_grayscale_fraction.$$p || nil, self = this;

      $$from_grayscale_fraction.$$p = null;
      
      ;
      if (l == null) l = 0.0;
      return $send(self, 'new', [l, l, l, 1.0], block.$to_proc());
    }, -1);
    self.$alias_method("from_greyscale_fraction", "from_grayscale_fraction");
    
    $def(self, '$from_html', function $$from_html(html_colour) {
      var block = $$from_html.$$p || nil, self = this, h = nil;

      $$from_html.$$p = null;
      
      ;
      h = html_colour.$scan(/[0-9a-f]/i);
      
      switch (h.$size()) {
        case 3:
          return $send(self, 'new', $to_a($send(h, 'map', [], function $$17(v){
            
            if (v == null) v = nil;
            return $rb_times(v, 2).$to_i(16);}, 1)), block.$to_proc())
        case 6:
          return $send(self, 'new', $to_a($send(h.$each_slice(2), 'map', [], function $$18(v){
            
            if (v == null) v = nil;
            return v.$join().$to_i(16);}, 1)), block.$to_proc())
        default:
          return self.$raise($$('ArgumentError'), "Not a supported HTML colour type.")
      };
    }, 1);
    
    $def(self, '$by_hex', function $$by_hex(hex) {
      var block = $$by_hex.$$p || nil, self = this;

      $$by_hex.$$p = null;
      
      ;
      try {
        return $send(self.$__by_hex(), 'fetch', [self.$html_hexify(hex)], function $$19(){var self = $$19.$$s == null ? this : $$19.$$s;

          return self.$from_html(hex)}, {$$arity: 0, $$s: self})
      } catch ($err) {
        if (Opal.rescue($err, [$$('StandardError')])) {
          try {
            if ($truthy(block)) {
              return block.$call()
            } else {
              return self.$raise()
            }
          } finally { Opal.pop_exception(); }
        } else { throw $err; }
      };
    }, 1);
    
    $def(self, '$by_name', function $$by_name(name) {
      var block = $$by_name.$$p || nil, self = this;

      $$by_name.$$p = null;
      
      ;
      return $send(self.$__by_name(), 'fetch', [name.$to_s().$downcase()], block.$to_proc());
    }, 1);
    
    $def(self, '$by_css', function $$by_css(name_or_hex) {
      var block = $$by_css.$$p || nil, self = this;

      $$by_css.$$p = null;
      
      ;
      return $send(self, 'by_name', [name_or_hex], function $$20(){var self = $$20.$$s == null ? this : $$20.$$s;

        return $send(self, 'by_hex', [name_or_hex], block.$to_proc())}, {$$arity: 0, $$s: self});
    }, 1);
    return $def(self, '$extract_colors', function $$extract_colors(text, mode) {
      var self = this, regex = nil, $ret_or_1 = nil;

      
      if (mode == null) mode = "both";
      text = text.$downcase();
      regex = ($eqeqeq("name", ($ret_or_1 = mode)) ? ($$('Regexp').$union(self.$__by_name().$keys())) : ($eqeqeq("hex", $ret_or_1) ? ($$('Regexp').$union(self.$__by_hex().$keys())) : ($eqeqeq("both", $ret_or_1) ? ($$('Regexp').$union($rb_plus(self.$__by_hex().$keys(), self.$__by_name().$keys()))) : (nil))));
      return $send(text.$scan(regex), 'map', [], function $$21(match){var self = $$21.$$s == null ? this : $$21.$$s;

        
        if (match == null) match = nil;
        
        switch (mode) {
          case "name":
            return self.$by_name(match)
          case "hex":
            return self.$by_hex(match)
          case "both":
            return self.$by_css(match)
          default:
            return nil
        };}, {$$arity: 1, $$s: self});
    }, -2);
  })(Opal.get_singleton_class($$$($$('Color'), 'RGB')), $nesting);
  (function(self, $parent_nesting) {
    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    
    self.$private();
    
    $def(self, '$__named_color', function $$__named_color(mod, rgb, $a) {
      var $post_args, names, self = this, used = nil;

      
      $post_args = $slice.call(arguments, 2);
      names = $post_args;
      used = $rb_minus(names, $send(mod.$constants(), 'map', [], "to_sym".$to_proc()));
      if ($truthy($rb_lt(used.$length(), names.$length()))) {
        self.$raise($$('ArgumentError'), "" + (names.$join(", ")) + " already defined in " + (mod))
      };
      $send(names, 'each', [], function $$22(n){
        
        if (n == null) n = nil;
        return mod.$const_set(n, rgb);}, 1);
      rgb['$names='](names);
      $send(rgb.$names(), 'each', [], function $$23(n){var $b, self = $$23.$$s == null ? this : $$23.$$s;

        
        if (n == null) n = nil;
        return ($b = [n, rgb], $send(self.$__by_name(), '[]=', $b), $b[$b.length - 1]);}, {$$arity: 1, $$s: self});
      self.$__by_hex()['$[]='](rgb.$hex(), rgb);
      return rgb.$freeze();
    }, -3);
    
    $def(self, '$__by_hex', function $$__by_hex() {
      var self = this, $ret_or_1 = nil;
      if (self.__by_hex == null) self.__by_hex = nil;

      return (self.__by_hex = ($truthy(($ret_or_1 = self.__by_hex)) ? ($ret_or_1) : ($hash2([], {}))))
    }, 0);
    
    $def(self, '$__by_name', function $$__by_name() {
      var self = this, $ret_or_1 = nil;
      if (self.__by_name == null) self.__by_name = nil;

      return (self.__by_name = ($truthy(($ret_or_1 = self.__by_name)) ? ($ret_or_1) : ($hash2([], {}))))
    }, 0);
    return $def(self, '$html_hexify', function $$html_hexify(hex) {
      var self = this, h = nil;

      
      h = hex.$to_s().$downcase().$scan(/[0-9a-f]/);
      
      switch (h.$size()) {
        case 3:
          return $send(h, 'map', [], function $$24(v){
            
            if (v == null) v = nil;
            return $rb_times(v, 2);}, 1).$join()
        case 6:
          return h.$join()
        default:
          return self.$raise($$('ArgumentError'), "Not a supported HTML colour type.")
      };
    }, 1);
  })(Opal.get_singleton_class($$$($$('Color'), 'RGB')), $nesting);
  return self.$require("atome/helpers/color_helper/color/rgb/colors");
};

Opal.modules["atome/helpers/color_helper/color/css"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $send = Opal.send, $return_val = Opal.return_val, $defs = Opal.defs, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, $$$ = Opal.$$$;

  Opal.add_stubs('by_name');
  return (function($base, $parent_nesting) {
    var self = $module($base, 'CSS');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    return $defs(self, '$[]', function $CSS_$$$1(name) {
      
      return $send($$$($$('Color'), 'RGB'), 'by_name', [name], $return_val(nil), 0)
    }, 1)
  })($$('Color'), $nesting)
};

Opal.modules["atome/helpers/color_helper/color/hsl"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $send = Opal.send, $def = Opal.def, $rb_divide = Opal.rb_divide, $truthy = Opal.truthy, $slice = Opal.slice, $to_a = Opal.to_a, $rb_plus = Opal.rb_plus, $return_ivar = Opal.return_ivar, $alias = Opal.alias, $rb_times = Opal.rb_times, $rb_lt = Opal.rb_lt, $rb_gt = Opal.rb_gt, $rb_minus = Opal.rb_minus, $return_self = Opal.return_self, $to_ary = Opal.to_ary, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, $$$ = Opal.$$$;

  Opal.add_stubs('include,new,to_proc,to_hsl,normalize,/,call,html,to_rgb,css_rgb,css_rgba,%,hue,saturation,luminosity,near_zero_or_less?,l,near_one_or_more?,near_zero?,s,from_grayscale_fraction,+,compute_fvd_rgb,to_yiq,to_cmyk,from_fraction,to_greyscale,*,<,>,-,luminosity=,map,zip,to_a,coerce,class,h,private,fvd_mix_sat_lum,hue_to_rgb,rotate_hue,to_f');
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'HSL');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting), $proto = self.$$prototype;

    $proto.l = $proto.h = $proto.s = nil;
    
    self.$include($$('Color'));
    (function(self, $parent_nesting) {
      
      return $def(self, '$from_fraction', function $$from_fraction(h, s, l) {
        var block = $$from_fraction.$$p || nil, self = this;

        $$from_fraction.$$p = null;
        
        ;
        if (h == null) h = 0.0;
        if (s == null) s = 0.0;
        if (l == null) l = 0.0;
        return $send(self, 'new', [h, s, l, 1.0, 1.0], block.$to_proc());
      }, -1)
    })(Opal.get_singleton_class(self), $nesting);
    
    $def(self, '$coerce', function $$coerce(other) {
      
      return other.$to_hsl()
    }, 1);
    
    $def(self, '$initialize', function $$initialize(h, s, l, radix1, radix2) {
      var block = $$initialize.$$p || nil, self = this;

      $$initialize.$$p = null;
      
      ;
      if (h == null) h = 0;
      if (s == null) s = 0;
      if (l == null) l = 0;
      if (radix1 == null) radix1 = 360.0;
      if (radix2 == null) radix2 = 100.0;
      self.h = $$('Color').$normalize($rb_divide(h, radix1));
      self.s = $$('Color').$normalize($rb_divide(s, radix2));
      self.l = $$('Color').$normalize($rb_divide(l, radix2));
      if ($truthy(block)) {
        return block.$call()
      } else {
        return nil
      };
    }, -1);
    
    $def(self, '$html', function $$html() {
      var self = this;

      return self.$to_rgb().$html()
    }, 0);
    
    $def(self, '$css_rgb', function $$css_rgb() {
      var self = this;

      return self.$to_rgb().$css_rgb()
    }, 0);
    
    $def(self, '$css_rgba', function $$css_rgba(alpha) {
      var self = this;

      
      if (alpha == null) alpha = 1;
      return self.$to_rgb().$css_rgba(alpha);
    }, -1);
    
    $def(self, '$css_hsl', function $$css_hsl() {
      var self = this;

      return "hsl(%3.2f, %3.2f%%, %3.2f%%)"['$%']([self.$hue(), self.$saturation(), self.$luminosity()])
    }, 0);
    
    $def(self, '$css_hsla', function $$css_hsla() {
      var self = this;

      return "hsla(%3.2f, %3.2f%%, %3.2f%%, %3.2f)"['$%']([self.$hue(), self.$saturation(), self.$luminosity(), 1])
    }, 0);
    
    $def(self, '$to_rgb', function $$to_rgb($a) {
      var $post_args, $rest_arg, self = this;

      
      $post_args = $slice.call(arguments);
      $rest_arg = $post_args;
      if ($truthy($$('Color')['$near_zero_or_less?'](self.$l()))) {
        return $$$($$$($$('Color'), 'RGB'), 'Black')
      } else if ($truthy($$('Color')['$near_one_or_more?'](self.$l()))) {
        return $$$($$$($$('Color'), 'RGB'), 'White')
      } else if ($truthy($$('Color')['$near_zero?'](self.$s()))) {
        return $$$($$('Color'), 'RGB').$from_grayscale_fraction(self.$l())
      } else {
        return $send($$$($$('Color'), 'RGB'), 'new', $to_a($rb_plus(self.$compute_fvd_rgb(), [1.0])))
      };
    }, -1);
    
    $def(self, '$to_yiq', function $$to_yiq() {
      var self = this;

      return self.$to_rgb().$to_yiq()
    }, 0);
    
    $def(self, '$to_cmyk', function $$to_cmyk() {
      var self = this;

      return self.$to_rgb().$to_cmyk()
    }, 0);
    
    $def(self, '$brightness', $return_ivar("l"), 0);
    
    $def(self, '$to_greyscale', function $$to_greyscale() {
      var self = this;

      return $$$($$('Color'), 'GrayScale').$from_fraction(self.l)
    }, 0);
    $alias(self, "to_grayscale", "to_greyscale");
    
    $def(self, '$hue', function $$hue() {
      var self = this;

      return $rb_times(self.h, 360.0)
    }, 0);
    
    $def(self, '$h', $return_ivar("h"), 0);
    
    $def(self, '$hue=', function $HSL_hue$eq$1(hh) {
      var self = this;

      
      hh = $rb_divide(hh, 360.0);
      if ($truthy($rb_lt(hh, 0.0))) {
        hh = $rb_plus(hh, 1.0)
      };
      if ($truthy($rb_gt(hh, 1.0))) {
        hh = $rb_minus(hh, 1.0)
      };
      return (self.h = $$('Color').$normalize(hh));
    }, 1);
    
    $def(self, '$h=', function $HSL_h$eq$2(hh) {
      var self = this;

      return (self.h = $$('Color').$normalize(hh))
    }, 1);
    
    $def(self, '$saturation', function $$saturation() {
      var self = this;

      return $rb_times(self.s, 100.0)
    }, 0);
    
    $def(self, '$s', $return_ivar("s"), 0);
    
    $def(self, '$saturation=', function $HSL_saturation$eq$3(ss) {
      var self = this;

      return (self.s = $$('Color').$normalize($rb_divide(ss, 100.0)))
    }, 1);
    
    $def(self, '$s=', function $HSL_s$eq$4(ss) {
      var self = this;

      return (self.s = $$('Color').$normalize(ss))
    }, 1);
    
    $def(self, '$luminosity', function $$luminosity() {
      var self = this;

      return $rb_times(self.l, 100.0)
    }, 0);
    $alias(self, "lightness", "luminosity");
    
    $def(self, '$l', $return_ivar("l"), 0);
    
    $def(self, '$luminosity=', function $HSL_luminosity$eq$5(ll) {
      var self = this;

      return (self.l = $$('Color').$normalize($rb_divide(ll, 100.0)))
    }, 1);
    $alias(self, "lightness=", "luminosity=");
    
    $def(self, '$l=', function $HSL_l$eq$6(ll) {
      var self = this;

      return (self.l = $$('Color').$normalize(ll))
    }, 1);
    
    $def(self, '$to_hsl', $return_self, 0);
    
    $def(self, '$inspect', function $$inspect() {
      var self = this;

      return "HSL [%.2f deg, %.2f%%, %.2f%%]"['$%']([self.$hue(), self.$saturation(), self.$luminosity()])
    }, 0);
    
    $def(self, '$mix_with', function $$mix_with(color, mix_percent) {
      var self = this, v = nil;

      
      if (mix_percent == null) mix_percent = 0.5;
      v = $send(self.$to_a().$zip(self.$coerce(color).$to_a()), 'map', [], function $$7($mlhs_tmp1){var $a, $b, x = nil, y = nil;

        
        if ($mlhs_tmp1 == null) $mlhs_tmp1 = nil;
        $b = $mlhs_tmp1, $a = $to_ary($b), (x = ($a[0] == null ? nil : $a[0])), (y = ($a[1] == null ? nil : $a[1])), $b;
        return $rb_plus($rb_times($rb_minus(y, x), mix_percent), x);}, {$$arity: 1, $$has_top_level_mlhs_arg: true});
      return $send(self.$class(), 'from_fraction', $to_a(v));
    }, -2);
    
    $def(self, '$to_a', function $$to_a() {
      var self = this;

      return [self.$h(), self.$s(), self.$l()]
    }, 0);
    self.$private();
    
    $def(self, '$compute_fvd_rgb', function $$compute_fvd_rgb() {
      var $a, $b, self = this, t1 = nil, t2 = nil;

      
      $b = self.$fvd_mix_sat_lum(), $a = $to_ary($b), (t1 = ($a[0] == null ? nil : $a[0])), (t2 = ($a[1] == null ? nil : $a[1])), $b;
      return $send([$rb_plus(self.$h(), $rb_divide(1, 3.0)), self.$h(), $rb_minus(self.$h(), $rb_divide(1, 3.0))], 'map', [], function $$8(v){var self = $$8.$$s == null ? this : $$8.$$s;

        
        if (v == null) v = nil;
        return self.$hue_to_rgb(self.$rotate_hue(v), t1, t2);}, {$$arity: 1, $$s: self});
    }, 0);
    
    $def(self, '$fvd_mix_sat_lum', function $$fvd_mix_sat_lum() {
      var self = this, t = nil;

      
      t = ($truthy($$('Color')['$near_zero_or_less?']($rb_minus(self.$l(), 0.5))) ? ($rb_times(self.$l(), $rb_plus(1.0, self.$s().$to_f()))) : ($rb_minus($rb_plus(self.$l(), self.$s()), $rb_times(self.$l(), self.$s().$to_f()))));
      return [$rb_minus($rb_times(2.0, self.$l()), t), t];
    }, 0);
    
    $def(self, '$rotate_hue', function $$rotate_hue(h) {
      
      
      if ($truthy($$('Color')['$near_zero_or_less?'](h))) {
        h = $rb_plus(h, 1.0)
      };
      if ($truthy($$('Color')['$near_one_or_more?'](h))) {
        h = $rb_minus(h, 1.0)
      };
      return h;
    }, 1);
    return $def(self, '$hue_to_rgb', function $$hue_to_rgb(h, t1, t2) {
      
      if ($truthy($$('Color')['$near_zero_or_less?']($rb_minus($rb_times(6.0, h), 1.0)))) {
        return $rb_plus(t1, $rb_times($rb_times($rb_minus(t2, t1), h), 6.0))
      } else if ($truthy($$('Color')['$near_zero_or_less?']($rb_minus($rb_times(2.0, h), 1.0)))) {
        return t2
      } else if ($truthy($$('Color')['$near_zero_or_less?']($rb_minus($rb_times(3.0, h), 2.0)))) {
        return $rb_plus(t1, $rb_times($rb_times($rb_minus(t2, t1), $rb_minus($rb_divide(2, 3.0), h)), 6.0))
      } else {
        return t1
      }
    }, 3);
  })($$('Color'), null, $nesting)
};

Opal.modules["atome/renderers/browser/geometry"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,[]=,style');
  
  generator = $$('Genesis').$generator();
  $send(generator, 'build_render', ["browser_width"], function $$1(value){var $a, self = $$1.$$s == null ? this : $$1.$$s;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    return ($a = ["width", "" + (value) + "px"], $send(self.browser_object.$style(), '[]=', $a), $a[$a.length - 1]);}, {$$arity: 1, $$s: self});
  return $send(generator, 'build_render', ["browser_height"], function $$2(value){var $a, self = $$2.$$s == null ? this : $$2.$$s;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    return ($a = ["height", "" + (value) + "px"], $send(self.browser_object.$style(), '[]=', $a), $a[$a.length - 1]);}, {$$arity: 1, $$s: self});
};

Opal.modules["atome/genesis/generators/atome"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $hash2 = Opal.hash2, $truthy = Opal.truthy, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_atome,build_sanitizer,[],found_parents_and_renderers,length,atomes,instance_of?,create_color_hash,merge!,[]=,atome');
  
  generator = $$('Genesis').$generator();
  generator.$build_atome("animation");
  generator.$build_atome("color");
  $send(generator, 'build_sanitizer', ["color"], function $$1(params){var self = $$1.$$s == null ? this : $$1.$$s, parent_found = nil, render_found = nil, default_params = nil, new_params = nil;

    
    if (params == null) params = nil;
    parent_found = self.$found_parents_and_renderers()['$[]']("parent");
    render_found = self.$found_parents_and_renderers()['$[]']("renderers");
    default_params = $hash2(["renderers", "id", "type", "attach", "red", "green", "blue", "alpha"], {"renderers": render_found, "id": "color_" + ($$('Universe').$atomes().$length()), "type": "color", "attach": parent_found, "red": 0, "green": 0, "blue": 0, "alpha": 1});
    if (!$truthy(params['$instance_of?']($$('Hash')))) {
      params = self.$create_color_hash(params)
    };
    new_params = default_params['$merge!'](params);
    self.$atome()['$[]=']("color", new_params);
    return new_params;}, {$$arity: 1, $$s: self});
  $send(generator, 'build_sanitizer', ["video"], function $$2(params){var self = $$2.$$s == null ? this : $$2.$$s, parent_found = nil, render_found = nil, default_params = nil;

    
    if (params == null) params = nil;
    parent_found = self.$found_parents_and_renderers()['$[]']("parent");
    render_found = self.$found_parents_and_renderers()['$[]']("renderers");
    default_params = $hash2(["renderers", "id", "type", "parents"], {"renderers": render_found, "id": "video_" + ($$('Universe').$atomes().$length()), "type": "video", "parents": parent_found});
    return default_params['$merge!'](params);}, {$$arity: 1, $$s: self});
  generator.$build_atome("shadow");
  $send(generator, 'build_sanitizer', ["shadow"], function $$3(params){var self = $$3.$$s == null ? this : $$3.$$s, parent_found = nil, render_found = nil, default_params = nil;

    
    if (params == null) params = nil;
    parent_found = self.$found_parents_and_renderers()['$[]']("parent");
    render_found = self.$found_parents_and_renderers()['$[]']("renderers");
    default_params = $hash2(["renderers", "id", "type", "attach", "red", "green", "blue", "alpha", "blur", "left", "top"], {"renderers": render_found, "id": "shadow_" + ($$('Universe').$atomes().$length()), "type": "shadow", "attach": parent_found, "red": 0, "green": 0, "blue": 0, "alpha": 1, "blur": 3, "left": 3, "top": 3});
    return default_params['$merge!'](params);}, {$$arity: 1, $$s: self});
  generator.$build_atome("shape");
  generator.$build_atome("text");
  generator.$build_atome("image");
  generator.$build_atome("video");
  generator.$build_atome("code");
  generator.$build_atome("audio");
  generator.$build_atome("element");
  generator.$build_atome("web");
  return $send(generator, 'build_sanitizer', ["element"], function $$4(params){var self = $$4.$$s == null ? this : $$4.$$s, parent_found = nil, render_found = nil, default_params = nil;

    
    if (params == null) params = nil;
    parent_found = self.$found_parents_and_renderers()['$[]']("parent");
    render_found = [];
    default_params = $hash2(["renderers", "id", "type", "parents"], {"renderers": render_found, "id": "element_" + ($$('Universe').$atomes().$length()), "type": "element", "parents": parent_found});
    return default_params['$merge!'](params);}, {$$arity: 1, $$s: self});
};

Opal.modules["atome/renderers/browser/helpers/video_helper"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $send = Opal.send, $defs = Opal.defs, $truthy = Opal.truthy, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('[]=,style,play,[],on,currentTime,time_callback,prevent,is_a?,instance_exec,to_proc');
  return (function($base, $parent_nesting) {
    var self = $module($base, 'BrowserHelper');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    
    $defs(self, '$browser_left_video', function $$browser_left_video(value, browser_object, _atome) {
      var $a;

      return ($a = ["left", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_right_videob', function $$browser_right_videob(value, browser_object, _atome) {
      var $a;

      return ($a = ["right", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_top_video', function $$browser_top_video(value, browser_object, _atome) {
      var $a;

      return ($a = ["top", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_bottom_video', function $$browser_bottom_video(value, browser_object, _atome) {
      var $a;

      return ($a = ["bottom", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_path_video', function $$browser_path_video(value, browser_object, _atome) {
      var $a;

      return ($a = ["src", value], $send(browser_object, '[]=', $a), $a[$a.length - 1])
    }, 3);
    return $defs(self, '$browser_play_video', function $$browser_play_video(_value, browser_object_found, atome_hash, atome_object, proc) {
      var video_callback = nil, play_callback = nil;

      
      browser_object_found.$play();
      video_callback = atome_hash['$[]']("code");
      play_callback = proc;
      return $send(browser_object_found, 'on', ["timeupdate"], function $$1(e){var current_time = nil;

        
        if (e == null) e = nil;
        current_time = browser_object_found.$currentTime();
        atome_object.$time_callback(current_time);
        e.$prevent();
        if ($truthy(video_callback['$is_a?']($$('Proc')))) {
          $send(atome_object, 'instance_exec', [current_time], video_callback.$to_proc())
        };
        if ($truthy(play_callback['$is_a?']($$('Proc')))) {
          return $send(atome_object, 'instance_exec', [current_time], play_callback.$to_proc())
        } else {
          return nil
        };}, 1);
    }, 5);
  })($nesting[0], $nesting)
};

Opal.modules["atome/helpers/utilities"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $send = Opal.send, $eqeq = Opal.eqeq, $def = Opal.def, $return_val = Opal.return_val, $truthy = Opal.truthy, $hash2 = Opal.hash2, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('private,each,==,send,get_sanitizer_method,is_a?,instance_exec,to_proc,now,geolocation,include?,[],public,instance_variable_set,grab,attr_accessor,value,<<,real_atome,property,collapse');
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'Atome');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting), $proto = self.$$prototype;

    $proto.atome = $proto.broadcast = nil;
    
    self.$private();
    
    $def(self, '$collapse', function $$collapse() {
      var self = this;

      return $send(self.atome, 'each', [], function $$1(element, value){var self = $$1.$$s == null ? this : $$1.$$s;

        
        if (element == null) element = nil;
        if (value == null) value = nil;
        if ($eqeq(element, "type")) {
          return nil
        } else {
          return self.$send(element, value)
        };}, {$$arity: 2, $$s: self})
    }, 0);
    
    $def(self, '$security_pass', $return_val(true), 0);
    
    $def(self, '$sanitize', function $$sanitize(element, params) {
      var self = this, bloc_found = nil;

      
      bloc_found = $$('Universe').$get_sanitizer_method(element);
      if ($truthy(bloc_found['$is_a?']($$('Proc')))) {
        params = $send(self, 'instance_exec', [params], bloc_found.$to_proc())
      };
      return params;
    }, 2);
    
    $def(self, '$identity_generator', function $$identity_generator() {
      var self = this;

      return $hash2(["date", "location"], {"date": $$('Time').$now(), "location": self.$geolocation()})
    }, 0);
    
    $def(self, '$broadcasting', function $$broadcasting(element, value) {
      var $a, self = this, bloc_found = nil;

      
      if (!$truthy(($a = self.broadcast['$[]']("particles"), ($a === nil || $a == null) ? nil : $a['$include?'](element)))) {
        return nil
      };
      bloc_found = self.broadcast['$[]']("bloc");
      if ($truthy(bloc_found['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [self, element, value], bloc_found.$to_proc())
      } else {
        return nil
      };
    }, 2);
    
    $def(self, '$history', function $$history(property, value) {
      
      return "historize : " + (property) + " " + (value)
    }, 2);
    self.$public();
    
    $def(self, '$monitor', function $$monitor(params) {
      var proc_monitoring = $$monitor.$$p || nil, self = this;

      $$monitor.$$p = null;
      
      ;
      return $send(params['$[]']("atomes"), 'each', [], function $$2(atome_id){var self = $$2.$$s == null ? this : $$2.$$s;

        
        if (atome_id == null) atome_id = nil;
        return self.$grab(atome_id).$instance_variable_set("@broadcast", $hash2(["particles", "bloc"], {"particles": params['$[]']("particles"), "bloc": proc_monitoring}));}, {$$arity: 1, $$s: self});
    }, 1);
    
    $def(self, '$store_code_bloc', function $$store_code_bloc(element) {
      var user_proc = $$store_code_bloc.$$p || nil, self = this;

      $$store_code_bloc.$$p = null;
      
      ;
      $$('Object').$attr_accessor("" + (element) + "_code");
      return self.$instance_variable_set("@" + (element) + "_code", user_proc);
    }, 1);
    
    $def(self, '$<<', function $Atome_$lt$lt$3(particle) {
      var self = this, value = nil;

      
      value = particle.$value();
      return self.$real_atome()['$[]'](self.$property())['$<<'](value);
    }, 1);
    return $def(self, '$refresh', function $$refresh() {
      var self = this;

      return self.$collapse()
    }, 0);
  })($nesting[0], null, $nesting)
};

Opal.modules["atome/helpers/color_helper/color/rgb/colors"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $slice = Opal.slice, $send = Opal.send, $to_a = Opal.to_a, $def = Opal.def, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil;

  Opal.add_stubs('private,__named_color,new,named,require');
  
  (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'RGB');

    var $nesting = [self].concat($parent_nesting);

    
    (function(self, $parent_nesting) {
      
      
      self.$private();
      return $def(self, '$named', function $$named(rgb, $a) {
        var $post_args, names, self = this;

        
        $post_args = $slice.call(arguments, 1);
        names = $post_args;
        return $send(self, '__named_color', [self, $send(self, 'new', $to_a(rgb))].concat($to_a(names)));
      }, -2);
    })(Opal.get_singleton_class(self), $nesting);
    self.$named([240, 248, 255], "AliceBlue");
    self.$named([250, 235, 215], "AntiqueWhite");
    self.$named([0, 255, 255], "Aqua");
    self.$named([127, 255, 212], "Aquamarine");
    self.$named([240, 255, 255], "Azure");
    self.$named([245, 245, 220], "Beige");
    self.$named([255, 228, 196], "Bisque");
    self.$named([102, 51, 153], "RebeccaPurple", "BeccaPurple");
    self.$named([0, 0, 0], "Black");
    self.$named([255, 235, 205], "BlanchedAlmond");
    self.$named([0, 0, 255], "Blue");
    self.$named([138, 43, 226], "BlueViolet");
    self.$named([165, 42, 42], "Brown");
    self.$named([222, 184, 135], "BurlyWood", "Burlywood");
    self.$named([95, 158, 160], "CadetBlue");
    self.$named([255, 94, 208], "Carnation");
    self.$named([141, 0, 0], "Cayenne");
    self.$named([127, 255, 0], "Chartreuse");
    self.$named([210, 105, 30], "Chocolate");
    self.$named([255, 127, 80], "Coral");
    self.$named([100, 149, 237], "CornflowerBlue");
    self.$named([255, 248, 220], "Cornsilk");
    self.$named([220, 20, 60], "Crimson");
    self.$named([0, 255, 255], "Cyan");
    self.$named([0, 0, 139], "DarkBlue");
    self.$named([0, 139, 139], "DarkCyan");
    self.$named([184, 134, 11], "DarkGoldenRod", "DarkGoldenrod");
    self.$named([169, 169, 169], "DarkGray", "DarkGrey");
    self.$named([0, 100, 0], "DarkGreen");
    self.$named([189, 183, 107], "DarkKhaki");
    self.$named([139, 0, 139], "DarkMagenta");
    self.$named([85, 107, 47], "DarkOliveGreen", "DarkoliveGreen");
    self.$named([255, 140, 0], "DarkOrange");
    self.$named([153, 50, 204], "DarkOrchid");
    self.$named([139, 0, 0], "DarkRed");
    self.$named([233, 150, 122], "DarkSalmon", "Darksalmon");
    self.$named([143, 188, 143], "DarkSeaGreen");
    self.$named([72, 61, 139], "DarkSlateBlue");
    self.$named([47, 79, 79], "DarkSlateGray", "DarkSlateGrey");
    self.$named([0, 206, 209], "DarkTurquoise");
    self.$named([148, 0, 211], "DarkViolet");
    self.$named([255, 140, 0], "Darkorange");
    self.$named([255, 20, 147], "DeepPink");
    self.$named([0, 191, 191], "DeepSkyBlue");
    self.$named([105, 105, 105], "DimGray", "DimGrey");
    self.$named([30, 144, 255], "DodgerBlue");
    self.$named([209, 146, 117], "Feldspar");
    self.$named([178, 34, 34], "FireBrick", "Firebrick");
    self.$named([255, 250, 240], "FloralWhite");
    self.$named([34, 139, 34], "ForestGreen");
    self.$named([255, 0, 255], "Fuchsia");
    self.$named([220, 220, 220], "Gainsboro");
    self.$named([248, 248, 255], "GhostWhite");
    self.$named([255, 215, 0], "Gold");
    self.$named([218, 165, 32], "GoldenRod", "Goldenrod");
    self.$named([128, 128, 128], "Gray", "Grey");
    self.$named([10, 10, 10, 100.0], "Gray10", "Grey10");
    self.$named([20, 20, 20, 100.0], "Gray20", "Grey20");
    self.$named([30, 30, 30, 100.0], "Gray30", "Grey30");
    self.$named([40, 40, 40, 100.0], "Gray40", "Grey40");
    self.$named([50, 50, 50, 100.0], "Gray50", "Grey50");
    self.$named([60, 60, 60, 100.0], "Gray60", "Grey60");
    self.$named([70, 70, 70, 100.0], "Gray70", "Grey70");
    self.$named([80, 80, 80, 100.0], "Gray80", "Grey80");
    self.$named([90, 90, 90, 100.0], "Gray90", "Grey90");
    self.$named([0, 128, 0], "Green");
    self.$named([173, 255, 47], "GreenYellow");
    self.$named([240, 255, 240], "HoneyDew", "Honeydew");
    self.$named([255, 105, 180], "HotPink");
    self.$named([205, 92, 92], "IndianRed");
    self.$named([75, 0, 130], "Indigo");
    self.$named([255, 255, 240], "Ivory");
    self.$named([240, 230, 140], "Khaki");
    self.$named([230, 230, 250], "Lavender");
    self.$named([255, 240, 245], "LavenderBlush");
    self.$named([124, 252, 0], "LawnGreen");
    self.$named([255, 250, 205], "LemonChiffon");
    self.$named([173, 216, 230], "LightBlue");
    self.$named([240, 128, 128], "LightCoral");
    self.$named([224, 255, 255], "LightCyan");
    self.$named([250, 250, 210], "LightGoldenRodYellow", "LightGoldenrodYellow");
    self.$named([211, 211, 211], "LightGray", "LightGrey");
    self.$named([144, 238, 144], "LightGreen");
    self.$named([255, 182, 193], "LightPink");
    self.$named([255, 160, 122], "LightSalmon", "Lightsalmon");
    self.$named([32, 178, 170], "LightSeaGreen");
    self.$named([135, 206, 250], "LightSkyBlue");
    self.$named([132, 112, 255], "LightSlateBlue");
    self.$named([119, 136, 153], "LightSlateGray", "LightSlateGrey");
    self.$named([176, 196, 222], "LightSteelBlue", "LightsteelBlue");
    self.$named([255, 255, 224], "LightYellow");
    self.$named([0, 255, 0], "Lime");
    self.$named([50, 205, 50], "LimeGreen");
    self.$named([250, 240, 230], "Linen");
    self.$named([255, 0, 255], "Magenta");
    self.$named([128, 0, 0], "Maroon");
    self.$named([102, 205, 170], "MediumAquaMarine", "MediumAquamarine");
    self.$named([0, 0, 205], "MediumBlue");
    self.$named([186, 85, 211], "MediumOrchid");
    self.$named([147, 112, 219], "MediumPurple");
    self.$named([60, 179, 113], "MediumSeaGreen");
    self.$named([123, 104, 238], "MediumSlateBlue");
    self.$named([0, 250, 154], "MediumSpringGreen");
    self.$named([72, 209, 204], "MediumTurquoise");
    self.$named([199, 21, 133], "MediumVioletRed");
    self.$named([25, 25, 112], "MidnightBlue");
    self.$named([245, 255, 250], "MintCream");
    self.$named([255, 228, 225], "MistyRose");
    self.$named([255, 228, 181], "Moccasin");
    self.$named([255, 222, 173], "NavajoWhite");
    self.$named([0, 0, 128], "Navy");
    self.$named([253, 245, 230], "OldLace");
    self.$named([128, 128, 0], "Olive");
    self.$named([107, 142, 35], "OliveDrab", "Olivedrab");
    self.$named([255, 165, 0], "Orange");
    self.$named([255, 69, 0], "OrangeRed");
    self.$named([218, 112, 214], "Orchid");
    self.$named([238, 232, 170], "PaleGoldenRod", "PaleGoldenrod");
    self.$named([152, 251, 152], "PaleGreen");
    self.$named([175, 238, 238], "PaleTurquoise");
    self.$named([219, 112, 147], "PaleVioletRed");
    self.$named([255, 239, 213], "PapayaWhip");
    self.$named([255, 218, 185], "PeachPuff", "Peachpuff");
    self.$named([205, 133, 63], "Peru");
    self.$named([255, 192, 203], "Pink");
    self.$named([221, 160, 221], "Plum");
    self.$named([176, 224, 230], "PowderBlue");
    self.$named([128, 0, 128], "Purple");
    self.$named([255, 0, 0], "Red");
    self.$named([188, 143, 143], "RosyBrown");
    self.$named([65, 105, 225], "RoyalBlue");
    self.$named([139, 69, 19], "SaddleBrown");
    self.$named([250, 128, 114], "Salmon");
    self.$named([244, 164, 96], "SandyBrown");
    self.$named([46, 139, 87], "SeaGreen");
    self.$named([255, 245, 238], "SeaShell", "Seashell");
    self.$named([160, 82, 45], "Sienna");
    self.$named([192, 192, 192], "Silver");
    self.$named([135, 206, 235], "SkyBlue");
    self.$named([106, 90, 205], "SlateBlue");
    self.$named([112, 128, 144], "SlateGray", "SlateGrey");
    self.$named([255, 250, 250], "Snow");
    self.$named([0, 255, 127], "SpringGreen");
    self.$named([70, 130, 180], "SteelBlue");
    self.$named([210, 180, 140], "Tan");
    self.$named([0, 128, 128], "Teal");
    self.$named([216, 191, 216], "Thistle");
    self.$named([255, 99, 71], "Tomato");
    self.$named([64, 224, 208], "Turquoise");
    self.$named([238, 130, 238], "Violet");
    self.$named([208, 32, 144], "VioletRed");
    self.$named([245, 222, 179], "Wheat");
    self.$named([255, 255, 255], "White");
    self.$named([245, 245, 245], "WhiteSmoke");
    self.$named([255, 255, 0], "Yellow");
    return self.$named([154, 205, 50], "YellowGreen");
  })($$('Color'), null, $nesting);
  return self.$require("atome/helpers/color_helper/color/rgb/metallic");
};

Opal.modules["atome/renderers/html/geometry"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $eqeq = Opal.eqeq, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,==,[]=,style');
  
  generator = $$('Genesis').$generator();
  $send(generator, 'build_render', ["html_width"], function $$1(value){var $a, self = $$1.$$s == null ? this : $$1.$$s;
    if (self.html_type == null) self.html_type = nil;
    if (self.html_object == null) self.html_object = nil;

    
    if (value == null) value = nil;
    if ($eqeq(self.html_type, "style")) {
      return nil
    } else {
      return ($a = ["width", "" + (value) + "px"], $send(self.html_object.$style(), '[]=', $a), $a[$a.length - 1])
    };}, {$$arity: 1, $$s: self});
  return $send(generator, 'build_render', ["html_height"], function $$2(value){var $a, self = $$2.$$s == null ? this : $$2.$$s;
    if (self.html_type == null) self.html_type = nil;
    if (self.html_object == null) self.html_object = nil;

    
    if (value == null) value = nil;
    if ($eqeq(self.html_type, "style")) {
      return nil
    } else {
      return ($a = ["height", "" + (value) + "px"], $send(self.html_object.$style(), '[]=', $a), $a[$a.length - 1])
    };}, {$$arity: 1, $$s: self});
};

Opal.modules["atome/renderers/browser/helpers/event_helper"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send, $defs = Opal.defs, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('is_a?,instance_exec,to_proc');
  return (function($base, $parent_nesting) {
    var self = $module($base, 'BrowserHelper');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    
    $defs(self, '$touch_helper_callback', function $$touch_helper_callback(event, proc) {
      var self = this;

      if ($truthy(proc['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [event], proc.$to_proc())
      } else {
        return nil
      }
    }, 2);
    $defs(self, '$browser_touch_true', function $$browser_touch_true(browser_object, proc) {
      
      
    interact('#'+browser_object)
  .on('tap', function (event) {
Opal.BrowserHelper.$touch_helper_callback(event,proc);
  })

    }, 2);
    $defs(self, '$browser_touch_long', function $$browser_touch_long(browser_object, proc) {
      
      
    interact('#'+browser_object)
  .on('hold', function (event) {
Opal.BrowserHelper.$touch_helper_callback(event,proc);
  })

    }, 2);
    $defs(self, '$browser_touch_double', function $$browser_touch_double(browser_object, proc) {
      
      
    interact('#'+browser_object)
  .on('doubletap', function (event) {
Opal.BrowserHelper.$touch_helper_callback(event,proc);
  })

    }, 2);
    $defs(self, '$browser_touch_down', function $$browser_touch_down(browser_object, proc) {
      
      
    interact('#'+browser_object)
  .on('down', function (event) {
Opal.BrowserHelper.$touch_helper_callback(event,proc);
  })


    }, 2);
    return $defs(self, '$browser_touch_up', function $$browser_touch_up(browser_object, proc) {
      
      
    interact('#'+browser_object)
  .on('up', function (event) {
Opal.BrowserHelper.$touch_helper_callback(event,proc);
  })

    }, 2);
  })($nesting[0], $nesting)
};

Opal.modules["atome/renderers/renderer"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $send = Opal.send, $def = Opal.def, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('private,[],each,send,to_proc');
  return (function($base, $super) {
    var self = $klass($base, $super, 'Atome');

    var $proto = self.$$prototype;

    $proto.atome = nil;
    
    self.$private();
    return $def(self, '$rendering', function $$rendering(element_to_render, content) {
      var user_proc = $$rendering.$$p || nil, self = this, render_engines = nil;

      $$rendering.$$p = null;
      
      ;
      render_engines = self.atome['$[]']("renderers");
      return $send(render_engines, 'each', [], function $$1(render_engine){var self = $$1.$$s == null ? this : $$1.$$s;

        
        if (render_engine == null) render_engine = nil;
        return $send(self, 'send', ["" + (render_engine) + "_" + (element_to_render), content], user_proc.$to_proc());}, {$$arity: 1, $$s: self});
    }, 2);
  })($nesting[0], null)
};

Opal.modules["atome/renderers/html/event"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $truthy = Opal.truthy, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,on,is_a?,instance_exec,to_proc');
  
  generator = $$('Genesis').$generator();
  return $send(generator, 'build_render', ["html_touch"], function $$1(_value, proc){var self = $$1.$$s == null ? this : $$1.$$s;
    if (self.html_object == null) self.html_object = nil;

    
    if (_value == null) _value = nil;
    if (proc == null) proc = nil;
    return $send(self.html_object, 'on', ["click"], function $$2(e){var self = $$2.$$s == null ? this : $$2.$$s;

      
      if (e == null) e = nil;
      if ($truthy(proc['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [], proc.$to_proc())
      } else {
        return nil
      };}, {$$arity: 1, $$s: self});}, {$$arity: 2, $$s: self});
};

Opal.modules["atome/renderers/browser/helpers/browser_helper"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $defs = Opal.defs, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('window,append_to,[],browser_document,add_class');
  return (function($base, $parent_nesting) {
    var self = $module($base, 'BrowserHelper');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    
    $defs(self, '$browser_document', function $$browser_document() {
      
      return $$('Browser').$window()
    }, 0);
    $defs(self, '$browser_attach_div', function $$browser_attach_div(parents, html_object, _atome) {
      var self = this;

      return html_object.$append_to(self.$browser_document()['$[]'](parents))
    }, 3);
    return $defs(self, '$browser_attach_style', function $$browser_attach_style(parents, _html_object, atome) {
      var self = this;

      return self.$browser_document()['$[]'](parents).$add_class(atome['$[]']("id"))
    }, 3);
  })($nesting[0], $nesting)
};

Opal.modules["atome/kernel/universe"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $hash2 = Opal.hash2, $def = Opal.def, $hash = Opal.hash, $send = Opal.send, $assign_ivar_val = Opal.assign_ivar_val, $eqeqeq = Opal.eqeqeq, $truthy = Opal.truthy, $return_ivar = Opal.return_ivar, $assign_ivar = Opal.assign_ivar, $return_val = Opal.return_val, $nesting = [], nil = Opal.nil, $$$ = Opal.$$$;

  Opal.add_stubs('attr_reader,push,instance_variable_get,merge!,[],[]=,delete,===,=~,last_match,downcase,current_machine_decision');
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'Universe');

    var $nesting = [self].concat($parent_nesting);

    
    self.atomes = $hash2([], {});
    self.atome_list = [];
    self.particle_list = [];
    self.renderer_list = ["html", "browser", "headless", "server"];
    self.options = $hash2([], {});
    self.sanitizers = $hash2([], {});
    return (function(self, $parent_nesting) {
      var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

      
      self.$attr_reader("atomes", "renderer_list", "atome_list", "particle_list");
      
      $def(self, '$add_to_particle_list', function $$add_to_particle_list(particle) {
        var self = this;

        
        if (particle == null) particle = nil;
        return self.$instance_variable_get("@particle_list").$push(particle);
      }, -1);
      
      $def(self, '$add_optional_method', function $$add_optional_method(method_name) {
        var method_proc = $$add_optional_method.$$p || nil, self = this;

        $$add_optional_method.$$p = null;
        
        ;
        return self.$instance_variable_get("@options")['$merge!']($hash(method_name, method_proc));
      }, 1);
      
      $def(self, '$get_optional_method', function $$get_optional_method(method_name) {
        var self = this;

        return self.$instance_variable_get("@options")['$[]'](method_name)
      }, 1);
      
      $def(self, '$add_sanitizer_method', function $$add_sanitizer_method(method_name) {
        var method_proc = $$add_sanitizer_method.$$p || nil, self = this;

        $$add_sanitizer_method.$$p = null;
        
        ;
        return self.$instance_variable_get("@sanitizers")['$merge!']($hash(method_name, method_proc));
      }, 1);
      
      $def(self, '$get_sanitizer_method', function $$get_sanitizer_method(method_name) {
        var self = this;

        return self.$instance_variable_get("@sanitizers")['$[]'](method_name)
      }, 1);
      
      $def(self, '$add_to_atome_list', function $$add_to_atome_list(atome) {
        var self = this;

        return self.$instance_variable_get("@atome_list").$push(atome)
      }, 1);
      
      $def(self, '$add_to_atomes', function $$add_to_atomes(id, atome) {
        var $a, self = this;
        if (self.atomes == null) self.atomes = nil;

        return ($a = [id, atome], $send(self.atomes, '[]=', $a), $a[$a.length - 1])
      }, 2);
      
      $def(self, '$update_atome_id', function $$update_atome_id(id, atome, prev_id) {
        var self = this;
        if (self.atomes == null) self.atomes = nil;

        
        self.atomes['$[]='](id, atome);
        return self.atomes.$delete(prev_id);
      }, 3);
      
      $def(self, '$app_identity', $assign_ivar_val("app_identity", 3), 0);
      
      $def(self, '$delete', function $delete$1(id) {
        var self = this;
        if (self.atomes == null) self.atomes = nil;

        return self.atomes.$delete(id)
      }, 1);
      
      $def(self, '$current_machine_decision', function $$current_machine_decision(platform, output) {
        var $ret_or_1 = nil;

        
        if ($eqeqeq(/darwin/, ($ret_or_1 = platform))) {
          if ($truthy(output['$=~'](/en1.*?(([A-F0-9]{2}:){5}[A-F0-9]{2})/im))) {
            $$$('Regexp').$last_match(1)
          }
        } else if ($eqeqeq(/win32/, $ret_or_1)) {
          if ($truthy(output['$=~'](/Physical Address.*?(([A-F0-9]{2}-){5}[A-F0-9]{2})/im))) {
            $$$('Regexp').$last_match(1)
          }
        } else {
          "unknown platform"
        };
        return platform;
      }, 2);
      
      $def(self, '$current_machine', function $$current_machine() {
        var self = this, platform = nil, output = nil;

        
        platform = $$('RUBY_PLATFORM').$downcase();
        output = ($truthy(platform['$=~'](/win32/)) ? ("ipconfig /all") : ("ifconfig"));
        return self.$current_machine_decision(platform, output);
      }, 0);
      
      $def(self, '$current_user', $return_ivar("user"), 0);
      
      $def(self, '$current_user=', $assign_ivar("user"), 0);
      return $def(self, '$connected', $return_val(true), 0);
    })(Opal.get_singleton_class(self), $nesting);
  })($nesting[0], null, $nesting)
};

Opal.modules["atome/helpers/color_helper/color/yiq"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $send = Opal.send, $defs = Opal.defs, $to_ary = Opal.to_ary, $rb_divide = Opal.rb_divide, $truthy = Opal.truthy, $def = Opal.def, $return_self = Opal.return_self, $return_ivar = Opal.return_ivar, $alias = Opal.alias, $rb_times = Opal.rb_times, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, $$$ = Opal.$$$;

  Opal.add_stubs('include,new,to_proc,map,normalize,/,call,to_yiq,to_grayscale,%,*,y,i,q');
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'YIQ');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting), $proto = self.$$prototype;

    $proto.y = $proto.i = $proto.q = nil;
    
    self.$include($$('Color'));
    $defs(self, '$from_fraction', function $$from_fraction(y, i, q) {
      var block = $$from_fraction.$$p || nil, self = this;

      $$from_fraction.$$p = null;
      
      ;
      if (y == null) y = 0;
      if (i == null) i = 0;
      if (q == null) q = 0;
      return $send(self, 'new', [y, i, q, 1.0], block.$to_proc());
    }, -1);
    
    $def(self, '$initialize', function $$initialize(y, i, q, radix) {
      var block = $$initialize.$$p || nil, $a, $b, self = this;

      $$initialize.$$p = null;
      
      ;
      if (y == null) y = 0;
      if (i == null) i = 0;
      if (q == null) q = 0;
      if (radix == null) radix = 100.0;
      $b = $send([y, i, q], 'map', [], function $$1(v){
        
        if (v == null) v = nil;
        return $$('Color').$normalize($rb_divide(v, radix));}, 1), $a = $to_ary($b), (self.y = ($a[0] == null ? nil : $a[0])), (self.i = ($a[1] == null ? nil : $a[1])), (self.q = ($a[2] == null ? nil : $a[2])), $b;
      if ($truthy(block)) {
        return block.$call()
      } else {
        return nil
      };
    }, -1);
    
    $def(self, '$coerce', function $$coerce(other) {
      
      return other.$to_yiq()
    }, 1);
    
    $def(self, '$to_yiq', $return_self, 0);
    
    $def(self, '$brightness', $return_ivar("y"), 0);
    
    $def(self, '$to_grayscale', function $$to_grayscale() {
      var self = this;

      return $$$($$('Color'), 'GrayScale').$new(self.y)
    }, 0);
    $alias(self, "to_greyscale", "to_grayscale");
    
    $def(self, '$y', $return_ivar("y"), 0);
    
    $def(self, '$y=', function $YIQ_y$eq$2(yy) {
      var self = this;

      return (self.y = $$('Color').$normalize(yy))
    }, 1);
    
    $def(self, '$i', $return_ivar("i"), 0);
    
    $def(self, '$i=', function $YIQ_i$eq$3(ii) {
      var self = this;

      return (self.i = $$('Color').$normalize(ii))
    }, 1);
    
    $def(self, '$q', $return_ivar("q"), 0);
    
    $def(self, '$q=', function $YIQ_q$eq$4(qq) {
      var self = this;

      return (self.q = $$('Color').$normalize(qq))
    }, 1);
    
    $def(self, '$inspect', function $$inspect() {
      var self = this;

      return "YIQ [%.2f%%, %.2f%%, %.2f%%]"['$%']([$rb_times(self.y, 100), $rb_times(self.i, 100), $rb_times(self.q, 100)])
    }, 0);
    return $def(self, '$to_a', function $$to_a() {
      var self = this;

      return [self.$y(), self.$i(), self.$q()]
    }, 0);
  })($$('Color'), null, $nesting)
};

Opal.modules["atome/renderers/browser/atome"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $const_set = Opal.const_set, $return_val = Opal.return_val, $def = Opal.def, $send = Opal.send, $hash2 = Opal.hash2, $rb_times = Opal.rb_times, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,[],append_to,DOM,atome,div,browser_document,remove,id,<<,head,*,img,text,iframe,[]=,attributes,video');
  
  $const_set($nesting[0], 'DOM', "nil");
  
  $def(self, '$parents', $return_val(nil), 0);
  generator = $$('Genesis').$generator();
  $send(generator, 'build_render', ["browser_shape"], function $$1(){var self = $$1.$$s == null ? this : $$1.$$s, id_found = nil;
    if (self.atome == null) self.atome = nil;

    
    self.browser_type = "div";
    id_found = self.atome['$[]']("id");
    $send(self, 'DOM', [], function $$2(){var self = $$2.$$s == null ? this : $$2.$$s;

      return self.$div($hash2(["id"], {"id": id_found})).$atome()}, {$$arity: 0, $$s: self}).$append_to($$('BrowserHelper').$browser_document()['$[]']("user_view"));
    return (self.browser_object = $$('BrowserHelper').$browser_document()['$[]'](id_found));}, {$$arity: 0, $$s: self});
  $send(generator, 'build_render', ["browser_color"], function $$3(_value){var $a, self = $$3.$$s == null ? this : $$3.$$s, id_found = nil, type_found = nil, red_found = nil, blue_found = nil, green_found = nil, alpha_found = nil;
    if (self.atome == null) self.atome = nil;

    
    if (_value == null) _value = nil;
    self.browser_type = "style";
    id_found = self.atome['$[]']("id");
    type_found = self.atome['$[]']("type");
    ($a = $$('BrowserHelper').$browser_document()['$[]'](self.$id()), ($a === nil || $a == null) ? nil : $a.$remove());
    red_found = self.atome['$[]']("red");
    blue_found = self.atome['$[]']("blue");
    green_found = self.atome['$[]']("green");
    alpha_found = self.atome['$[]']("alpha");
    $$('BrowserHelper').$browser_document().$head()['$<<']($$('Browser').$DOM("<style atome='" + (type_found) + "'\n" + "  id='" + (id_found) + "'>." + (id_found) + "{background-color: rgba(" + ($rb_times(red_found, 255)) + ",\n" + "  " + ($rb_times(green_found, 255)) + "," + ($rb_times(blue_found, 255)) + "," + (alpha_found) + ")}</style>"));
    return (self.browser_object = $$('BrowserHelper').$browser_document()['$[]'](id_found));}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["browser_shadow"], function $$4(_value){var $a, self = $$4.$$s == null ? this : $$4.$$s, id_found = nil, type_found = nil, red_found = nil, blue_found = nil, green_found = nil, alpha_found = nil, blur = nil, left = nil, top = nil, inset = nil;
    if (self.atome == null) self.atome = nil;

    
    if (_value == null) _value = nil;
    self.browser_type = "style";
    id_found = self.atome['$[]']("id");
    type_found = self.atome['$[]']("type");
    ($a = $$('BrowserHelper').$browser_document()['$[]'](self.$id()), ($a === nil || $a == null) ? nil : $a.$remove());
    red_found = self.atome['$[]']("red");
    blue_found = self.atome['$[]']("blue");
    green_found = self.atome['$[]']("green");
    alpha_found = self.atome['$[]']("alpha");
    blur = self.atome['$[]']("blur");
    left = self.atome['$[]']("left");
    top = self.atome['$[]']("top");
    inset = self.atome['$[]']("direction");
    $$('BrowserHelper').$browser_document().$head()['$<<']($$('Browser').$DOM("<style atome='" + (type_found) + "'\n" + "  id='" + (id_found) + "'>." + (id_found) + "{box-shadow: " + (left) + "px " + (top) + "px " + (blur) + "px " + (inset) + " rgba(" + ($rb_times(red_found, 255)) + ",\n" + "  " + ($rb_times(green_found, 255)) + "," + ($rb_times(blue_found, 255)) + "," + (alpha_found) + ")}</style>"));
    return (self.browser_object = $$('BrowserHelper').$browser_document()['$[]'](id_found));}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["browser_image"], function $$5(_user_prc){var self = $$5.$$s == null ? this : $$5.$$s, id_found = nil;
    if (self.atome == null) self.atome = nil;

    
    if (_user_prc == null) _user_prc = nil;
    self.browser_type = "div";
    id_found = self.atome['$[]']("id");
    $send(self, 'DOM', [], function $$6(){var self = $$6.$$s == null ? this : $$6.$$s;

      return self.$img($hash2(["id"], {"id": id_found})).$atome()}, {$$arity: 0, $$s: self}).$append_to($$('BrowserHelper').$browser_document()['$[]']("user_view"));
    return (self.browser_object = $$('BrowserHelper').$browser_document()['$[]'](id_found));}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["browser_text"], function $$7(_value, _user_proc){var self = $$7.$$s == null ? this : $$7.$$s, id_found = nil;
    if (self.atome == null) self.atome = nil;

    
    if (_value == null) _value = nil;
    if (_user_proc == null) _user_proc = nil;
    id_found = self.atome['$[]']("id");
    $send(self, 'DOM', [], function $$8(){var self = $$8.$$s == null ? this : $$8.$$s;

      return self.$div($hash2(["id"], {"id": id_found})).$atome().$text()}, {$$arity: 0, $$s: self}).$append_to($$('BrowserHelper').$browser_document()['$[]']("user_view"));
    self.browser_object = $$('BrowserHelper').$browser_document()['$[]'](id_found);
    return (self.browser_type = "div");}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["browser_web"], function $$9(){var $a, self = $$9.$$s == null ? this : $$9.$$s, id_found = nil;
    if (self.atome == null) self.atome = nil;
    if (self.browser_object == null) self.browser_object = nil;

    
    self.browser_type = "web";
    id_found = self.atome['$[]']("id");
    $send(self, 'DOM', [], function $$10(){var self = $$10.$$s == null ? this : $$10.$$s;

      return self.$iframe($hash2(["id"], {"id": id_found})).$atome()}, {$$arity: 0, $$s: self}).$append_to($$('BrowserHelper').$browser_document()['$[]']("user_view"));
    self.browser_object = $$('BrowserHelper').$browser_document()['$[]'](id_found);
    self.browser_object.$attributes()['$[]=']("allow", "accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture");
    return ($a = ["allowfullscreen", true], $send(self.browser_object.$attributes(), '[]=', $a), $a[$a.length - 1]);}, {$$arity: 0, $$s: self});
  return $send(generator, 'build_render', ["browser_video"], function $$11(_value, _user_proc){var self = $$11.$$s == null ? this : $$11.$$s, id_found = nil;
    if (self.atome == null) self.atome = nil;

    
    if (_value == null) _value = nil;
    if (_user_proc == null) _user_proc = nil;
    self.browser_type = "div";
    id_found = self.atome['$[]']("id");
    $send(self, 'DOM', [], function $$12(){var self = $$12.$$s == null ? this : $$12.$$s;

      return self.$video($hash2(["id", "autoplay", "loop", "muted"], {"id": id_found, "autoplay": false, "loop": false, "muted": false})).$atome()}, {$$arity: 0, $$s: self}).$append_to($$('BrowserHelper').$browser_document()['$[]']("user_view"));
    return (self.browser_object = $$('BrowserHelper').$browser_document()['$[]'](id_found));}, {$$arity: 2, $$s: self});
};

Opal.modules["atome/genesis/genesis"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $def = Opal.def, $send = Opal.send, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('new,add_to_particle_list,auto_render_generator,new_particle,to_proc,additional_particle_methods,add_to_atome_list,new_atome,each,renderer_list,build_render,new_render_engine,add_sanitizer_method,to_sym,add_optional_method');
  
  (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'Genesis');

    var $nesting = [self].concat($parent_nesting);

    return (function(self, $parent_nesting) {
      var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

      return $def(self, '$generator', function $$generator() {
        
        return $$('Atome').$new()
      }, 0)
    })(Opal.get_singleton_class(self), $nesting)
  })($nesting[0], null, $nesting);
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'Atome');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

    
    
    $def(self, '$build_particle', function $$build_particle(particle_name) {
      var particle_proc = $$build_particle.$$p || nil, self = this;

      $$build_particle.$$p = null;
      
      ;
      $$('Universe').$add_to_particle_list(particle_name);
      self.$auto_render_generator(particle_name);
      $send(self, 'new_particle', [particle_name], particle_proc.$to_proc());
      return $send(self, 'additional_particle_methods', [particle_name], particle_proc.$to_proc());
    }, 1);
    
    $def(self, '$build_atome', function $$build_atome(atome_name) {
      var atome_proc = $$build_atome.$$p || nil, self = this;

      $$build_atome.$$p = null;
      
      ;
      $$('Universe').$add_to_atome_list(atome_name);
      self.$auto_render_generator(atome_name);
      return $send(self, 'new_atome', [atome_name], atome_proc.$to_proc());
    }, 1);
    
    $def(self, '$auto_render_generator', function $$auto_render_generator(element) {
      var self = this;

      return $send($$('Universe').$renderer_list(), 'each', [], function $$1(render_engine){var self = $$1.$$s == null ? this : $$1.$$s;

        
        if (render_engine == null) render_engine = nil;
        return self.$build_render("" + (render_engine) + "_" + (element));}, {$$arity: 1, $$s: self})
    }, 1);
    
    $def(self, '$build_render', function $$build_render(renderer_name) {
      var method_proc = $$build_render.$$p || nil, self = this;

      $$build_render.$$p = null;
      
      ;
      return $send(self, 'new_render_engine', [renderer_name], method_proc.$to_proc());
    }, 1);
    
    $def(self, '$build_sanitizer', function $$build_sanitizer(method_name) {
      var method_proc = $$build_sanitizer.$$p || nil;

      $$build_sanitizer.$$p = null;
      
      ;
      return $send($$('Universe'), 'add_sanitizer_method', [method_name.$to_sym()], method_proc.$to_proc());
    }, 1);
    return $def(self, '$build_option', function $$build_option(method_name) {
      var method_proc = $$build_option.$$p || nil;

      $$build_option.$$p = null;
      
      ;
      return $send($$('Universe'), 'add_optional_method', [method_name.$to_sym()], method_proc.$to_proc());
    }, 1);
  })($nesting[0], null, $nesting);
};

Opal.modules["atome/renderers/browser/event"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $neqeq = Opal.neqeq, $slice = Opal.slice, $truthy = Opal.truthy, $hash2 = Opal.hash2, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,attribute,send,!=,currentTime=,[],currentTime,is_a?,instance_exec,to_proc,pause,on,atome,atome_js,muted,browser_object,unmuted,merge,each');
  
  generator = $$('Genesis').$generator();
  $send(generator, 'build_render', ["browser_touch"], function $$1(value, proc){var self = $$1.$$s == null ? this : $$1.$$s, atome_id = nil;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    if (proc == null) proc = nil;
    atome_id = self.browser_object.$attribute("id");
    return $$('BrowserHelper').$send("browser_touch_" + (value), atome_id, proc);}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["browser_play"], function $$2(value, proc){var self = $$2.$$s == null ? this : $$2.$$s;
    if (self.browser_object == null) self.browser_object = nil;
    if (self.atome == null) self.atome = nil;

    
    if (value == null) value = nil;
    if (proc == null) proc = nil;
    if ($neqeq(value, true)) {
      self.browser_object['$currentTime='](value)
    };
    return $$('BrowserHelper').$send("browser_play_" + (self.atome['$[]']("type")), value, self.browser_object, self.atome, self, proc);}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["browser_time"], function $$3($a, $b){var $post_args, value, _proc, $c, self = $$3.$$s == null ? this : $$3.$$s;
    if (self.browser_object == null) self.browser_object = nil;

    
    $post_args = $slice.call(arguments);
    
    if ($post_args.length > 1) value = $post_args.shift();if (value == null) value = nil;
    
    _proc = $post_args.shift();if (_proc == null) _proc = nil;
    if ($truthy(value)) {
      return ($c = [value], $send(self.browser_object, 'currentTime=', $c), $c[$c.length - 1])
    } else {
      return self.browser_object.$currentTime()
    };}, {$$arity: -2, $$s: self});
  $send(generator, 'build_render', ["browser_pause"], function $$4(_value, proc){var self = $$4.$$s == null ? this : $$4.$$s;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (_value == null) _value = nil;
    if (proc == null) proc = nil;
    if ($truthy(proc['$is_a?']($$('Proc')))) {
      $send(self, 'instance_exec', [self.browser_object.$currentTime()], proc.$to_proc())
    };
    return self.browser_object.$pause();}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["on"], function $$5(value, proc){var self = $$5.$$s == null ? this : $$5.$$s;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    if (proc == null) proc = nil;
    return $send(self.browser_object, 'on', [value], function $$6(e){var self = $$6.$$s == null ? this : $$6.$$s;

      
      if (e == null) e = nil;
      if ($truthy(proc['$is_a?']($$('Proc')))) {
        return $send(self, 'instance_exec', [e], proc.$to_proc())
      } else {
        return nil
      };}, {$$arity: 1, $$s: self});}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["fullscreen"], function $$7(_value, _proc){var self = $$7.$$s == null ? this : $$7.$$s, atome_id = nil;

    
    if (_value == null) _value = nil;
    if (_proc == null) _proc = nil;
    atome_id = self.$atome()['$[]']("id");
    return self.$atome_js().fullscreen(atome_id);}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["mute"], function $$8(value, _proc){var self = $$8.$$s == null ? this : $$8.$$s;

    
    if (value == null) value = nil;
    if (_proc == null) _proc = nil;
    if ($truthy(value)) {
      return self.$browser_object().$muted()
    } else {
      return self.$browser_object().$unmuted()
    };}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["browser_at"], function $$9(at, proc){var self = $$9.$$s == null ? this : $$9.$$s;

    
    if (at == null) at = nil;
    if (proc == null) proc = nil;
    return (self.at_time = $hash2(["code"], {"code": proc}).$merge(at));}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["browser_drag"], function $$10(options, proc){var self = $$10.$$s == null ? this : $$10.$$s;

    
    if (options == null) options = nil;
    if (proc == null) proc = nil;
    return $send(options, 'each', [], function $$11(method, params){var self = $$11.$$s == null ? this : $$11.$$s, atome_id = nil;
      if (self.atome == null) self.atome = nil;

      
      if (method == null) method = nil;
      if (params == null) params = nil;
      atome_id = self.atome['$[]']("id");
      return $$('BrowserHelper').$send("browser_drag_" + (method), params, atome_id, self, proc);}, {$$arity: 2, $$s: self});}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["browser_sort"], function $$12(options, _proc){var self = $$12.$$s == null ? this : $$12.$$s;
    if (self.atome == null) self.atome = nil;

    
    if (options == null) options = nil;
    if (_proc == null) _proc = nil;
    return self.$atome_js().sort(options, self.atome['$[]']("id"), self);}, {$$arity: 2, $$s: self});
  return $send(generator, 'build_render', ["browser_unbind"], function $$13(options, _proc){var self = $$13.$$s == null ? this : $$13.$$s, id_found = nil;

    
    if (options == null) options = nil;
    if (_proc == null) _proc = nil;
    id_found = self.$atome()['$[]']("id");
    
const el = document.getElementById(id_found);
interact('#'+id_found).unset(options);
;}, {$$arity: 2, $$s: self});
};

Opal.modules["atome/renderers/browser/helpers/shape_helper"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $send = Opal.send, $defs = Opal.defs, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('[]=,style');
  return (function($base) {
    var self = $module($base, 'BrowserHelper');

    
    
    $defs(self, '$browser_left_shape', function $$browser_left_shape(value, browser_object, _atome) {
      var $a;

      return ($a = ["left", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_right_shape', function $$browser_right_shape(value, browser_object, _atome) {
      var $a;

      return ($a = ["right", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_top_shape', function $$browser_top_shape(value, browser_object, _atome) {
      var $a;

      return ($a = ["top", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    return $defs(self, '$browser_bottom_shape', function $$browser_bottom_shape(value, browser_object, _atome) {
      var $a;

      return ($a = ["bottom", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
  })($nesting[0])
};

Opal.modules["atome/renderers/headless/utility"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render');
  
  generator = $$('Genesis').$generator();
  generator.$build_render("headless_schedule");
  return generator.$build_render("headless_reader");
};

Opal.modules["atome/renderers/browser/helpers/image_helper"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $send = Opal.send, $defs = Opal.defs, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('[]=,style');
  return (function($base) {
    var self = $module($base, 'BrowserHelper');

    
    
    $defs(self, '$browser_left_image', function $$browser_left_image(value, browser_object, _atome) {
      var $a;

      return ($a = ["left", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_right_image', function $$browser_right_image(value, browser_object, _atome) {
      var $a;

      return ($a = ["right", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_top_image', function $$browser_top_image(value, browser_object, _atome) {
      var $a;

      return ($a = ["top", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    $defs(self, '$browser_bottom_image', function $$browser_bottom_image(value, browser_object, _atome) {
      var $a;

      return ($a = ["bottom", "" + (value) + "px"], $send(browser_object.$style(), '[]=', $a), $a[$a.length - 1])
    }, 3);
    return $defs(self, '$browser_path_image', function $$browser_path_image(value, browser_object, _atome) {
      var $a;

      return ($a = ["src", value], $send(browser_object, '[]=', $a), $a[$a.length - 1])
    }, 3);
  })($nesting[0])
};

Opal.modules["atome/renderers/html/identity"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,send,user_proc,[],each');
  
  generator = $$('Genesis').$generator();
  $send(generator, 'build_render', ["html_type"], function $$1(params){var self = $$1.$$s == null ? this : $$1.$$s;

    
    if (params == null) params = nil;
    return self.$send("html_" + (params), self.$user_proc());}, {$$arity: 1, $$s: self});
  return $send(generator, 'build_render', ["html_parents"], function $$2(parents_found){var self = $$2.$$s == null ? this : $$2.$$s, type_found = nil;
    if (self.atome == null) self.atome = nil;

    
    if (parents_found == null) parents_found = nil;
    type_found = self.atome['$[]']("type");
    return $send(parents_found, 'each', [], function $$3(parent_found){var self = $$3.$$s == null ? this : $$3.$$s;
      if (self.html_object == null) self.html_object = nil;

      
      if (parent_found == null) parent_found = nil;
      return self.html_object.$send("append_" + (type_found), parent_found);}, {$$arity: 1, $$s: self});}, {$$arity: 1, $$s: self});
};

Opal.modules["atome/renderers/browser/helpers/color_helper"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $module = Opal.module, $defs = Opal.defs, $nesting = [], nil = Opal.nil;

  Opal.add_stubs('[],puts');
  return (function($base) {
    var self = $module($base, 'BrowserHelper');

    
    
    $defs(self, '$browser_colorize_color', function $$browser_colorize_color(color_updated, atome) {
      
      return document.getElementById(atome['$[]']("id")).sheet.cssRules[0].style.backgroundColor = color_updated
    }, 2);
    $defs(self, '$browser_colorize_shadow', function $$browser_colorize_shadow(color_updated, atome) {
      var left = nil, top = nil, blur = nil, direction = nil, shadow_updated = nil;

      
      left = atome['$[]']("left");
      top = atome['$[]']("top");
      blur = atome['$[]']("blur");
      direction = atome['$[]']("direction");
      shadow_updated = "" + (left) + "px " + (top) + "px " + (blur) + "px " + (color_updated) + " " + (direction);
      return document.getElementById(atome['$[]']("id")).sheet.cssRules[0].style.boxShadow = shadow_updated;
    }, 2);
    $defs(self, '$browser_left_color', function $$browser_left_color(_value, _browser_object, _atome) {
      var self = this;

      return self.$puts("code to write when implementing gradient")
    }, 3);
    $defs(self, '$browser_right_color', function $$browser_right_color(_value, _browser_object, _atome) {
      var self = this;

      return self.$puts("code to write when implementing gradient")
    }, 3);
    $defs(self, '$browser_top_color', function $$browser_top_color(_value, _browser_object, _atome) {
      var self = this;

      return self.$puts("code to write when implementing gradient")
    }, 3);
    return $defs(self, '$browser_bottom_color', function $$browser_bottom_color(_value, _browser_object, _atome) {
      var self = this;

      return self.$puts("code to write when implementing gradient")
    }, 3);
  })($nesting[0])
};

Opal.modules["atome/helpers/color_helper/color/cmyk"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $const_set = Opal.const_set, $def = Opal.def, $send = Opal.send, $to_ary = Opal.to_ary, $rb_divide = Opal.rb_divide, $truthy = Opal.truthy, $to_a = Opal.to_a, $rb_times = Opal.rb_times, $rb_minus = Opal.rb_minus, $rb_plus = Opal.rb_plus, $alias = Opal.alias, $return_self = Opal.return_self, $return_ivar = Opal.return_ivar, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, $$$ = Opal.$$$;

  Opal.add_stubs('include,to_cmyk,new,to_proc,map,normalize,/,call,%,html,to_rgb,css_rgb,css_rgba,css_hsl,to_hsl,css_hsla,from_fraction,adobe_cmyk_rgb,standard_cmyk_rgb,*,to_f,-,min,+,to_grayscale,cyan,magenta,yellow,black,to_yiq,c,m,y,k,private');
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'CMYK');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting), $proto = self.$$prototype;

    $proto.c = $proto.m = $proto.y = $proto.k = nil;
    
    self.$include($$('Color'));
    $const_set($nesting[0], 'PDF_FORMAT_STR', "%.3f %.3f %.3f %.3f %s");
    
    $def(self, '$coerce', function $$coerce(other) {
      
      return other.$to_cmyk()
    }, 1);
    (function(self, $parent_nesting) {
      
      
      
      $def(self, '$from_fraction', function $$from_fraction(c, m, y, k) {
        var block = $$from_fraction.$$p || nil, self = this;

        $$from_fraction.$$p = null;
        
        ;
        if (c == null) c = 0;
        if (m == null) m = 0;
        if (y == null) y = 0;
        if (k == null) k = 0;
        return $send(self, 'new', [c, m, y, k, 1.0], block.$to_proc());
      }, -1);
      return $def(self, '$from_percent', function $$from_percent(c, m, y, k) {
        var block = $$from_percent.$$p || nil, self = this;

        $$from_percent.$$p = null;
        
        ;
        if (c == null) c = 0;
        if (m == null) m = 0;
        if (y == null) y = 0;
        if (k == null) k = 0;
        return $send(self, 'new', [c, m, y, k], block.$to_proc());
      }, -1);
    })(Opal.get_singleton_class(self), $nesting);
    
    $def(self, '$initialize', function $$initialize(c, m, y, k, radix) {
      var block = $$initialize.$$p || nil, $a, $b, self = this;

      $$initialize.$$p = null;
      
      ;
      if (c == null) c = 0;
      if (m == null) m = 0;
      if (y == null) y = 0;
      if (k == null) k = 0;
      if (radix == null) radix = 100.0;
      $b = $send([c, m, y, k], 'map', [], function $$1(v){
        
        if (v == null) v = nil;
        return $$('Color').$normalize($rb_divide(v, radix));}, 1), $a = $to_ary($b), (self.c = ($a[0] == null ? nil : $a[0])), (self.m = ($a[1] == null ? nil : $a[1])), (self.y = ($a[2] == null ? nil : $a[2])), (self.k = ($a[3] == null ? nil : $a[3])), $b;
      if ($truthy(block)) {
        return block.$call(self)
      } else {
        return nil
      };
    }, -1);
    
    $def(self, '$pdf_fill', function $$pdf_fill() {
      var self = this;

      return $$('PDF_FORMAT_STR')['$%']([self.c, self.m, self.y, self.k, "k"])
    }, 0);
    
    $def(self, '$pdf_stroke', function $$pdf_stroke() {
      var self = this;

      return $$('PDF_FORMAT_STR')['$%']([self.c, self.m, self.y, self.k, "K"])
    }, 0);
    
    $def(self, '$html', function $$html() {
      var self = this;

      return self.$to_rgb().$html()
    }, 0);
    
    $def(self, '$css_rgb', function $$css_rgb() {
      var self = this;

      return self.$to_rgb().$css_rgb()
    }, 0);
    
    $def(self, '$css_rgba', function $$css_rgba(alpha) {
      var self = this;

      
      if (alpha == null) alpha = 1;
      return self.$to_rgb().$css_rgba(alpha);
    }, -1);
    
    $def(self, '$css_hsl', function $$css_hsl() {
      var self = this;

      return self.$to_hsl().$css_hsl()
    }, 0);
    
    $def(self, '$css_hsla', function $$css_hsla() {
      var self = this;

      return self.$to_hsl().$css_hsla()
    }, 0);
    
    $def(self, '$to_rgb', function $$to_rgb(use_adobe_method) {
      var self = this;

      
      if (use_adobe_method == null) use_adobe_method = false;
      if ($truthy(use_adobe_method)) {
        return $send($$$($$('Color'), 'RGB'), 'from_fraction', $to_a(self.$adobe_cmyk_rgb()))
      } else {
        return $send($$$($$('Color'), 'RGB'), 'from_fraction', $to_a(self.$standard_cmyk_rgb()))
      };
    }, -1);
    
    $def(self, '$to_grayscale', function $$to_grayscale() {
      var self = this, c = nil, m = nil, y = nil, g = nil;

      
      c = $rb_times(0.299, self.c.$to_f());
      m = $rb_times(0.587, self.m.$to_f());
      y = $rb_times(0.114, self.y.$to_f());
      g = $rb_minus(1.0, [1.0, $rb_plus($rb_plus($rb_plus(c, m), y), self.k)].$min());
      return $$$($$('Color'), 'GrayScale').$from_fraction(g);
    }, 0);
    $alias(self, "to_greyscale", "to_grayscale");
    
    $def(self, '$to_cmyk', $return_self, 0);
    
    $def(self, '$inspect', function $$inspect() {
      var self = this;

      return "CMYK [%.2f%%, %.2f%%, %.2f%%, %.2f%%]"['$%']([self.$cyan(), self.$magenta(), self.$yellow(), self.$black()])
    }, 0);
    
    $def(self, '$to_yiq', function $$to_yiq() {
      var self = this;

      return self.$to_rgb().$to_yiq()
    }, 0);
    
    $def(self, '$to_hsl', function $$to_hsl() {
      var self = this;

      return self.$to_rgb().$to_hsl()
    }, 0);
    
    $def(self, '$cyan', function $$cyan() {
      var self = this;

      return $rb_times(self.c, 100.0)
    }, 0);
    
    $def(self, '$c', $return_ivar("c"), 0);
    
    $def(self, '$cyan=', function $CMYK_cyan$eq$2(cc) {
      var self = this;

      return (self.c = $$('Color').$normalize($rb_divide(cc, 100.0)))
    }, 1);
    
    $def(self, '$c=', function $CMYK_c$eq$3(cc) {
      var self = this;

      return (self.c = $$('Color').$normalize(cc))
    }, 1);
    
    $def(self, '$magenta', function $$magenta() {
      var self = this;

      return $rb_times(self.m, 100.0)
    }, 0);
    
    $def(self, '$m', $return_ivar("m"), 0);
    
    $def(self, '$magenta=', function $CMYK_magenta$eq$4(mm) {
      var self = this;

      return (self.m = $$('Color').$normalize($rb_divide(mm, 100.0)))
    }, 1);
    
    $def(self, '$m=', function $CMYK_m$eq$5(mm) {
      var self = this;

      return (self.m = $$('Color').$normalize(mm))
    }, 1);
    
    $def(self, '$yellow', function $$yellow() {
      var self = this;

      return $rb_times(self.y, 100.0)
    }, 0);
    
    $def(self, '$y', $return_ivar("y"), 0);
    
    $def(self, '$yellow=', function $CMYK_yellow$eq$6(yy) {
      var self = this;

      return (self.y = $$('Color').$normalize($rb_divide(yy, 100.0)))
    }, 1);
    
    $def(self, '$y=', function $CMYK_y$eq$7(kk) {
      var self = this;

      return (self.y = $$('Color').$normalize(kk))
    }, 1);
    
    $def(self, '$black', function $$black() {
      var self = this;

      return $rb_times(self.k, 100.0)
    }, 0);
    
    $def(self, '$k', $return_ivar("k"), 0);
    
    $def(self, '$black=', function $CMYK_black$eq$8(kk) {
      var self = this;

      return (self.k = $$('Color').$normalize($rb_divide(kk, 100.0)))
    }, 1);
    
    $def(self, '$k=', function $CMYK_k$eq$9(kk) {
      var self = this;

      return (self.k = $$('Color').$normalize(kk))
    }, 1);
    
    $def(self, '$to_a', function $$to_a() {
      var self = this;

      return [self.$c(), self.$m(), self.$y(), self.$k()]
    }, 0);
    self.$private();
    
    $def(self, '$adobe_cmyk_rgb', function $$adobe_cmyk_rgb() {
      var self = this;

      return $send([self.c, self.m, self.y], 'map', [], function $$10(v){var self = $$10.$$s == null ? this : $$10.$$s;
        if (self.k == null) self.k = nil;

        
        if (v == null) v = nil;
        return $rb_minus(1.0, [1.0, $rb_plus(v, self.k)].$min());}, {$$arity: 1, $$s: self})
    }, 0);
    return $def(self, '$standard_cmyk_rgb', function $$standard_cmyk_rgb() {
      var self = this;

      return $send([self.c, self.m, self.y], 'map', [], function $$11(v){var self = $$11.$$s == null ? this : $$11.$$s;

        
        if (v == null) v = nil;
        return $rb_minus(1.0, $rb_plus($rb_times(v, $rb_minus(1.0, self.$k())), self.$k()));}, {$$arity: 1, $$s: self})
    }, 0);
  })($$('Color'), null, $nesting)
};

Opal.modules["atome/renderers/browser/utility"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,remove,browser_object,each,[],grab,children,send,atome_js,[]=,style');
  
  generator = $$('Genesis').$generator();
  generator.$build_render("browser_bloc");
  generator.$build_render("browser_render");
  $send(generator, 'build_render', ["browser_delete"], function $$1(){var $a, self = $$1.$$s == null ? this : $$1.$$s;

    return ($a = self.$browser_object(), ($a === nil || $a == null) ? nil : $a.$remove())}, {$$arity: 0, $$s: self});
  $send(generator, 'build_render', ["browser_clear"], function $$2(){var self = $$2.$$s == null ? this : $$2.$$s;
    if (self.atome == null) self.atome = nil;

    
    $send(self.atome['$[]']("children"), 'each', [], function $$3(child_found){var $a, self = $$3.$$s == null ? this : $$3.$$s;

      
      if (child_found == null) child_found = nil;
      return ($a = self.$grab(child_found).$browser_object(), ($a === nil || $a == null) ? nil : $a.$remove());}, {$$arity: 1, $$s: self});
    return self.$children([]);}, {$$arity: 0, $$s: self});
  $send(generator, 'build_render', ["browser_path"], function $$4(value){var self = $$4.$$s == null ? this : $$4.$$s;
    if (self.atome == null) self.atome = nil;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    return $$('BrowserHelper').$send("browser_path_" + (self.atome['$[]']("type")), value, self.browser_object, self.atome);}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["browser_data"], function $$5(data){var self = $$5.$$s == null ? this : $$5.$$s, type_found = nil;
    if (self.atome == null) self.atome = nil;

    
    if (data == null) data = nil;
    type_found = self.atome['$[]']("type");
    return $$('BrowserHelper').$send("browser_data_" + (type_found), data, self);}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["browser_schedule"], function $$6(format_date, proc){var self = $$6.$$s == null ? this : $$6.$$s, years = nil, months = nil, days = nil, hours = nil, minutes = nil, seconds = nil;

    
    if (format_date == null) format_date = nil;
    if (proc == null) proc = nil;
    years = format_date['$[]'](0);
    months = format_date['$[]'](1);
    days = format_date['$[]'](2);
    hours = format_date['$[]'](3);
    minutes = format_date['$[]'](4);
    seconds = format_date['$[]'](5);
    return self.$atome_js().schedule(years, months, days, hours, minutes, seconds, self, proc);}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["browser_reader"], function $$7(file, proc){var self = $$7.$$s == null ? this : $$7.$$s;

    
    if (file == null) file = nil;
    if (proc == null) proc = nil;
    return self.$atome_js().reader(file, self, proc);}, {$$arity: 2, $$s: self});
  $send(generator, 'build_render', ["browser_cursor"], function $$8(value){var $a, self = $$8.$$s == null ? this : $$8.$$s;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    return ($a = ["cursor", value], $send(self.browser_object.$style(), '[]=', $a), $a[$a.length - 1]);}, {$$arity: 1, $$s: self});
  return $send(generator, 'build_render', ["browser_overflow"], function $$9(value){var $a, self = $$9.$$s == null ? this : $$9.$$s;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    return ($a = ["overflow", value], $send(self.browser_object.$style(), '[]=', $a), $a[$a.length - 1]);}, {$$arity: 1, $$s: self});
};

Opal.modules["atome/renderers/browser/effect"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $eqeqeq = Opal.eqeqeq, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,===,each,<<,to_s,join,[]=,style,send');
  
  generator = $$('Genesis').$generator();
  $send(generator, 'build_render', ["browser_smooth"], function $$1(value){var $a, self = $$1.$$s == null ? this : $$1.$$s, format_params = nil, $ret_or_1 = nil, properties = nil;
    if (self.browser_object == null) self.browser_object = nil;

    
    if (value == null) value = nil;
    format_params = ($eqeqeq($$('Array'), ($ret_or_1 = value)) ? (((properties = []), $send(value, 'each', [], function $$2(param){
      
      if (param == null) param = nil;
      return properties['$<<']("" + (param) + "px");}, 1), properties.$join(" ").$to_s())) : ($eqeqeq($$('Integer'), $ret_or_1) ? ("" + (value) + "px") : (value)));
    return ($a = ["border-radius", format_params], $send(self.browser_object.$style(), '[]=', $a), $a[$a.length - 1]);}, {$$arity: 1, $$s: self});
  return $send(generator, 'build_render', ["browser_blur"], function $$3(value){var self = $$3.$$s == null ? this : $$3.$$s;
    if (self.browser_type == null) self.browser_type = nil;
    if (self.browser_object == null) self.browser_object = nil;
    if (self.atome == null) self.atome = nil;

    
    if (value == null) value = nil;
    return $$('BrowserHelper').$send("browser_blur_" + (self.browser_type), self.browser_object, value, self.atome);}, {$$arity: 1, $$s: self});
};

Opal.modules["atome/renderers/html/atome"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $rb_times = Opal.rb_times, $return_val = Opal.return_val, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,[],new,add_class,attr,remove,opal_document,id,<<,head,DOM,type,*');
  
  generator = $$('Genesis').$generator();
  $send(generator, 'build_render', ["html_shape"], function $$1(){var self = $$1.$$s == null ? this : $$1.$$s, current_atome = nil, id_found = nil;
    if (self.atome == null) self.atome = nil;
    if (self.html_object == null) self.html_object = nil;

    
    current_atome = self.atome;
    id_found = current_atome['$[]']("id");
    self.html_object = $$('Html').$new();
    self.html_object.$add_class("atome");
    return self.html_object.$attr("id", id_found);}, {$$arity: 0, $$s: self});
  $send(generator, 'build_render', ["html_color"], function $$2(_value){var $a, self = $$2.$$s == null ? this : $$2.$$s, red_found = nil, blue_found = nil, green_found = nil, alpha_found = nil;
    if (self.atome == null) self.atome = nil;

    
    if (_value == null) _value = nil;
    ($a = self.$opal_document()['$[]'](self.$id()), ($a === nil || $a == null) ? nil : $a.$remove());
    red_found = self.atome['$[]']("red");
    blue_found = self.atome['$[]']("blue");
    green_found = self.atome['$[]']("green");
    alpha_found = self.atome['$[]']("alpha");
    return self.$opal_document().$head()['$<<'](self.$DOM("<style atome='" + (self.$type()) + "'  id='" + (self.$id()) + "'>." + (self.$id()) + "{background-color: rgba(" + ($rb_times(red_found, 255)) + ",\n" + "  " + ($rb_times(green_found, 255)) + "," + ($rb_times(blue_found, 255)) + "," + (alpha_found) + ")}</style>"));}, {$$arity: 1, $$s: self});
  $send(generator, 'build_render', ["html_image"], function $$3(_user_prc){
    
    if (_user_prc == null) _user_prc = nil;
    return nil;}, 1);
  $send(generator, 'build_render', ["html_shadow"], $return_val(nil), 0);
  return $send(generator, 'build_render', ["html_video"], function $$4(_value, _user_proc){
    
    if (_value == null) _value = nil;
    if (_user_proc == null) _user_proc = nil;
    return nil;}, 2);
};

Opal.modules["atome/renderers/html/effect"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $send = Opal.send, $eqeqeq = Opal.eqeqeq, $eqeq = Opal.eqeq, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, generator = nil;

  Opal.add_stubs('generator,build_render,===,each,<<,to_s,join,==,[]=,style');
  
  generator = $$('Genesis').$generator();
  return $send(generator, 'build_render', ["html_smooth"], function $$1(value){var $a, self = $$1.$$s == null ? this : $$1.$$s, formated_params = nil, $ret_or_1 = nil, properties = nil;
    if (self.html_type == null) self.html_type = nil;
    if (self.html_object == null) self.html_object = nil;

    
    if (value == null) value = nil;
    formated_params = ($eqeqeq($$('Array'), ($ret_or_1 = value)) ? (((properties = []), $send(value, 'each', [], function $$2(param){
      
      if (param == null) param = nil;
      return properties['$<<']("" + (param) + "px");}, 1), properties.$join(" ").$to_s())) : ($eqeqeq($$('Integer'), $ret_or_1) ? ("" + (value) + "px") : (value)));
    if ($eqeq(self.html_type, "style")) {
      return nil
    } else {
      return ($a = ["border-radius", formated_params], $send(self.html_object.$style(), '[]=', $a), $a[$a.length - 1])
    };}, {$$arity: 1, $$s: self});
};

Opal.modules["atome/helpers/color_helper/color/grayscale"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $const_set = Opal.const_set, $send = Opal.send, $def = Opal.def, $rb_divide = Opal.rb_divide, $truthy = Opal.truthy, $rb_times = Opal.rb_times, $rb_minus = Opal.rb_minus, $return_self = Opal.return_self, $alias = Opal.alias, $rb_plus = Opal.rb_plus, $return_ivar = Opal.return_ivar, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil, $$$ = Opal.$$$;

  Opal.add_stubs('include,new,to_proc,normalize,/,call,to_grayscale,%,min,round,*,private,to_255,gray,css_hsl,to_hsl,css_hsla,-,to_f,from_fraction,g,+,max,gray=,class,-@,dup,instance_variable_set');
  
  (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'GrayScale');

    var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting), $proto = self.$$prototype;

    $proto.g = nil;
    
    self.$include($$('Color'));
    $const_set($nesting[0], 'PDF_FORMAT_STR', "%.3f %s");
    (function(self, $parent_nesting) {
      
      
      
      $def(self, '$from_fraction', function $$from_fraction(g) {
        var block = $$from_fraction.$$p || nil, self = this;

        $$from_fraction.$$p = null;
        
        ;
        if (g == null) g = 0;
        return $send(self, 'new', [g, 1.0], block.$to_proc());
      }, -1);
      return $def(self, '$from_percent', function $$from_percent(g) {
        var block = $$from_percent.$$p || nil, self = this;

        $$from_percent.$$p = null;
        
        ;
        if (g == null) g = 0;
        return $send(self, 'new', [g], block.$to_proc());
      }, -1);
    })(Opal.get_singleton_class(self), $nesting);
    
    $def(self, '$initialize', function $$initialize(g, radix) {
      var block = $$initialize.$$p || nil, self = this;

      $$initialize.$$p = null;
      
      ;
      if (g == null) g = 0;
      if (radix == null) radix = 100.0;
      self.g = $$('Color').$normalize($rb_divide(g, radix));
      if ($truthy(block)) {
        return block.$call()
      } else {
        return nil
      };
    }, -1);
    
    $def(self, '$coerce', function $$coerce(other) {
      
      return other.$to_grayscale()
    }, 1);
    
    $def(self, '$pdf_fill', function $$pdf_fill() {
      var self = this;

      return $$('PDF_FORMAT_STR')['$%']([self.g, "g"])
    }, 0);
    
    $def(self, '$pdf_stroke', function $$pdf_stroke() {
      var self = this;

      return $$('PDF_FORMAT_STR')['$%']([self.g, "G"])
    }, 0);
    
    $def(self, '$to_255', function $$to_255() {
      var self = this;

      return [$rb_times(self.g, 255).$round(), 255].$min()
    }, 0);
    self.$private("to_255");
    
    $def(self, '$html', function $$html() {
      var self = this, gs = nil;

      
      gs = "%02x"['$%'](self.$to_255());
      return "#" + ($rb_times(gs, 3));
    }, 0);
    
    $def(self, '$css_rgb', function $$css_rgb() {
      var self = this;

      return "rgb(%3.2f%%, %3.2f%%, %3.2f%%)"['$%']([self.$gray(), self.$gray(), self.$gray()])
    }, 0);
    
    $def(self, '$css_rgba', function $$css_rgba(alpha) {
      var self = this;

      
      if (alpha == null) alpha = 1;
      return "rgba(%3.2f%%, %3.2f%%, %3.2f%%, %1.2f)"['$%']([self.$gray(), self.$gray(), self.$gray(), alpha]);
    }, -1);
    
    $def(self, '$css_hsl', function $$css_hsl() {
      var self = this;

      return self.$to_hsl().$css_hsl()
    }, 0);
    
    $def(self, '$css_hsla', function $$css_hsla() {
      var self = this;

      return self.$to_hsl().$css_hsla()
    }, 0);
    
    $def(self, '$to_cmyk', function $$to_cmyk() {
      var self = this, k = nil;

      
      k = $rb_minus(1.0, self.g.$to_f());
      return $$$($$('Color'), 'CMYK').$from_fraction(0, 0, 0, k);
    }, 0);
    
    $def(self, '$to_rgb', function $$to_rgb(ignored) {
      var self = this;

      
      if (ignored == null) ignored = true;
      return $$$($$('Color'), 'RGB').$from_fraction(self.$g(), self.$g(), self.$g());
    }, -1);
    
    $def(self, '$to_grayscale', $return_self, 0);
    $alias(self, "to_greyscale", "to_grayscale");
    
    $def(self, '$lighten_by', function $$lighten_by(percent) {
      var self = this, g = nil;

      
      g = [$rb_plus(self.g, $rb_times(self.g, $rb_divide(percent, 100.0))), 1.0].$min();
      return $$$($$('Color'), 'GrayScale').$from_fraction(g);
    }, 1);
    
    $def(self, '$darken_by', function $$darken_by(percent) {
      var self = this, g = nil;

      
      g = [$rb_minus(self.g, $rb_times(self.g, $rb_divide(percent, 100.0))), 0.0].$max();
      return $$$($$('Color'), 'GrayScale').$from_fraction(g);
    }, 1);
    
    $def(self, '$to_yiq', function $$to_yiq() {
      var self = this, y = nil, i = nil, q = nil;

      
      y = self.g;
      i = $rb_plus($rb_plus($rb_times(self.g, 0.596), $rb_times(self.g, -0.275)), $rb_times(self.g, -0.321));
      q = $rb_plus($rb_plus($rb_times(self.g, 0.212), $rb_times(self.g, -0.523)), $rb_times(self.g, 0.311));
      return $$$($$('Color'), 'YIQ').$from_fraction(y, i, q);
    }, 0);
    
    $def(self, '$to_hsl', function $$to_hsl() {
      var self = this;

      return $$$($$('Color'), 'HSL').$from_fraction(0, 0, self.g)
    }, 0);
    
    $def(self, '$brightness', $return_ivar("g"), 0);
    
    $def(self, '$gray', function $$gray() {
      var self = this;

      return $rb_times(self.g, 100.0)
    }, 0);
    $alias(self, "grey", "gray");
    
    $def(self, '$g', $return_ivar("g"), 0);
    
    $def(self, '$gray=', function $GrayScale_gray$eq$1(gg) {
      var self = this;

      return (self.g = $$('Color').$normalize($rb_divide(gg, 100.0)))
    }, 1);
    $alias(self, "grey=", "gray=");
    
    $def(self, '$g=', function $GrayScale_g$eq$2(gg) {
      var self = this;

      return (self.g = $$('Color').$normalize(gg))
    }, 1);
    
    $def(self, '$+', function $GrayScale_$plus$3(other) {
      var self = this;

      return self.$class().$from_fraction($rb_plus(self.$g(), other.$to_grayscale().$g()))
    }, 1);
    
    $def(self, '$-', function $GrayScale_$minus$4(other) {
      var self = this;

      return $rb_plus(self, other['$-@']())
    }, 1);
    
    $def(self, '$inspect', function $$inspect() {
      var self = this;

      return "Gray [%.2f%%]"['$%']([self.$gray()])
    }, 0);
    
    $def(self, '$to_a', function $$to_a() {
      var self = this;

      return [self.$g()]
    }, 0);
    return $def(self, '$-@', function $GrayScale_$minus$$5() {
      var self = this, gs = nil;

      
      gs = self.$dup();
      gs.$instance_variable_set("@g", self.$g()['$-@']());
      return gs;
    }, 0);
  })($$('Color'), null, $nesting);
  return $const_set($$('Color'), 'GreyScale', $$$($$('Color'), 'GrayScale'));
};

Opal.modules["atome/helpers/color_helper/color/rgb/metallic"] = function(Opal) {/* Generated by Opal 1.6.0 */
  var $klass = Opal.klass, $module = Opal.module, $slice = Opal.slice, $send = Opal.send, $to_a = Opal.to_a, $def = Opal.def, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil;

  Opal.add_stubs('private,__named_color,new,metallic');
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'RGB');

    var $nesting = [self].concat($parent_nesting);

    
    $module($nesting[0], 'Metallic');
    (function(self, $parent_nesting) {
      var $nesting = [self].concat($parent_nesting), $$ = Opal.$r($nesting);

      
      self.$private();
      return $def(self, '$metallic', function $$metallic(rgb, $a) {
        var $post_args, names, self = this;

        
        $post_args = $slice.call(arguments, 1);
        names = $post_args;
        return $send(self, '__named_color', [$$('Metallic'), $send(self, 'new', $to_a(rgb))].concat($to_a(names)));
      }, -2);
    })(Opal.get_singleton_class(self), $nesting);
    self.$metallic([153, 153, 153], "Aluminum");
    self.$metallic([217, 135, 25], "CoolCopper");
    self.$metallic([184, 115, 51], "Copper");
    self.$metallic([76, 76, 76], "Iron");
    self.$metallic([25, 25, 25], "Lead");
    self.$metallic([179, 179, 179], "Magnesium");
    self.$metallic([230, 230, 230], "Mercury");
    self.$metallic([128, 128, 128], "Nickel");
    self.$metallic([96, 0, 0], "PolySilicon", "Poly");
    self.$metallic([204, 204, 204], "Silver");
    self.$metallic([102, 102, 102], "Steel");
    self.$metallic([127, 127, 127], "Tin");
    return self.$metallic([51, 51, 51], "Tungsten");
  })($$('Color'), null, $nesting)
};

Opal.queue(function(Opal) {/* Generated by Opal 1.6.0 */
  var $eqeq = Opal.eqeq, self = Opal.top, $nesting = [], $$ = Opal.$r($nesting), nil = Opal.nil;

  Opal.add_stubs('require,==,downcase');
  
  self.$require("fileutils");
  self.$require("atome/version");
  self.$require("atome/genesis/genesis");
  self.$require("atome/kernel/essentials");
  self.$require("atome/kernel/universe");
  self.$require("atome/helpers/essentials");
  self.$require("atome/renderers/renderer");
  self.$require("atome/helpers/color_helper/color");
  self.$require("atome/extensions/atome");
  self.$require("atome/atome");
  self.$require("atome/helpers/utilities");
  self.$require("atome/helpers/callbacks");
  self.$require("atome/genesis/generators/atome");
  self.$require("atome/presets/atome");
  self.$require("atome/genesis/generators/communication");
  self.$require("atome/genesis/generators/effect");
  self.$require("atome/genesis/generators/event");
  self.$require("atome/genesis/generators/geometry");
  self.$require("atome/genesis/generators/identity");
  self.$require("atome/genesis/generators/material");
  self.$require("atome/genesis/generators/spatial");
  self.$require("atome/genesis/generators/utility");
  if ($eqeq($$('RUBY_ENGINE').$downcase(), "opal")) {
    
    self.$require("atome/renderers/browser/browser");
    self.$require("atome/renderers/html/html");
  };
  self.$require("atome/renderers/headless/headless");
  self.$require("atome/renderers/server/server");
  self.$require("atome/extensions/matrix");
  self.$require("atome/helpers/sanitizer");
  return self.$require("atome/genesis/sparkle");
});
